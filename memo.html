<!-- IMPORTANT: Ne pas modifier ce fichier directement, mais modifier le fichier '/doc/memo_installation.md', puis export sur ce fichier - Éventuellent, juste remettre ici ce commentaire, et modifier dans le 'head', le 'title' de la page -->

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Mémo Laravel</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.8.0/styles/default.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.2/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/index.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Mon CMS","children":[{"content":"LARAVEL VOLT - Généralités","children":[{"content":"1 / Bases Laravel","children":[{"content":"<strong>composer  create-project laravel/laravel monapp --prefer-dist</strong>","children":[],"payload":{"lines":"15,16"}},{"content":"Paramètres .env file (APP_NAME, APP_URL &amp; DB_DATABASE)","children":[],"payload":{"lines":"16,17"}},{"content":"Ajout Fr : <strong>composer require --dev laravel-lang/common<br>\nphp artisan lang:update</strong>","children":[],"payload":{"lines":"17,19"}},{"content":"Ajout Debugbar : <strong>composer require barryvdh/laravel-debugbar --dev</strong>","children":[],"payload":{"lines":"19,21"}}],"payload":{"lines":"13,14","fold":1}},{"content":"2 / Gestion des Models et Tables","children":[{"content":"Tables:","children":[{"content":"Migration seule : <em>php artisan make:migration create_nnn_table</em>","children":[],"payload":{"lines":"24,25"}},{"content":"Factory : <em>php artisan make:factory MmmFactory</em>","children":[],"payload":{"lines":"25,26"}},{"content":"Seeders : <em>php artisan make:seeder MmmSeeder</em>","children":[],"payload":{"lines":"26,27"}},{"content":"Penser à appeler les seeders dans database/seeders/DataBaseSeeder.php:<br>\n<em>$this-&gt;call([<br>\nMmm1Seeder::class,<br>\nMmm2Seeder::class,<br>\netc...]);</em>","children":[],"payload":{"lines":"27,32"}},{"content":"Puis les exécuter : <em>php artisan db:seed</em>","children":[],"payload":{"lines":"32,33"}}],"payload":{"lines":"23,33","fold":1}},{"content":"Models + migration :","children":[{"content":"Migrations","children":[{"content":"<em>php artisan make:model Mmm --migration</em> ou<br>\n<em>php artisan make:model Mmm -m</em>","children":[],"payload":{"lines":"35,37"}},{"content":"<em>php artisan migrate</em> la 1ère fois","children":[],"payload":{"lines":"37,38"}},{"content":"<em>php artisan migrate:refresh --seed</em> ensuite","children":[],"payload":{"lines":"38,39"}}],"payload":{"lines":"34,39"}},{"content":"Model (Mmm) :","children":[{"content":"<em>protected $timestamps = false;</em>","children":[],"payload":{"lines":"40,41"}},{"content":"<em>protected $fillable = ['name', 'email', 'password', 'role', 'valid'];</em>","children":[],"payload":{"lines":"41,42"}}],"payload":{"lines":"39,42"}},{"content":"Relations :","children":[{"content":"1:n :","children":[{"content":"(1) : Dans MmmN","children":[{"content":"<em>use Illuminate\\Database\\Eloquent\\Relations\\BelongsTo;</em>","children":[],"payload":{"lines":"45,46"}},{"content":"<em>public function Mmm1(): BelongsTo {<br>\nreturn $this-&gt;belongsTo(Mmm1::class);}</em>","children":[],"payload":{"lines":"46,48"}}],"payload":{"lines":"44,48"}},{"content":"(n) : Dans Mmm1","children":[{"content":"<em>use Illuminate\\Database\\Eloquent\\Relations\\HasMany;</em>","children":[],"payload":{"lines":"49,50"}},{"content":"<em>public function MmmN(): HasMany {<br>\nreturn $this-&gt;HasMany(MmmN::class);}</em>","children":[],"payload":{"lines":"50,53"}}],"payload":{"lines":"48,53"}}],"payload":{"lines":"43,53"}}],"payload":{"lines":"42,53"}}],"payload":{"lines":"33,53","fold":1}}],"payload":{"lines":"21,22","fold":1}},{"content":"3 / Divers","children":[{"content":"<pre data-lines=\"55,59\"><code>Les Helpers (app/helpers.php)\n(Y écrire les fonctions appelées souvent d'un peu n'importe où ensuite)\n\ncomposer.json :\n</code></pre>","children":[],"payload":{"lines":"55,59"}},{"content":"<pre><code class=\"language-php\">  ...\n  <span class=\"hljs-string\">\"autoload\"</span>: {\n    <span class=\"hljs-string\">\"files\"</span>: [\n      <span class=\"hljs-string\">\"app/helpers.php\"</span>\n    ],\n    ...\n  },\n  ...\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  composer dumpautoload\n</code></pre>","children":[]}],"payload":{"lines":"53,54","fold":1}},{"content":"Extrait de: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-donnees\">https://laravel.sillo.org/posts/mon-cms-les-donnees</a></strong></em>","children":[],"payload":{"lines":"75,76"}},{"content":"Technos","children":[{"content":"MaryUI","children":[{"content":"Installation de MaryUI","children":[{"content":"<pre><code class=\"language-php\">  composer <span class=\"hljs-keyword\">require</span> robsontenorio/mary\n  php artisan mary:install\n</code></pre>","children":[]},{"content":"<pre data-lines=\"88,90\"><code>  → 0 (livewire/Volt)\n  → npm install --save-dev (npm)\n</code></pre>","children":[],"payload":{"lines":"88,90"}}],"payload":{"lines":"81,82"}},{"content":"Réf.: <strong><a href=\"https://mary-ui.com\">Doc complète MaryUI</a></strong>","children":[],"payload":{"lines":"91,92"}}],"payload":{"lines":"79,80","fold":1}},{"content":"Volt","children":[{"content":"Bases VOLT","children":[{"content":"<pre data-lines=\"97,100\"><code>UNE FONCTIONNALITÉ avec UN COMPOSANT VOLT (LOGIQUE + VUE) :\n\n1) Définir une route (./route/web.php) :\n</code></pre>","children":[],"payload":{"lines":"97,100"}},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Volt</span>\\<span class=\"hljs-title\">Volt</span>\n  ...\n  <span class=\"hljs-title\">Volt</span>::<span class=\"hljs-title\">route</span>('/<span class=\"hljs-title\">url</span>', '<span class=\"hljs-title\">dossier</span>(<span class=\"hljs-title\">s</span>).<span class=\"hljs-title\">fichier</span>')-&gt;<span class=\"hljs-title\">name</span>('<span class=\"hljs-title\">dossier</span>.<span class=\"hljs-title\">fichier</span>');\n</code></pre>","children":[]},{"content":"<pre data-lines=\"107,108\"><code>→ Recommandé à chaque changement des routes :\n</code></pre>","children":[],"payload":{"lines":"107,108"}},{"content":"<pre><code class=\"language-php\">  php artisan view:clear &amp; php artisan route:clear\n</code></pre>","children":[]},{"content":"<pre data-lines=\"113,114\"><code>→ Pour contrôle, liste de toutes les routes :\n</code></pre>","children":[],"payload":{"lines":"113,114"}},{"content":"<pre><code class=\"language-php\">  php artisan route:list\n</code></pre>","children":[]},{"content":"<pre data-lines=\"119,120\"><code>2) Créer le composant :\n</code></pre>","children":[],"payload":{"lines":"119,120"}},{"content":"<pre><code class=\"language-php\">  php artisan make:volt dossier/fichier --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre data-lines=\"125,128\"><code>Y définir :\n- Le Logique (La classe PHP)\n- La Vue (HTML - Template Blade)\n</code></pre>","children":[],"payload":{"lines":"125,128"}},{"content":"<pre><code class=\"language-php\">3) Souvent, besoin de traduire certains termes :\n\n→ Définir les clés:valeurs pour le fichier de langue (lang/fr.json)\n</code></pre>","children":[]}],"payload":{"lines":"95,96"}},{"content":"Réf.: <strong><a href=\"https://livewire.laravel.com/docs/quickstart\">Doc complète LIVEWIRE, compris VOLT</a></strong>","children":[],"payload":{"lines":"135,136"}}],"payload":{"lines":"93,94","fold":1}},{"content":"Extraits de : <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-lauthentification\">https://laravel.sillo.org/posts/mon-cms-lauthentification</a></strong></em>","children":[],"payload":{"lines":"137,138"}}],"payload":{"lines":"77,78"}}],"payload":{"lines":"11,12","fold":1}},{"content":"Le projet (Mon CMS)","children":[{"content":"Installation de laravel","children":[{"content":"<pre><code class=\"language-php\">  composer  create-project laravel/laravel moncms --prefer-dist\n</code></pre>","children":[]}],"payload":{"lines":"141,142","fold":1}},{"content":"Outil recommandé (Debugbar)","children":[{"content":"<pre data-lines=\"149,151\"><code>Installer la debugbar, active qu'en développement\n(Dans ./.env : APP_DEBUG = true) :\n</code></pre>","children":[],"payload":{"lines":"149,151"}},{"content":"<pre><code class=\"language-php\">  composer <span class=\"hljs-keyword\">require</span> barryvdh/laravel-debugbar --dev\n</code></pre>","children":[]},{"content":"<pre data-lines=\"156,159\"><code>Restart servers :\n\n- PHP, dans une première console (CLI):\n</code></pre>","children":[],"payload":{"lines":"156,159"}},{"content":"<pre><code class=\"language-php\">  php artisan serv\n</code></pre>","children":[]},{"content":"<pre data-lines=\"164,165\"><code>- VITE, dans une seconde CLI :\n</code></pre>","children":[],"payload":{"lines":"164,165"}},{"content":"<pre><code class=\"language-php\">  npm run dev\n</code></pre>","children":[]}],"payload":{"lines":"147,148","fold":1}},{"content":"Settings - (.env)","children":[{"content":"<pre><code class=\"language-php\">  APP_NAME=<span class=\"hljs-string\">\"Mon CMS\"</span>\n  ...\n  APP_URL=http:<span class=\"hljs-comment\">//moncms (là ajustez selon votre serveur local)</span>\n  ...\n  APP_LOCALE=fr\n  ...\n  DB_CONNECTION=mysql OU <span class=\"hljs-title function_ invoke__\">sqlite</span> (Alors, pas besoin des lignes ci-dessous)\n  DB_HOST=<span class=\"hljs-number\">127.0</span>.<span class=\"hljs-number\">0.1</span>\n  DB_PORT=<span class=\"hljs-number\">3306</span>\n  DB_DATABASE=moncms\n  DB_USERNAME=root\n  DB_PASSWORD=\n  ...\n</code></pre>","children":[]}],"payload":{"lines":"170,171","fold":1}},{"content":"Package des langues","children":[{"content":"<pre><code class=\"language-php\">  composer <span class=\"hljs-keyword\">require</span> --dev laravel-lang/common\n  php artisan lang:update\n</code></pre>","children":[]},{"content":"<pre data-lines=\"195,196\"><code>Et Modifier dans le fichier généré: lang/fr.Json :\n</code></pre>","children":[],"payload":{"lines":"195,196"}},{"content":"<pre><code class=\"language-json\">  <span class=\"hljs-attr\">\"Home\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"Maison\"</span><span class=\"hljs-punctuation\">,</span>\n</code></pre>","children":[]},{"content":"<pre data-lines=\"201,202\"><code>en :\n</code></pre>","children":[],"payload":{"lines":"201,202"}},{"content":"<pre><code class=\"language-json\">  <span class=\"hljs-attr\">\"Home\"</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">\"Accueil\"</span><span class=\"hljs-punctuation\">,</span>\n</code></pre>","children":[]}],"payload":{"lines":"188,189","fold":1}},{"content":"Les données","children":[{"content":"Tables users","children":[{"content":"database/migrations/0001_01_01_000000_create_users_table.php","children":[{"content":"<pre><code class=\"language-php\">  public function up(): void {\n    Schema::create('users', function (Blueprint $table) {\n      $table-&gt;id();\n      $table-&gt;string('name')-&gt;unique();\n      $table-&gt;string('email')-&gt;unique();\n      $table-&gt;string('password');\n      $table-&gt;enum('role', ['user', 'redac', 'admin'])-&gt;default('user');\n      $table-&gt;boolean('valid')-&gt;default(false);\n      $table-&gt;rememberToken();\n      $table-&gt;timestamps();\n    });\n    ...\n  }\n</code></pre>","children":[]}],"payload":{"lines":"211,212","fold":1}},{"content":"database/factories/UserFactory.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">return</span> [\n    <span class=\"hljs-string\">'name'</span>           =&gt; <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">lastname</span>(),\n    <span class=\"hljs-string\">'email'</span>          =&gt; <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">unique</span>()-&gt;<span class=\"hljs-title function_ invoke__\">safeEmail</span>(),\n    <span class=\"hljs-string\">'password'</span>       =&gt; <span class=\"hljs-built_in\">static</span>::<span class=\"hljs-variable\">$password</span> ??= <span class=\"hljs-title class_\">Hash</span>::<span class=\"hljs-title function_ invoke__\">make</span>(<span class=\"hljs-string\">'password'</span>),\n    <span class=\"hljs-string\">'remember_token'</span> =&gt; <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">random</span>(<span class=\"hljs-number\">10</span>),\n    <span class=\"hljs-string\">'valid'</span>          =&gt; <span class=\"hljs-literal\">true</span>,\n  ];\n</code></pre>","children":[]}],"payload":{"lines":"229,230","fold":1}},{"content":"app/Models/User.php","children":[{"content":"<pre><code class=\"language-php\">  ...\n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">User</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Authenticatable</span>\n  </span>{   \n    ...\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [<span class=\"hljs-string\">'name'</span>, <span class=\"hljs-string\">'email'</span>, <span class=\"hljs-string\">'password'</span>, <span class=\"hljs-string\">'role'</span>, <span class=\"hljs-string\">'valid'</span>];\n  }\n</code></pre>","children":[]}],"payload":{"lines":"241,242","fold":1}}],"payload":{"lines":"209,210","fold":1}},{"content":"Tables categories","children":[{"content":"Model &amp; migration des categories","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:model Category --migration\n</code></pre>","children":[]}],"payload":{"lines":"254,255","fold":1}},{"content":"Migrations des categories","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'categories'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'title'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">unique</span>();\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'slug'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">unique</span>();\n    });\n  }\n</code></pre>","children":[]}],"payload":{"lines":"260,261","fold":1}},{"content":"app/Models/Category","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  ...\n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Category</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$timestamps</span> = <span class=\"hljs-literal\">false</span>;\n  \n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [<span class=\"hljs-string\">'title'</span>, <span class=\"hljs-string\">'slug'</span>];\n  }\n</code></pre>","children":[]}],"payload":{"lines":"272,273","fold":1}}],"payload":{"lines":"252,253","fold":1}},{"content":"Tables posts (Articles)","children":[{"content":"Création model &amp; migration des articles","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:model Post --migration\n</code></pre>","children":[]}],"payload":{"lines":"287,288","fold":1}},{"content":"Migration des articles","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'posts'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">timestamps</span>();\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'title'</span>);\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'slug'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">unique</span>();\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">mediumText</span>(<span class=\"hljs-string\">'body'</span>);\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">boolean</span>(<span class=\"hljs-string\">'active'</span>)-&gt;<span class=\"hljs-keyword\">default</span>(<span class=\"hljs-literal\">false</span>);\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'image'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">nullable</span>();\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'seo_title'</span>);\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">text</span>(<span class=\"hljs-string\">'meta_description'</span>);\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">text</span>(<span class=\"hljs-string\">'meta_keywords'</span>);\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">boolean</span>(<span class=\"hljs-string\">'pinned'</span>)-&gt;<span class=\"hljs-keyword\">default</span>(<span class=\"hljs-literal\">false</span>);\n\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreignId</span>(<span class=\"hljs-string\">'user_id'</span>)\n      -&gt;<span class=\"hljs-title function_ invoke__\">constrained</span>()\n      -&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>)\n      -&gt;<span class=\"hljs-title function_ invoke__\">onUpdate</span>(<span class=\"hljs-string\">'cascade'</span>);\n\n    <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreignId</span>(<span class=\"hljs-string\">'category_id'</span>)\n      -&gt;<span class=\"hljs-title function_ invoke__\">constrained</span>()\n      -&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>)\n      -&gt;<span class=\"hljs-title function_ invoke__\">onUpdate</span>(<span class=\"hljs-string\">'cascade'</span>);\n    });\n  }\n</code></pre>","children":[]}],"payload":{"lines":"293,294","fold":1}},{"content":"Création Factory des articles","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:factory PostFactory\n</code></pre>","children":[]}],"payload":{"lines":"323,324","fold":1}},{"content":"Code factory articles","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">definition</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">array</span> </span>{\n    <span class=\"hljs-keyword\">return</span> [\n      <span class=\"hljs-string\">'body'</span>             =&gt; <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">paragraphs</span>(<span class=\"hljs-variable\">$nb</span> = <span class=\"hljs-number\">8</span>, <span class=\"hljs-variable\">$asText</span> = <span class=\"hljs-literal\">true</span>),\n      <span class=\"hljs-string\">'meta_description'</span> =&gt; <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">sentence</span>(<span class=\"hljs-variable\">$nbWords</span> = <span class=\"hljs-number\">6</span>, <span class=\"hljs-variable\">$variableNbWords</span> = <span class=\"hljs-literal\">true</span>),\n      <span class=\"hljs-string\">'meta_keywords'</span>    =&gt; <span class=\"hljs-title function_ invoke__\">implode</span>(<span class=\"hljs-string\">','</span>, <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">words</span>(<span class=\"hljs-variable\">$nb</span> = <span class=\"hljs-number\">3</span>, <span class=\"hljs-variable\">$asText</span> = <span class=\"hljs-literal\">false</span>)),\n      <span class=\"hljs-string\">'active'</span>           =&gt; <span class=\"hljs-literal\">true</span>,\n    ];\n  }\n</code></pre>","children":[]}],"payload":{"lines":"329,330","fold":1}},{"content":"app/Models/Post","children":[{"content":"<pre><code class=\"language-php\">  ...\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Factories</span>\\<span class=\"hljs-title\">HasFactory</span>;\n  ...\n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Post</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">HasFactory</span>;\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [<span class=\"hljs-string\">'title'</span>, <span class=\"hljs-string\">'slug'</span>, <span class=\"hljs-string\">'body'</span>, <span class=\"hljs-string\">'active'</span>, <span class=\"hljs-string\">'image'</span>, <span class=\"hljs-string\">'user_id'</span>, <span class=\"hljs-string\">'category_id'</span>, <span class=\"hljs-string\">'seo_title'</span>, <span class=\"hljs-string\">'meta_description'</span>, <span class=\"hljs-string\">'meta_keywords'</span>, <span class=\"hljs-string\">'pinned'</span>];\n  }\n</code></pre>","children":[]}],"payload":{"lines":"342,343","fold":1}}],"payload":{"lines":"285,286","fold":1}},{"content":"Les relations","children":[{"content":"Les relations dans Models/Post.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\<span class=\"hljs-title\">BelongsTo</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Post</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    ...\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">user</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">BelongsTo</span> </span>{\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">belongsTo</span>(<span class=\"hljs-title class_\">User</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">category</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">BelongsTo</span> </span>{\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">belongsTo</span>(<span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"357,358","fold":1}},{"content":"La relation dans Models/User.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\<span class=\"hljs-title\">HasMany</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">User</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Authenticatable</span>\n  </span>{\n    ...\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">posts</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">HasMany</span> </span>{\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">hasMany</span>(<span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n    ...\n  }\n</code></pre>","children":[]}],"payload":{"lines":"374,375","fold":1}},{"content":"La relation dans Models/Category.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\<span class=\"hljs-title\">HasMany</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Category</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    ...\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">posts</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">HasMany</span> </span>{\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">hasMany</span>(<span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"389,390","fold":1}}],"payload":{"lines":"355,356","fold":1}},{"content":"Exécution des migrations","children":[{"content":"<strong>php artisan migrate</strong>","children":[],"payload":{"lines":"405,406"}},{"content":"<strong><a href=\"https://laravel.sillo.org/storage/photos/2024/08/XIVfqMqmJ7OUNl9kwGWNk5duv0U0nweTIz2nbI1E.png\">Voir diagramme UML des 3 tables</a></strong>","children":[],"payload":{"lines":"407,408"}}],"payload":{"lines":"403,404","fold":1}},{"content":"Population de users","children":[{"content":"Création du seeder User","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:seeder UserSeeder\n</code></pre>","children":[]}],"payload":{"lines":"411,412"}},{"content":"Code du seeder des fake users","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">Database</span>\\<span class=\"hljs-title class_\">Seeders</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Carbon</span>\\<span class=\"hljs-title\">Carbon</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">User</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserSeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-variable\">$users</span> = [\n        [\n            <span class=\"hljs-string\">'name'</span>       =&gt; <span class=\"hljs-string\">'Admin'</span>,\n            <span class=\"hljs-string\">'email'</span>      =&gt; <span class=\"hljs-string\">'admin@example.com'</span>,\n            <span class=\"hljs-string\">'role'</span>       =&gt; <span class=\"hljs-string\">'admin'</span>,\n            <span class=\"hljs-string\">'created_at'</span> =&gt; <span class=\"hljs-title class_\">Carbon</span>::<span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">subYears</span>(<span class=\"hljs-number\">3</span>),\n            <span class=\"hljs-string\">'updated_at'</span> =&gt; <span class=\"hljs-title class_\">Carbon</span>::<span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">subYears</span>(<span class=\"hljs-number\">3</span>),\n        ],\n        [\n            <span class=\"hljs-string\">'name'</span>       =&gt; <span class=\"hljs-string\">'Redac'</span>,\n            <span class=\"hljs-string\">'email'</span>      =&gt; <span class=\"hljs-string\">'redac@example.com'</span>,\n            <span class=\"hljs-string\">'role'</span>       =&gt; <span class=\"hljs-string\">'redac'</span>,\n            <span class=\"hljs-string\">'created_at'</span> =&gt; <span class=\"hljs-title class_\">Carbon</span>::<span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">subYears</span>(<span class=\"hljs-number\">3</span>),\n            <span class=\"hljs-string\">'updated_at'</span> =&gt; <span class=\"hljs-title class_\">Carbon</span>::<span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">subYears</span>(<span class=\"hljs-number\">3</span>),\n        ],\n        [\n            <span class=\"hljs-string\">'name'</span>       =&gt; <span class=\"hljs-string\">'User'</span>,\n            <span class=\"hljs-string\">'email'</span>      =&gt; <span class=\"hljs-string\">'user@example.com'</span>,\n            <span class=\"hljs-string\">'role'</span>       =&gt; <span class=\"hljs-string\">'user'</span>,\n            <span class=\"hljs-string\">'created_at'</span> =&gt; <span class=\"hljs-title class_\">Carbon</span>::<span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">subYears</span>(<span class=\"hljs-number\">2</span>),\n            <span class=\"hljs-string\">'updated_at'</span> =&gt; <span class=\"hljs-title class_\">Carbon</span>::<span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">subYears</span>(<span class=\"hljs-number\">2</span>),\n        ],\n      ];\n  \n      <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$users</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$userData</span>) {\n        <span class=\"hljs-title class_\">User</span>::<span class=\"hljs-title function_ invoke__\">factory</span>()-&gt;<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-variable\">$userData</span>);\n      }\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"417,418"}}],"payload":{"lines":"409,410","fold":1}},{"content":"Population de categories","children":[{"content":"Création du seeder Category","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:seeder CategorySeeder\n</code></pre>","children":[]}],"payload":{"lines":"463,464"}},{"content":"Code du seeder des fake categories","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">Database</span>\\<span class=\"hljs-title class_\">Seeders</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">Category</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">CategorySeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-variable\">$categories</span> = [\n        [\n          <span class=\"hljs-string\">'title'</span> =&gt; <span class=\"hljs-string\">'Categorie 1'</span>,\n          <span class=\"hljs-string\">'slug'</span>  =&gt; <span class=\"hljs-string\">'category-1'</span>,\n        ],\n        [\n          <span class=\"hljs-string\">'title'</span> =&gt; <span class=\"hljs-string\">'Categorie 2'</span>,\n          <span class=\"hljs-string\">'slug'</span>  =&gt; <span class=\"hljs-string\">'category-2'</span>,\n        ],\n        [\n          <span class=\"hljs-string\">'title'</span> =&gt; <span class=\"hljs-string\">'Categorie 3'</span>,\n          <span class=\"hljs-string\">'slug'</span>  =&gt; <span class=\"hljs-string\">'category-3'</span>,\n        ],\n      ];\n  \n      <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$categories</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$categoryData</span>) {\n        <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-variable\">$categoryData</span>);\n      }\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"469,470"}}],"payload":{"lines":"461,462","fold":1}},{"content":"Population de posts","children":[{"content":"Créer app/helpers.php","children":[{"content":"Y copier : generateRandomDateInRange()","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">function_exists</span>(<span class=\"hljs-string\">'generateRandomDateInRange'</span>)) {\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">generateRandomDateInRange</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$startDate</span>, <span class=\"hljs-variable\">$endDate</span></span>) </span>{\n      <span class=\"hljs-variable\">$start</span> = <span class=\"hljs-title class_\">Carbon\\Carbon</span>::<span class=\"hljs-title function_ invoke__\">parse</span>(<span class=\"hljs-variable\">$startDate</span>);\n      <span class=\"hljs-variable\">$end</span>   = <span class=\"hljs-title class_\">Carbon\\Carbon</span>::<span class=\"hljs-title function_ invoke__\">parse</span>(<span class=\"hljs-variable\">$endDate</span>);\n  \n      <span class=\"hljs-variable\">$difference</span> = <span class=\"hljs-variable\">$end</span>-&gt;timestamp - <span class=\"hljs-variable\">$start</span>-&gt;timestamp;\n  \n      <span class=\"hljs-variable\">$randomSeconds</span> = <span class=\"hljs-title function_ invoke__\">rand</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-variable\">$difference</span>);\n  \n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$start</span>-&gt;<span class=\"hljs-title function_ invoke__\">copy</span>()-&gt;<span class=\"hljs-title function_ invoke__\">addSeconds</span>(<span class=\"hljs-variable\">$randomSeconds</span>);\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"507,508"}},{"content":"Activation de ce helper dans composer.json","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"autoload\"</span>: {\n      <span class=\"hljs-string\">\"files\"</span>: [\n        <span class=\"hljs-string\">\"app/helpers.php\"</span>\n      ],\n      ...\n  },\n</code></pre>","children":[]}],"payload":{"lines":"525,526"}},{"content":"Update de l'autoload","children":[{"content":"<pre><code class=\"language-php\">  composer dumpautoload\n</code></pre>","children":[]}],"payload":{"lines":"536,537"}}],"payload":{"lines":"505,506","fold":1}},{"content":"Création du seeder de fake posts","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:seeder PostSeeder\n</code></pre>","children":[]}],"payload":{"lines":"542,543"}},{"content":"Code du seeder des fake posts","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">Database</span>\\<span class=\"hljs-title class_\">Seeders</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">Post</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Str</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">PostSeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-built_in\">static</span> <span class=\"hljs-variable\">$nbrPosts</span>;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-variable\">$nbrCategories</span> = <span class=\"hljs-number\">3</span>;\n  \n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>);\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-title function_ invoke__\">rand</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$nbrCategories</span>));\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">1</span>);\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>);\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">5</span>, <span class=\"hljs-title function_ invoke__\">rand</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$nbrCategories</span>));\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">6</span>, <span class=\"hljs-number\">1</span>);\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">7</span>, <span class=\"hljs-number\">1</span>);\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">8</span>, <span class=\"hljs-title function_ invoke__\">rand</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$nbrCategories</span>));\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createPost</span>(<span class=\"hljs-number\">9</span>, <span class=\"hljs-title function_ invoke__\">rand</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$nbrCategories</span>));\n    }\n  \n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">createPost</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$id</span>, <span class=\"hljs-variable\">$category_id</span></span>) </span>{\n      <span class=\"hljs-variable\">$months</span> = [<span class=\"hljs-string\">'03'</span>, <span class=\"hljs-string\">'03'</span>, <span class=\"hljs-string\">'03'</span>, <span class=\"hljs-string\">'04'</span>, <span class=\"hljs-string\">'04'</span>, <span class=\"hljs-string\">'06'</span>, <span class=\"hljs-string\">'06'</span>, <span class=\"hljs-string\">'06'</span>, <span class=\"hljs-string\">'06'</span>];\n  \n      <span class=\"hljs-variable\">$date</span> = <span class=\"hljs-title function_ invoke__\">generateRandomDateInRange</span>(<span class=\"hljs-string\">'2022-01-01'</span>, <span class=\"hljs-string\">'2024-07-01'</span>);\n  \n      <span class=\"hljs-variable\">$postId</span> = <span class=\"hljs-string\">\"Post <span class=\"hljs-subst\">{$id}</span>\"</span>;\n  \n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">factory</span>()-&gt;<span class=\"hljs-title function_ invoke__\">create</span>([\n        <span class=\"hljs-string\">'title'</span>       =&gt; <span class=\"hljs-variable\">$postId</span>,\n        <span class=\"hljs-string\">'seo_title'</span>   =&gt; <span class=\"hljs-variable\">$postId</span>,\n        <span class=\"hljs-string\">'slug'</span>        =&gt; <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">of</span>(<span class=\"hljs-variable\">$postId</span>)-&gt;<span class=\"hljs-title function_ invoke__\">slug</span>(<span class=\"hljs-string\">'-'</span>),\n        <span class=\"hljs-string\">'user_id'</span>     =&gt; <span class=\"hljs-title function_ invoke__\">rand</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>),\n        <span class=\"hljs-string\">'image'</span>       =&gt; <span class=\"hljs-string\">'2024/'</span> . <span class=\"hljs-variable\">$months</span>[<span class=\"hljs-variable\">$id</span> - <span class=\"hljs-number\">1</span>] . <span class=\"hljs-string\">'/img0'</span> . <span class=\"hljs-variable\">$id</span> . <span class=\"hljs-string\">'.jpg'</span>,\n        <span class=\"hljs-string\">'category_id'</span> =&gt; <span class=\"hljs-variable\">$category_id</span>,\n        <span class=\"hljs-string\">'created_at'</span>  =&gt; <span class=\"hljs-variable\">$date</span>,\n        <span class=\"hljs-string\">'updated_at'</span>  =&gt; <span class=\"hljs-variable\">$date</span>,\n        <span class=\"hljs-string\">'pinned'</span>      =&gt; <span class=\"hljs-number\">5</span> == <span class=\"hljs-variable\">$id</span>,\n      ]);\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"548,549"}}],"payload":{"lines":"503,504","fold":1}},{"content":"Activation des seeders","children":[{"content":"<pre data-lines=\"600,601\"><code>database/seeders/DatabaseSeeder.php :\n</code></pre>","children":[],"payload":{"lines":"600,601"}},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">Database</span>\\<span class=\"hljs-title class_\">Seeders</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DatabaseSeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n  </span>{\n    <span class=\"hljs-comment\">/**\n     * Seed the application's database.\n     */</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n      <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">call</span>([\n        <span class=\"hljs-title class_\">UserSeeder</span>::<span class=\"hljs-variable language_\">class</span>,\n        <span class=\"hljs-title class_\">CategorySeeder</span>::<span class=\"hljs-variable language_\">class</span>,\n        <span class=\"hljs-title class_\">PostSeeder</span>::<span class=\"hljs-variable language_\">class</span>,          \n      ]);\n  \n      <span class=\"hljs-title function_ invoke__\">printf</span>(<span class=\"hljs-string\">'%s%s'</span>, <span class=\"hljs-title function_ invoke__\">str_repeat</span>(<span class=\"hljs-string\">' '</span>, <span class=\"hljs-number\">2</span>), <span class=\"hljs-string\">\"Data tables properly filled.\\n\\n\"</span>);\n    }\n  }\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  php artisan db:seed\n<span class=\"hljs-comment\">// Ou, reset complet :</span>\n  php artisan migrate:refresh --seed\n</code></pre>","children":[]}],"payload":{"lines":"598,599","fold":1}},{"content":"Les pages","children":[{"content":"Création Model &amp; migration Page","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:model Page --migration\n</code></pre>","children":[]}],"payload":{"lines":"633,634","fold":1}},{"content":"Code migration Page","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span>\n  </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'pages'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'slug'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'title'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">mediumText</span>(<span class=\"hljs-string\">'body'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">boolean</span>(<span class=\"hljs-string\">'active'</span>)-&gt;<span class=\"hljs-keyword\">default</span>(<span class=\"hljs-literal\">false</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'seo_title'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">text</span>(<span class=\"hljs-string\">'meta_description'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">text</span>(<span class=\"hljs-string\">'meta_keywords'</span>);\n    });\n  }\n</code></pre>","children":[]}],"payload":{"lines":"639,640","fold":1}},{"content":"Code app/models/Page","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">App</span>\\<span class=\"hljs-title class_\">Models</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Model</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Factories</span>\\<span class=\"hljs-title\">HasFactory</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Page</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">HasFactory</span>;\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$timestamps</span>  = <span class=\"hljs-literal\">false</span>;\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [\n      <span class=\"hljs-string\">'title'</span>,\n      <span class=\"hljs-string\">'slug'</span>,\n      <span class=\"hljs-string\">'body'</span>,\n      <span class=\"hljs-string\">'active'</span>,\n      <span class=\"hljs-string\">'seo_title'</span>,\n      <span class=\"hljs-string\">'meta_description'</span>,\n      <span class=\"hljs-string\">'meta_keywords'</span>,\n    ];\n  }\n</code></pre>","children":[]}],"payload":{"lines":"657,658","fold":1}},{"content":"Création factory Page","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:factory PageFactory\n</code></pre>","children":[]}],"payload":{"lines":"683,684","fold":1}},{"content":"Code factory Page","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">definition</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">array</span> </span>{\n    <span class=\"hljs-keyword\">return</span> [\n      <span class=\"hljs-string\">'body'</span>             =&gt; <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">paragraph</span>(<span class=\"hljs-number\">10</span>),\n      <span class=\"hljs-string\">'meta_description'</span> =&gt; <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">sentence</span>(<span class=\"hljs-variable\">$nbWords</span> = <span class=\"hljs-number\">6</span>, <span class=\"hljs-variable\">$variableNbWords</span> = <span class=\"hljs-literal\">true</span>),\n      <span class=\"hljs-string\">'meta_keywords'</span>    =&gt; <span class=\"hljs-title function_ invoke__\">implode</span>(<span class=\"hljs-string\">','</span>, <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">words</span>(<span class=\"hljs-variable\">$nb</span> = <span class=\"hljs-number\">3</span>, <span class=\"hljs-variable\">$asText</span> = <span class=\"hljs-literal\">false</span>)),\n    ];\n  }\n</code></pre>","children":[]}],"payload":{"lines":"689,690","fold":1}},{"content":"Création seeder Page","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:seeder PageSeeder\n</code></pre>","children":[]}],"payload":{"lines":"701,702","fold":1}},{"content":"Code du seeder Page","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">Database</span>\\<span class=\"hljs-title class_\">Seeders</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">Page</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">PageSeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-variable\">$items</span> = [\n        [<span class=\"hljs-string\">'slug'</span> =&gt; <span class=\"hljs-string\">'terms'</span>, <span class=\"hljs-string\">'title'</span> =&gt; <span class=\"hljs-string\">'Terms'</span>],\n        [<span class=\"hljs-string\">'slug'</span> =&gt; <span class=\"hljs-string\">'privacy-policy'</span>, <span class=\"hljs-string\">'title'</span> =&gt; <span class=\"hljs-string\">'Privacy Policy'</span>],\n      ];\n  \n      <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$items</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$item</span>) {\n        <span class=\"hljs-title class_\">Page</span>::<span class=\"hljs-title function_ invoke__\">factory</span>()-&gt;<span class=\"hljs-title function_ invoke__\">create</span>([\n          <span class=\"hljs-string\">'title'</span>     =&gt; <span class=\"hljs-variable\">$item</span>[<span class=\"hljs-string\">'title'</span>],\n          <span class=\"hljs-string\">'seo_title'</span> =&gt; <span class=\"hljs-string\">'Page '</span> . <span class=\"hljs-variable\">$item</span>[<span class=\"hljs-string\">'title'</span>],\n          <span class=\"hljs-string\">'slug'</span>      =&gt; <span class=\"hljs-variable\">$item</span>[<span class=\"hljs-string\">'slug'</span>],\n          <span class=\"hljs-string\">'active'</span>    =&gt; <span class=\"hljs-literal\">true</span>,\n        ]);\n      }\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"707,708","fold":1}},{"content":"Ajout de ce seeder dans DatabaseSeeder.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">call</span>([\n      ...\n      <span class=\"hljs-title class_\">PageSeeder</span>::<span class=\"hljs-variable language_\">class</span>,   \n    ]);\n    ...\n  }\n</code></pre>","children":[]}],"payload":{"lines":"736,737","fold":1}},{"content":"Rafraîchissement la base","children":[{"content":"<pre><code class=\"language-php\">  php artisan migrate:fresh --seed\n</code></pre>","children":[]}],"payload":{"lines":"748,749","fold":1}}],"payload":{"lines":"631,632","fold":1}}],"payload":{"lines":"207,208","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-donnees\">https://laravel.sillo.org/posts/mon-cms-les-donnees</a></strong></em>","children":[],"payload":{"lines":"754,755"}}],"payload":{"lines":"139,140","fold":1}},{"content":"<strong>0I / F R O N T - E N D &nbsp;:</strong>","children":[],"payload":{"lines":"756,757"}},{"content":"- L'authentification","children":[{"content":"Installer MaryUI (Avec Volt et npm)","children":[{"content":"Voir ci-avant : Généralités / Technos","children":[],"payload":{"lines":"762,763"}},{"content":"Sont alors créés (Entre autres...)","children":[{"content":"Une route (routes/web.php)","children":[],"payload":{"lines":"766,767"}},{"content":"Un layout (resources\\views\\components\\layouts\\app.blade.php)","children":[],"payload":{"lines":"767,768"}},{"content":"Un composant Volt (resources\\views\\livewire\\users\\index.blade.php)","children":[],"payload":{"lines":"768,770"}}],"payload":{"lines":"764,765"}},{"content":"Rappel : Dorénavant, lancer aussi le serveur Vite","children":[{"content":"<strong><a href=\"http://127.0.0.1:8000\">URL du rendu</a></strong>","children":[],"payload":{"lines":"776,777"}}],"payload":{"lines":"770,771"}}],"payload":{"lines":"760,761","fold":1}},{"content":"Layout pour l'authentification","children":[{"content":"<pre data-lines=\"780,781\"><code>./resources/views/components/layouts/auth.blade.php\n</code></pre>","children":[],"payload":{"lines":"780,781"}},{"content":"<pre><code class=\"language-php\">&lt;!DOCTYPE html&gt;\n&lt;html lang=\"{{ str_replace('_', '-', app()-&gt;getLocale()) }}\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover\"&gt;\n    &lt;meta name=\"csrf-token\" content=\"{{ csrf_token() }}\"&gt;\n    &lt;title&gt;{{ isset($title) ? $title . ' | ' . config('app.name') : config('app.name') }}&lt;/title&gt;\n\n    @vite(['resources/css/app.css', 'resources/js/app.js'])\n&lt;/head&gt;\n\n&lt;body class=\"min-h-screen font-sans antialiased bg-base-200/50 dark:bg-base-200\"&gt;\n\n    &lt;x-main full-width&gt;\n        &lt;x-slot:content&gt;\n            {{ $slot }}\n        &lt;/x-slot:content&gt;\n    &lt;/x-main&gt;\n\n    &lt;x-toast /&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>","children":[]}],"payload":{"lines":"778,779","fold":1}},{"content":"Composants VOLT pour authentification","children":[{"content":"Composant Register","children":[{"content":"Route pour Register","children":[{"content":"<pre data-lines=\"815,816\"><code>./routes/web.php :\n</code></pre>","children":[],"payload":{"lines":"815,816"}},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Facades</span>\\<span class=\"hljs-title\">Route</span>;\n  ...\n  <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'guest'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/register'</span>, <span class=\"hljs-string\">'auth.register'</span>);\n  });\n</code></pre>","children":[]}],"payload":{"lines":"813,814","fold":1}},{"content":"Création composant Register","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt auth/register --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"825,826","fold":1}},{"content":"Code register","children":[{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use App\\Models\\User;\n  use Mary\\Traits\\Toast;\n  use Livewire\\Volt\\Component;\n  use Illuminate\\Support\\Facades\\Hash;\n  use App\\Notifications\\UserRegistered;\n  use Livewire\\Attributes\\{Layout, Validate, Title};\n  \n  new #[Title('Register')] #[Layout('components.layouts.auth')] \n  class extends Component {\n      use Toast;\n\n    #[Validate('required|string|max:255|unique:users')]\n    public string $name = '';\n    #[Validate('required|email|unique:users')]\n    public string $email = '';\n    #[Validate('required|confirmed')]\n    public string $password = '';\n    #[Validate('required')]\n    public string $password_confirmation = '';\n    #[Validate('sometimes|nullable')]\n    public ?string $gender = null;\n\n    public function register() {\n      if ($this-&gt;gender) {\n          abort(403);\n      }\n      $data = $this-&gt;validate();\n      $user = $this-&gt;createUser($data);\n      auth()-&gt;login($user);\n      request()-&gt;session()-&gt;regenerate();\n      $this-&gt;success(__('Registration successful!'), redirectTo: '/');\n    }\n\n    protected function createUser(array $data): User {\n        $data['password'] = Hash::make($data['password']);\n        return User::create($data);\n    }\n  \n  }; ?&gt;\n  \n  &lt;div&gt;\n      &lt;x-card class=\"flex items-center justify-center h-screen\" title=\"{{ __('Register') }}\" shadow separator\n          progress-indicator&gt;\n  \n          &lt;x-form wire:submit=\"register\" class=\"w-full sm:min-w-[30vw]\"&gt;\n              &lt;x-input label=\"{{ __('Name') }}\" wire:model=\"name\" icon=\"o-user\" inline required /&gt;\n              &lt;x-input label=\"{{ __('E-mail') }}\" wire:model=\"email\" icon=\"o-envelope\" inline required /&gt;\n              &lt;x-input label=\"{{ __('Password') }}\" wire:model=\"password\" type=\"password\" icon=\"o-key\" inline required /&gt;\n              &lt;x-input label=\"{{ __('Confirm Password') }}\" wire:model=\"password_confirmation\" type=\"password\"\n                  icon=\"o-key\" inline required /&gt;\n              &lt;div style=\"display: none;\"&gt;\n                  &lt;x-input wire:model=\"gender\" type=\"text\" inline /&gt;\n              &lt;/div&gt;\n              &lt;x-slot:actions&gt;\n                  &lt;x-button label=\"{{ __('Already registered?') }}\" class=\"btn-ghost\" link=\"/login\" /&gt;\n                  &lt;x-button label=\"{{ __('Register') }}\" type=\"submit\" icon=\"o-paper-airplane\" class=\"btn-primary\"\n                      spinner=\"login\" /&gt;\n              &lt;/x-slot:actions&gt;\n          &lt;/x-form&gt;\n  \n      &lt;/x-card&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"831,832","fold":1}},{"content":"Traduction pour formulaire Register","children":[{"content":"<pre data-lines=\"901,902\"><code>./lang/fr.json\n</code></pre>","children":[],"payload":{"lines":"901,902"}},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"Password\"</span>: <span class=\"hljs-string\">\"Mot de passe\"</span>,\n  <span class=\"hljs-string\">\"Confirm Password\"</span>: <span class=\"hljs-string\">\"Confirmation du mot de passe\"</span>,\n  <span class=\"hljs-string\">\"Register\"</span>: <span class=\"hljs-string\">\"Créer un compte\"</span>,\n  <span class=\"hljs-string\">\"Already registered?\"</span>: <span class=\"hljs-string\">\"Déjà enregistré ?\"</span>,\n  <span class=\"hljs-string\">\"Name\"</span>: <span class=\"hljs-string\">\"Nom\"</span>,\n  <span class=\"hljs-string\">\"E-mail\"</span>: <span class=\"hljs-string\">\"Courriel\"</span>,\n  <span class=\"hljs-string\">\"Registration successful!\"</span>: <span class=\"hljs-string\">\"Compte créé avec succès !\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"899,900","fold":1}},{"content":"Particularité : Pot de miel","children":[{"content":"<pre data-lines=\"915,917\"><code>À noter: ∃ un champs caché (gender) pour identifier les robots...\nVoir dans le code du composant: if ($this-&gt;gender) abort(403);\n</code></pre>","children":[],"payload":{"lines":"915,917"}}],"payload":{"lines":"913,914","fold":1}},{"content":"<strong><a href=\"http://127.0.0.1:8000/register\">Rendu Register</a></strong> (Tester la validation des champs)","children":[],"payload":{"lines":"918,919"}}],"payload":{"lines":"811,812"}},{"content":"Composant Login","children":[{"content":"Route pour Login","children":[{"content":"<pre><code class=\"language-php\">  ...\n  <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'guest'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/login'</span>, <span class=\"hljs-string\">'auth.login'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'login'</span>);\n  });\n</code></pre>","children":[]}],"payload":{"lines":"922,923","fold":1}},{"content":"Création composant Login","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt auth/login --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"932,933","fold":1}},{"content":"Code Login","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n  use Livewire\\Attributes\\{Layout, Validate, Title};\n  use Livewire\\Volt\\Component;\n  use Illuminate\\Support\\Str;\n  use Illuminate\\Auth\\Events\\Lockout;\n  use Illuminate\\Support\\Facades\\Auth;\n  use Illuminate\\Support\\Facades\\RateLimiter;\n  use Illuminate\\Validation\\ValidationException;\n  \n  new\n  #[Title('Login')] #[Layout('components.layouts.auth')]\n  class extends Component {\n  \n    #[Validate('required|string|email')]\n    public string $email = '';\n    #[Validate('required|string')]\n    public string $password = '';\n    #[Validate('boolean')]\n    public bool $remember = false;\n\n  \tpublic function login() {\n      $this-&gt;validate();\n      $this-&gt;authenticate();\n      Session::regenerate();\n      if (auth()-&gt;user()-&gt;isAdmin()) {\n          return redirect()-&gt;intended('/admin/dashboard');\n      }\n      $this-&gt;redirectIntended(default: url('/'), navigate: true);\n  \t}\n  \n    public function authenticate(): void {\n      $this-&gt;ensureIsNotRateLimited();\n      if (! Auth::attempt($this-&gt;only(['email', 'password']), $this-&gt;remember)) {\n        RateLimiter::hit($this-&gt;throttleKey());\n        throw ValidationException::withMessages([\n            'email' =&gt; __('auth.failed'),\n        ]);\n      }\n      RateLimiter::clear($this-&gt;throttleKey());\n    }\n  \n    protected function ensureIsNotRateLimited(): void {\n      if (! RateLimiter::tooManyAttempts($this-&gt;throttleKey(), 5)) {\n        return;\n      }\n      event(new Lockout(request()));\n      $seconds = RateLimiter::availableIn($this-&gt;throttleKey());\n      throw ValidationException::withMessages([\n        'email' =&gt; trans('auth.throttle', [\n          'seconds' =&gt; $seconds,\n          'minutes' =&gt; ceil($seconds / 60),\n        ]),\n      ]);\n    }\n\n    protected function throttleKey(): string {\n      return Str::transliterate(Str::lower($this-&gt;email).'|'. request()-&gt;ip());\n    }\n  \n  }; ?&gt;\n  \n  &lt;div&gt;\n    &lt;x-card class=\"flex items-center justify-center h-screen\" title=\"{{ __('Login') }}\" shadow separator progress-indicator&gt;\n      &lt;x-form wire:submit=\"login\"&gt;\n        &lt;x-input label=\"{{ __('E-mail') }}\" wire:model=\"email\" icon=\"o-envelope\" type=\"email\" inline /&gt;\n        &lt;x-input label=\"{{ __('Password') }}\" wire:model=\"password\" type=\"password\" icon=\"o-key\" type=\"password\" inline /&gt;\n        &lt;x-checkbox label=\"{{ __('Remember me') }}\" wire:model=\"remember\" /&gt;\n        &lt;x-slot:actions&gt;\n          &lt;div class=\"flex flex-col space-y-2 flex-end sm:flex-row sm:space-y-0 sm:space-x-2\"&gt;\n            &lt;x-button label=\"{{ __('Login') }}\" type=\"submit\" icon=\"o-paper-airplane\" class=\"ml-2 btn-primary sm:order-1\" /&gt;\n            &lt;div class=\"flex flex-col space-y-2 flex-end sm:flex-row sm:space-y-0 sm:space-x-2\"&gt;\n              &lt;x-button label=\"{{ __('Forgot your password?') }}\" class=\"btn-ghost\" link=\"/forgot-password\" /&gt;\n              &lt;x-button label=\"{{ __('Register') }}\" class=\"btn-ghost\" link=\"/register\" /&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/x-slot:actions&gt;\n      &lt;/x-form&gt;\n    &lt;/x-card&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"938,939","fold":1}},{"content":"Traduction pour formulaire Login","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"Forgot your password?\"</span>: <span class=\"hljs-string\">\"Mot de passe oublié ?\"</span>,\n  <span class=\"hljs-string\">\"Remember me\"</span>: <span class=\"hljs-string\">\"Se rappeler de moi\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1022,1023","fold":1}},{"content":"<strong><a href=\"http://127.0.0.1:8000/login\">Rendu Login</a></strong> (Tester la validation des champs)","children":[],"payload":{"lines":"1029,1030"}}],"payload":{"lines":"920,921"}},{"content":"Oubli et reset du mot de passe","children":[{"content":"Gestion des sessions","children":[{"content":"Création composant messages en session","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:component session-status --view\n</code></pre>","children":[]}],"payload":{"lines":"1035,1036"}},{"content":"Code composant Session","children":[{"content":"<pre><code class=\"language-php\">  @<span class=\"hljs-title function_ invoke__\">props</span>([<span class=\"hljs-string\">'status'</span>])\n  \n  @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$status</span>)\n    &lt;div {{ <span class=\"hljs-variable\">$attributes</span>-&gt;<span class=\"hljs-title function_ invoke__\">merge</span>([<span class=\"hljs-string\">'class'</span> =&gt; <span class=\"hljs-string\">'font-medium text-sm text-green-600'</span>]) }}&gt;\n      {{ <span class=\"hljs-variable\">$status</span> }}\n    &lt;/div&gt;\n  @<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"1041,1042"}}],"payload":{"lines":"1033,1034","fold":1}},{"content":"Gestion de l'oubli du mot de passe","children":[{"content":"Route pour forgot-password","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'guest'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/forgot-password'</span>, <span class=\"hljs-string\">'auth.forgot-password'</span>);\n  });\n</code></pre>","children":[]}],"payload":{"lines":"1055,1056","fold":1}},{"content":"Création composant oubli mot de passe","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt auth/forgot-password --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1064,1065","fold":1}},{"content":"Composant forgot-password","children":[{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use Illuminate\\Support\\Facades\\Password;\n  use Livewire\\Attributes\\{ Layout, Title };\n  use Livewire\\Volt\\Component;\n  \n  new #[Title('Password renewal')] \n  #[Layout('components.layouts.auth')]\n  class extends Component {\n  \n    public string $email = '';\n    public function sendPasswordResetLink(): void {\n      $this-&gt;validate([\n        'email' =&gt; ['required', 'string', 'email'],\n      ]);\n      $status = Password::sendResetLink(\n          $this-&gt;only('email')\n      );\n      if (Password::RESET_LINK_SENT != $status) {\n          $this-&gt;addError('email', __($status));\n\n          return;\n      }\n  \n      $this-&gt;reset('email');\n      session()-&gt;flash('status', __($status));\n    }\n  }; ?&gt;\n  \n  &lt;div&gt;\n    &lt;x-card class=\"flex items-center justify-center h-screen\" title=\"{{__('Password renewal')}}\" subtitle=\"{{__('Forgot your password? No problem. Just let us know your email address and we will email you a password reset link that will allow you to choose a new one.')}}\" shadow separator  progress-indicator&gt;\n      &lt;x-session-status class=\"mb-4\" :status=\"session('status')\" /&gt;\n      &lt;x-form wire:submit=\"sendPasswordResetLink\"&gt;\n        &lt;x-input label=\"{{__('E-mail')}}\" wire:model=\"email\" icon=\"o-envelope\" inline required /&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button label=\"{{ __('Email Password Reset Link') }}\" type=\"submit\" icon=\"o-paper-airplane\" class=\"btn-primary\" /&gt;\n        &lt;/x-slot:actions&gt;\n      &lt;/x-form&gt;\n    &lt;/x-card&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1070,1071","fold":1}},{"content":"Traduction pour forgot-password","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"Password renewal\"</span>: <span class=\"hljs-string\">\"Renouvellement du mot de passe\"</span>,\n  <span class=\"hljs-string\">\"Forgot your password? No problem. Just let us know your email address and we will email you a password reset link that will allow you to choose a new one.\"</span>: <span class=\"hljs-string\">\"Mot de passe oublié ? Pas de problème. Indiquez-nous simplement votre adresse courriel et nous vous enverrons par courriel un lien de réinitialisation du mot de passe pour en choisir un nouveau.\"</span>,\n  <span class=\"hljs-string\">\"Email Password Reset Link\"</span>: <span class=\"hljs-string\">\"Envoi du lien de renouvellement\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1114,1115","fold":1}},{"content":"<strong><a href=\"http://127.0.0.1:8000/forgot-password\">Rendu forgot-password</a></strong> (Tester la validation du champs - Ne pas soumettre le Formulaire)","children":[],"payload":{"lines":"1122,1123"}}],"payload":{"lines":"1053,1054","fold":1}},{"content":"Gestion du reset du mot de passe","children":[{"content":"Route pour reset-password","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'guest'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/reset-password/{token}'</span>, <span class=\"hljs-string\">'auth.reset-password'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'password.reset'</span>);\n  });\n</code></pre>","children":[]}],"payload":{"lines":"1126,1127","fold":1}},{"content":"Création composant reset-password","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt auth/reset-password --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1135,1136","fold":1}},{"content":"Composant reset-password","children":[{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use Illuminate\\Support\\Str;\n  use Livewire\\Volt\\Component;\n  use Illuminate\\Validation\\Rules;\n  use Livewire\\Attributes\\{Layout, Locked};\n  use Illuminate\\Auth\\Events\\PasswordReset;\n  use Illuminate\\Support\\Facades\\{Hash, Password, Session};\n  \n  new\n  #[Layout('components.layouts.auth')]\n  class extends Component {\n    #[Locked]\n    public string $token                 = '';\n\n    public string $email                 = '';\n    public string $password              = '';\n    public string $password_confirmation = '';\n    \n    public function mount(string $token): void {\n      $this-&gt;token = $token;\n      $this-&gt;email = request()-&gt;input('email');\n    }\n    \n    public function resetPassword(): void {\n      $this-&gt;validate([\n        'token'    =&gt; ['required'],\n        'email'    =&gt; ['required', 'string', 'email'],\n        'password' =&gt; ['required', 'string', 'confirmed', Rules\\Password::defaults()],\n      ]);\n  \n      $status = Password::reset(\n        $this-&gt;only('email', 'password', 'password_confirmation', 'token'),\n        function ($user) {\n          $user-&gt;forceFill([\n              'password'       =&gt; Hash::make($this-&gt;password),\n              'remember_token' =&gt; Str::random(60),\n          ])-&gt;save();\n          event(new PasswordReset($user));\n        }\n      );\n  \n      if (Password::PASSWORD_RESET != $status) {\n          $this-&gt;addError('email', __($status));\n\n          return;\n      }\n  \n      Session::flash('status', __($status));\n      $this-&gt;redirectRoute('login', navigate: true);\n    }\n  }; ?&gt;\n  \n  &lt;div&gt;\n    &lt;x-card class=\"flex items-center justify-center h-screen\" title=\"{{__('Reset Password')}}\" shadow separator progress-indicator&gt;\n      &lt;x-session-status class=\"mb-4\" :status=\"session('status')\" /&gt;\n      &lt;x-form wire:submit=\"resetPassword\"&gt;\n        &lt;x-input label=\"{{__('E-mail')}}\" wire:model=\"email\" icon=\"o-envelope\" inline /&gt;\n        &lt;x-input label=\"{{__('Password')}}\" wire:model=\"password\" type=\"password\" icon=\"o-key\" inline /&gt;\n        &lt;x-input label=\"{{__('Confirm Password')}}\" wire:model=\"password_confirmation\" type=\"password\" icon=\"o-key\" inline required autocomplete=\"new-password\" /&gt;\n        &lt;x-slot:actions&gt;\n          &lt;x-button label=\"{{ __('Reset Password') }}\" type=\"submit\" icon=\"o-paper-airplane\"         class=\"btn-primary\" /&gt;\n        &lt;/x-slot:actions&gt;\n      &lt;/x-form&gt;\n    &lt;/x-card&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1141,1142","fold":1}},{"content":"<strong><a href=\"http://127.0.0.1:8000/forgot-password\">Rendu forgot-password</a></strong> (Tester la soumission du Formulaire)","children":[],"payload":{"lines":"1211,1212"}},{"content":"Voir le email reçu","children":[{"content":"<pre data-lines=\"1215,1218\"><code>- Par défaut: Dans storage\\logs\\laravel.log (Tout à la fin du fichier, le code HTML du courriel)\n\n- OU, pour avoir le vrai rendu de ce courriel, une très bonne solution GRATUITE est MailHog :\n</code></pre>","children":[],"payload":{"lines":"1215,1218"}}],"payload":{"lines":"1213,1214","fold":1}},{"content":"<a href=\"https://github.com/mailhog/MailHog\">Installer MailHog</a>","children":[{"content":"<pre data-lines=\"1221,1222\"><code>- Dans .env :\n</code></pre>","children":[],"payload":{"lines":"1221,1222"}},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-comment\"># Start MailHog</span>\n  <span class=\"hljs-comment\"># Go to: http://localhost:8025</span>\n  MAIL_MAILER=smtp\n  MAIL_HOST=localhost\n  MAIL_PORT=<span class=\"hljs-number\">1025</span>\n  MAIL_USERNAME=Admin\n  MAIL_PASSWORD=<span class=\"hljs-literal\">null</span>\n  MAIL_ENCRYPTION=<span class=\"hljs-literal\">null</span>\n  MAIL_FROM_ADDRESS=<span class=\"hljs-string\">\"admin@example.com\"</span>\n  MAIL_FROM_NAME=<span class=\"hljs-string\">\"${APP_NAME}\"</span>\n</code></pre>","children":[]},{"content":"<pre data-lines=\"1236,1238\"><code>- Lancer le serveur MailHog :\n  → Exécuter le fichier éxécutable récupéré\n</code></pre>","children":[],"payload":{"lines":"1236,1238"}}],"payload":{"lines":"1219,1220","fold":1}},{"content":"<strong><a href=\"http://127.0.0.1:8025\">URL du rendu des courriels avec MailHog</a></strong>","children":[],"payload":{"lines":"1239,1240"}}],"payload":{"lines":"1124,1125","fold":1}}],"payload":{"lines":"1031,1032"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-lauthentification\">https://laravel.sillo.org/posts/mon-cms-lauthentification</a></strong></em>","children":[],"payload":{"lines":"1241,1242"}}],"payload":{"lines":"809,810","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-lauthentification\">https://laravel.sillo.org/posts/mon-cms-lauthentification</a></strong></em>","children":[],"payload":{"lines":"1243,1244"}}],"payload":{"lines":"758,759","fold":1}},{"content":"- La page d'accueil (HomePage)","children":[{"content":"Route index","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/'</span>, <span class=\"hljs-string\">'index'</span>);\n<span class=\"hljs-comment\">// Supprimer : Volt::route('/', 'users.index');</span>\n  <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/category/{slug}'</span>, <span class=\"hljs-string\">'index'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"1247,1248","fold":1}},{"content":"Création composant index","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> \n</span></code></pre>","children":[]}],"payload":{"lines":"1255,1256","fold":1}},{"content":"Les images","children":[{"content":"<strong>php artisan storage:link</strong><br>\n<em>(Crée un lien symbolique de public/storage vers storage/app/public)</em>","children":[],"payload":{"lines":"1263,1265"}},{"content":"<a href=\"https://laravel.sillo.org/tuto/moncms3.zip\">Télécharger le projet et copier storage/app/public/**/*.*</a>","children":[],"payload":{"lines":"1265,1266"}},{"content":"Pour avoir vos images dans votre dépôt git, vu que publiques, supprimer :<br>\n- storage/app/.gitignore<br>\n- storage/app/public/.gitignore","children":[],"payload":{"lines":"1266,1270"}}],"payload":{"lines":"1261,1262","fold":1}},{"content":"Layout app","children":[{"content":"<pre><code class=\"language-php\">  &lt;!DOCTYPE html&gt;\n  &lt;html lang=\"{{ str_replace('_', '-', app()-&gt;getLocale()) }}\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover\"&gt;\n    &lt;meta name=\"csrf-token\" content=\"{{ csrf_token() }}\"&gt;\n    &lt;title&gt;\n      {{ (isset($title) ? $title . ' | ' : (View::hasSection('title') ? View::getSection('title') . ' | ' : '')) . config('app.name') }}\n    &lt;/title&gt;\n    &lt;meta name=\"description\" content=\"@yield('description')\"&gt;\n    &lt;meta name=\"keywords\" content=\"@yield('keywords')\"&gt;\n    @vite(['resources/css/app.css', 'resources/js/app.js'])\n  &lt;/head&gt;\n  \n  &lt;body class=\"min-h-screen font-sans antialiased bg-base-200/50 dark:bg-base-200\"&gt;\n  \n    {{-- HERO --}}\n\n    &lt;div class=\"min-h-[10vw] hero\" style=\"background-image: url({{ asset('storage/hero.jpg') }});\"&gt;\n      &lt;div class=\"bg-opacity-60 hero-overlay\"&gt;\n      &lt;/div&gt;\n      &lt;a href=\"{{ '/' }}\"&gt;\n      &lt;div class=\"text-center hero-content text-neutral-content\"&gt;\n        &lt;div&gt;\n          &lt;h1 class=\"mb-5 text-4xl font-bold sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl\"&gt;\n              Mon Titre\n          &lt;/h1&gt;\n          &lt;p class=\"mb-1 text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl\"&gt;\n              Mon sous-titre\n          &lt;/p&gt;\n        &lt;/div&gt;              \n      &lt;/div&gt;\n    &lt;/a&gt;\n    &lt;/div&gt;\n  \n  &lt;/body&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1270,1271","fold":1}},{"content":"La barre de navigation","children":[{"content":"La Navbar (Grand écran ou bouton burger)","children":[{"content":"Création composant navbar","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt navigation/navbar --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1315,1316","fold":1}},{"content":"Code composant navbar","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n  use Illuminate\\Support\\Facades\\{Auth, Session};\n  use Livewire\\Volt\\Component;\n  \n  new class extends Component {\n  \n    public function logout(): void {\n      Auth::guard('web')-&gt;logout();\n      Session::invalidate();\n      Session::regenerateToken();\n      $this-&gt;redirect('/');\n    }\n  }; ?&gt;\n  \n  &lt;x-nav sticky full-width &gt;\n    &lt;x-slot:brand&gt;\n      &lt;label for=\"main-drawer\" class=\"mr-3 sm:hidden\"&gt;\n        &lt;x-icon name=\"o-bars-3\" class=\"cursor-pointer\" /&gt;\n      &lt;/label&gt;\n    &lt;/x-slot:brand&gt;\n    \n    &lt;x-slot:actions&gt;\n      &lt;span class=\"hidden sm:block\"&gt;\n        @if ($user = auth()-&gt;user())\n          &lt;x-dropdown&gt;\n            &lt;x-slot:trigger&gt;\n              &lt;x-button label=\"{{ $user-&gt;name }}\" class=\"btn-ghost\" /&gt;\n            &lt;/x-slot:trigger&gt;\n          &lt;x-menu-item title=\"{{ __('Logout') }}\" wire:click=\"logout\" /&gt;\n          &lt;/x-dropdown&gt;\n          @else\n            &lt;x-button label=\"{{ __('Login') }}\" link=\"/login\" class=\"btn-ghost\" /&gt;\n        @endif\n      &lt;/span&gt;\n    &lt;/x-slot:actions&gt;\n  &lt;/x-nav&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1321,1322","fold":1}},{"content":"Layout pour le composant navbar","children":[{"content":"<pre data-lines=\"1364,1370\"><code>Attention: À ce stade, se connecter fait apparaître une erreur...\n(Juste rafraîchir, et tester responsivité - Réduire taille de l'écran...)\n\nDans components/layouts/app.blade.php :\n\nRemplacer le bloc :\n</code></pre>","children":[],"payload":{"lines":"1364,1370"}},{"content":"<pre><code class=\"language-php\">  {{-- NAVBAR mobile only --}}\n  &lt;x-nav&gt;\n    ...\n  &lt;x-nav&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"1378,1379\"><code>Par :\n</code></pre>","children":[],"payload":{"lines":"1378,1379"}},{"content":"<pre><code class=\"language-php\">  ...\n  {{-- NAVBAR --}}\n  &lt;livewire:navigation.navbar/&gt;\n&lt;/body&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1362,1363","fold":1}}],"payload":{"lines":"1313,1314","fold":1}},{"content":"La Sidebar (Petit écran)","children":[{"content":"Création composant sidebar","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt navigation/sidebar --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1389,1390","fold":1}},{"content":"Code composant sidebar","children":[{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use Illuminate\\Support\\Facades\\{Auth, Session};\n  use Livewire\\Volt\\Component;\n  \n  new class() extends Component {\n  \n    public function logout(): void {\n      Auth::guard('web')-&gt;logout();\n      Session::invalidate();\n      Session::regenerateToken();\n      $this-&gt;redirect('/');\n    }\n  };\n  ?&gt;\n  \n  &lt;div&gt;\n    &lt;x-menu activate-by-route&gt;\n      @if($user = auth()-&gt;user())\n        &lt;x-menu-separator /&gt;\n        &lt;x-list-item :item=\"$user\" value=\"name\" sub-value=\"email\" no-separator no-hover class=\"-mx-2 !-my-2 rounded\"&gt;\n          &lt;x-slot:actions&gt;\n            &lt;x-button icon=\"o-power\" wire:click=\"logout\" class=\"btn-circle btn-ghost btn-xs\" tooltip-left=\"{{ __('Logout') }}\" no-wire-navigate /&gt;\n          &lt;/x-slot:actions&gt;\n        &lt;/x-list-item&gt;\n        &lt;x-menu-separator /&gt;\n      @else\n        &lt;x-menu-item title=\"{{ __('Login') }}\" link=\"/login\" /&gt;\n      @endif\n    &lt;/x-menu&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1395,1396","fold":1}},{"content":"Layout pour le composant sidebar","children":[{"content":"<pre><code class=\"language-php\">  ...\n  {{-- MAIN --}}\n  &lt;x-main full-width&gt;\n  \n    {{-- SIDEBAR --}}\n    &lt;x-slot:sidebar drawer=\"main-drawer\" collapsible class=\"bg-base-100 lg:bg-inherit lg:hidden\"&gt;\n      &lt;livewire:navigation.sidebar /&gt;\n    &lt;/x-slot:sidebar&gt;\n\n    {{-- SLOT --}}\n    &lt;x-slot:content&gt;\n      {{ $slot }}\n    &lt;/x-slot:content&gt;\n  \n  &lt;/x-main&gt;\n\n&lt;/body&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1430,1431","fold":1}}],"payload":{"lines":"1387,1388","fold":1}}],"payload":{"lines":"1311,1312","fold":1}},{"content":"Bloc des articles","children":[{"content":"Création app/Repositories/PostRepository.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">App</span>\\<span class=\"hljs-title class_\">Repositories</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\{<span class=\"hljs-title\">Category</span>, <span class=\"hljs-title\">Post</span>};\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Builder</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Pagination</span>\\<span class=\"hljs-title\">LengthAwarePaginator</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">PostRepository</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPostsPaginate</span>(<span class=\"hljs-params\">?Category <span class=\"hljs-variable\">$category</span></span>): <span class=\"hljs-title\">LengthAwarePaginator</span> </span>{\n      <span class=\"hljs-variable\">$query</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">getBaseQuery</span>()-&gt;<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'pinned'</span>, <span class=\"hljs-string\">'desc'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">latest</span>();\n      \n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$category</span>) {\n        <span class=\"hljs-variable\">$query</span>-&gt;<span class=\"hljs-title function_ invoke__\">whereBelongsTo</span>(<span class=\"hljs-variable\">$category</span>);\n      }\n      \n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$query</span>-&gt;<span class=\"hljs-title function_ invoke__\">paginate</span>(<span class=\"hljs-title function_ invoke__\">config</span>(<span class=\"hljs-string\">'app.pagination'</span>));\n    }\n  \n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getBaseQuery</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">Builder</span> </span>{\n      <span class=\"hljs-variable\">$specificReqs</span> = [\n      <span class=\"hljs-string\">'mysql'</span>  =&gt; <span class=\"hljs-string\">\"LEFT(body, LOCATE(' ', body, 700))\"</span>,\n      <span class=\"hljs-string\">'sqlite'</span> =&gt; <span class=\"hljs-string\">'substr(body, 1, 700)'</span>,\n      <span class=\"hljs-string\">'pgsql'</span>  =&gt; <span class=\"hljs-string\">'substring(body from 1 for 700)'</span>,\n      ];\n      \n      <span class=\"hljs-variable\">$usedDbSystem</span> = <span class=\"hljs-title function_ invoke__\">env</span>(<span class=\"hljs-string\">'DB_CONNECTION'</span>, <span class=\"hljs-string\">'mysql'</span>);\n      \n      <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$specificReqs</span>[<span class=\"hljs-variable\">$usedDbSystem</span>])) {\n        <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">\\Exception</span>(<span class=\"hljs-string\">\"Base de données non supportée: <span class=\"hljs-subst\">{$usedDbSystem}</span>\"</span>);\n      }\n  \n    <span class=\"hljs-variable\">$adaptedReq</span> = <span class=\"hljs-variable\">$specificReqs</span>[<span class=\"hljs-variable\">$usedDbSystem</span>];\n    \n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">select</span>(<span class=\"hljs-string\">'id'</span>, <span class=\"hljs-string\">'slug'</span>, <span class=\"hljs-string\">'image'</span>, <span class=\"hljs-string\">'title'</span>, <span class=\"hljs-string\">'user_id'</span>, <span class=\"hljs-string\">'category_id'</span>, <span class=\"hljs-string\">'created_at'</span>, <span class=\"hljs-string\">'pinned'</span>)\n      -&gt;<span class=\"hljs-title function_ invoke__\">selectRaw</span>(<span class=\"hljs-string\">\"\n        CASE\n          WHEN LENGTH(body) &lt;= 300 THEN body\n          ELSE <span class=\"hljs-subst\">{$adaptedReq}</span>\n        END AS excerpt\n      \"</span>,)\n    -&gt;<span class=\"hljs-title function_ invoke__\">with</span>(<span class=\"hljs-string\">'user:id,name'</span>, <span class=\"hljs-string\">'category'</span>)\n    -&gt;<span class=\"hljs-title function_ invoke__\">whereActive</span>(<span class=\"hljs-literal\">true</span>);\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"1454,1455","fold":1}},{"content":"config/app.php","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">return</span> [\n  ...\n  <span class=\"hljs-string\">'pagination'</span>  =&gt;  <span class=\"hljs-number\">6</span>,\n  <span class=\"hljs-string\">'excerptSize'</span> =&gt; <span class=\"hljs-number\">30</span>,\n]\n</code></pre>","children":[]}],"payload":{"lines":"1504,1505","fold":1}},{"content":"Code composant index","children":[{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use App\\Models\\Category;\n  use Livewire\\Volt\\Component;\n  use Livewire\\WithPagination;\n  use App\\Repositories\\PostRepository;\n  use Illuminate\\Pagination\\LengthAwarePaginator;\n  \n  new class extends Component {\n    use WithPagination;\n  \n    public ?Category $category = null;\n  \n    public function mount(string $slug = ''): void {\n      if (request()-&gt;is('category/*')) {\n        $this-&gt;category = $this-&gt;getCategoryBySlug($slug);\n      } \n    }\n  \n    public function getPosts(): LengthAwarePaginator {\n      $postRepository = new PostRepository();\n\n      return $postRepository-&gt;getPostsPaginate($this-&gt;category);\n    }\n  \n    protected function getCategoryBySlug(string $slug): ?Category {\n\n      return 'category' === request()-&gt;segment(1) ? Category::whereSlug($slug)-&gt;firstOrFail() : null;\n    }\n  \n    public function with(): array {\n\n      return ['posts' =&gt; $this-&gt;getPosts()];\n    }\n  }; ?&gt;\n    \n  @section('title')\n    {{ __('Home') }}\n  @endsection\n  \n  &lt;div class=\"relative grid items-center w-full py-5 mx-auto md:px-6 max-w-12xl\"&gt;\n  \n    @if ($category)\n      &lt;x-header title=\"{{ __('Posts for category ') }} {{ $category-&gt;title }}\" size=\"text-2xl sm:text-3xl   md:text-4xl\" /&gt;\n    @endif\n  \n    &lt;div class=\"mb-5 mary-table-pagination\"&gt;\n      {{ $posts-&gt;links() }}\n    &lt;/div&gt;\n  \n    &lt;div class=\"container mx-auto\"&gt;\n      &lt;div class=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3\"&gt;\n        @forelse($posts as $post)\n          &lt;x-card class=\"w-full transition duration-500 ease-in-out shadow-md shadow-gray-500 hover:shadow-xl hover:shadow-gray-400\" title=\"{!! $post-&gt;title !!}\"&gt;\n    \n            &lt;div class=\"text-justify\"&gt;\n              {!! str(strip_tags($post-&gt;excerpt))-&gt;words(config('app.excerptSize')) !!}\n            &lt;/div&gt;\n            &lt;br&gt;\n            &lt;hr&gt;\n            &lt;div class=\"flex justify-between\"&gt;\n              &lt;p wire:click=\"\" class=\"text-left cursor-pointer\"&gt;{{ $post-&gt;user-&gt;name }}&lt;/p&gt;\n              &lt;p class=\"text-right\"&gt;&lt;em&gt;{{ $post-&gt;created_at-&gt;isoFormat('LL') }}&lt;/em&gt;&lt;/p&gt;\n            &lt;/div&gt;\n            @if($post-&gt;image)\n              &lt;x-slot:figure&gt;\n                &lt;a href=\"{{ url('/posts/' . $post-&gt;slug) }}\"&gt;\n                  &lt;img src=\"{{ asset('storage/photos/' . $post-&gt;image) }}\" alt=\"{{ $post-&gt;title }}\" /&gt;\n                &lt;/a&gt;\n              &lt;/x-slot:figure&gt;\n            @endif\n\n            &lt;x-slot:menu&gt;\n              @if ($post-&gt;pinned)\n                &lt;x-badge value=\"{{ __('Pinned') }}\" class=\"p-3 badge-warning\" /&gt;\n              @endif\n            &lt;/x-slot:menu&gt;\n\n            &lt;x-slot:actions&gt;\n              &lt;div class=\"flex flex-col items-end space-y-2 sm:items-start sm:flex-row sm:space-y-0 sm:space-x-2\"&gt;\n                &lt;x-popover&gt;\n                  &lt;x-slot:trigger&gt;\n                    &lt;x-button label=\"{{ $post-&gt;category-&gt;title }}\" link=\"{{ url('/category/' . $post-&gt;category-&gt;slug) }}\" class=\"mt-1 btn-outline btn-sm\" /&gt;\n                  &lt;/x-slot:trigger&gt;\n                  &lt;x-slot:content class=\"pop-small\"&gt;\n                      @lang('Show this category')\n                  &lt;/x-slot:content&gt;\n                &lt;/x-popover&gt;\n\n                &lt;x-popover&gt;\n                  &lt;x-slot:trigger&gt;\n                    &lt;x-button label=\"{{ __('Read') }}\" link=\"{{ url('/posts/' . $post-&gt;slug) }}\" class=\"mt-1 btn-outline btn-sm\" /&gt;\n                  &lt;/x-slot:trigger&gt;\n                  &lt;x-slot:content class=\"pop-small\"&gt;\n                    @lang('Read this post')\n                  &lt;/x-slot:content&gt;\n                &lt;/x-popover&gt;\n              &lt;/div&gt;\n            &lt;/x-slot:actions&gt;\n          &lt;/x-card&gt;\n            @empty\n              &lt;div class=\"col-span-3\"&gt;\n                &lt;x-card title=\"{{ __('Nothing to show !') }}\"&gt;\n                  {{ __('No Post found with these criteria') }}\n                &lt;/x-card&gt;\n              &lt;/div&gt;\n            @endforelse\n          &lt;/div&gt;\n      &lt;/div&gt;\n  \n    &lt;!-- Pagination inférieure --&gt;\n    &lt;div class=\"mt-5 mary-table-pagination\"&gt;\n      {{ $posts-&gt;links() }}\n    &lt;/div&gt;\n  \n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1514,1515","fold":1}},{"content":"Traduction pour les articles","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"Show this category\"</span>: <span class=\"hljs-string\">\"Voir cette catégorie\"</span>,\n  <span class=\"hljs-string\">\"Read this post\"</span>: <span class=\"hljs-string\">\"Lire cet article\"</span>,\n  <span class=\"hljs-string\">\"Posts for category \"</span>: <span class=\"hljs-string\">\"Articles pour la catégorie \"</span>,\n  <span class=\"hljs-string\">\"Read\"</span>: <span class=\"hljs-string\">\"Lire\"</span>,\n  <span class=\"hljs-string\">\"Nothing to show !\"</span>: <span class=\"hljs-string\">\"Rien à montrer !\"</span>,\n  <span class=\"hljs-string\">\"No Post found with these criteria\"</span>: <span class=\"hljs-string\">\"Aucun article trouvé avec ces critères\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1634,1635","fold":1}}],"payload":{"lines":"1452,1453","fold":1}},{"content":"Styles pagination &amp; popups","children":[{"content":"<pre data-lines=\"1647,1648\"><code>- Pour le menu pagination : ./tailwind.config.js\n</code></pre>","children":[],"payload":{"lines":"1647,1648"}},{"content":"<pre><code class=\"language-php\">  export <span class=\"hljs-keyword\">default</span> {\n    content: [\n      ...\n      <span class=\"hljs-string\">\"./vendor/laravel/framework/src/Illuminate/Pagination/resources/views/*.blade.php\"</span>,\n    ],\n    ...\n  }\n</code></pre>","children":[]},{"content":"<pre data-lines=\"1659,1660\"><code>- Pour les Popups : ./resources/css/app.css :\n</code></pre>","children":[],"payload":{"lines":"1659,1660"}},{"content":"<pre><code class=\"language-php\">  .pop-small {\n    @apply !p-1 !px-2 text-sm border-info text-center\n}\n</code></pre>","children":[]}],"payload":{"lines":"1645,1646","fold":1}},{"content":"Référence: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-la-page-daccueil\">https://laravel.sillo.org/posts/mon-cms-la-page-daccueil</a></strong></em>","children":[],"payload":{"lines":"1667,1668"}}],"payload":{"lines":"1245,1246","fold":1}},{"content":"- Les articles &amp; les pages","children":[{"content":"Composant posts.show","children":[{"content":"Route posts.show","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/posts/{slug}'</span>, <span class=\"hljs-string\">'posts.show'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.show'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"1673,1674","fold":1}},{"content":"PostRepository","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPostBySlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span></span>): <span class=\"hljs-title\">Post</span> </span>{\n      \n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">with</span>(<span class=\"hljs-string\">'user:id,name'</span>, <span class=\"hljs-string\">'category'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">whereSlug</span>(<span class=\"hljs-variable\">$slug</span>)-&gt;<span class=\"hljs-title function_ invoke__\">firstOrFail</span>();\n  }\n</code></pre>","children":[]}],"payload":{"lines":"1679,1680","fold":1}},{"content":"Création composant posts.show","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt posts/show --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1688,1689","fold":1}},{"content":"Code composant posts.show","children":[{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use App\\Models\\Post;\n  use App\\Repositories\\PostRepository;\n  use Livewire\\Volt\\Component;\n  \n  new class extends Component {\n    public Post $post;\n    public function mount($slug): void {\n      $postRepository = new PostRepository();\n      $this-&gt;post     = $postRepository-&gt;getPostBySlug($slug);\n    }\n  }; ?&gt;\n  &lt;div&gt;\n    @section('title', $post-&gt;seo_title ?? $post-&gt;title)\n    @section('description', $post-&gt;meta_description)\n    @section('keywords', $post-&gt;meta_keywords)\n    &lt;div id=\"top\" class=\"flex justify-end gap-4\"&gt;\n      &lt;x-popover&gt;\n        &lt;x-slot:trigger&gt;\n          &lt;x-button class=\"btn-sm\"&gt;&lt;a href=\"{{ url('/category/' . $post-&gt;category-&gt;slug) }}\"&gt;{{ $post-&gt;category-&gt;title }}&lt;/a&gt;&lt;/x-button&gt;\n        &lt;/x-slot:trigger&gt;\n        &lt;x-slot:content class=\"pop-small\"&gt;\n          @lang('Show this category')\n        &lt;/x-slot:content&gt;\n      &lt;/x-popover&gt;\n    &lt;/div&gt;\n    &lt;x-header title=\"{!! $post-&gt;title !!}\" subtitle=\"{{ ucfirst($post-&gt;created_at-&gt;isoFormat('LLLL')) }} \" size=\"text-2xl sm:text-3xl md:text-4xl\" /&gt;\n    &lt;div class=\"relative items-center w-full py-5 mx-auto prose md:px-12 max-w-7xl\"&gt;\n      @if ($post-&gt;image)\n        &lt;div class=\"flex flex-col items-center mb-4\"&gt;\n          &lt;img src=\"{{ asset('storage/photos/' . $post-&gt;image) }}\" /&gt;\n        &lt;/div&gt;\n        &lt;br&gt;\n      @endif\n      &lt;div class=\"text-justify\"&gt;\n        {!! $post-&gt;body !!}\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;br&gt;\n    &lt;hr&gt;\n    &lt;p&gt;@lang('By ') {{ $post-&gt;user-&gt;name }}&lt;/p&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1694,1695","fold":1}},{"content":"Traduction posts.show","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"By \"</span>: <span class=\"hljs-string\">\"Par \"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1741,1742","fold":1}}],"payload":{"lines":"1671,1672","fold":1}},{"content":"Dynamic Title/Description/Keywords (S.E.O.)","children":[{"content":"Dans le <strong>Layout</strong>","children":[{"content":"<pre data-lines=\"1751,1752\"><code>Rappel extrait title &amp; meta:\n</code></pre>","children":[],"payload":{"lines":"1751,1752"}},{"content":"<pre><code class=\"language-php\">  &lt;title&gt;{{ (<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$title</span>) ? <span class=\"hljs-variable\">$title</span> . <span class=\"hljs-string\">' | '</span> :\n  (<span class=\"hljs-title class_\">View</span>::<span class=\"hljs-title function_ invoke__\">hasSection</span>(<span class=\"hljs-string\">'title'</span>) ? <span class=\"hljs-title class_\">View</span>::<span class=\"hljs-title function_ invoke__\">getSection</span>(<span class=\"hljs-string\">'title'</span>) . <span class=\"hljs-string\">' | '</span> :\n   <span class=\"hljs-string\">''</span>)) . <span class=\"hljs-title function_ invoke__\">config</span>(<span class=\"hljs-string\">'app.name'</span>) }}&lt;/title&gt;\n  &lt;meta name=<span class=\"hljs-string\">\"description\"</span> content=<span class=\"hljs-string\">\"@yield('description')\"</span>&gt;\n  &lt;meta name=<span class=\"hljs-string\">\"keywords\"</span> content=<span class=\"hljs-string\">\"@yield('keywords')\"</span>&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1749,1750"}},{"content":"Dans la Vue","children":[{"content":"Bloc PHP","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Attributes</span>\\<span class=\"hljs-title\">Title</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Repositories</span>\\<span class=\"hljs-title\">PostRepository</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Pagination</span>\\<span class=\"hljs-title\">LengthAwarePaginator</span>;\n  \n  <span class=\"hljs-keyword\">new</span> \n  <span class=\"hljs-meta\">#[Title</span>(__(<span class=\"hljs-string\">'Contact'</span>)<span class=\"hljs-meta\">]</span>\n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  ...\n  }\n</code></pre>","children":[]}],"payload":{"lines":"1763,1764"}},{"content":"OU","children":[],"payload":{"lines":"1777,1778"}},{"content":"Bloc Blade","children":[{"content":"<pre><code class=\"language-php\">  @php\n    <span class=\"hljs-variable\">$title</span>=<span class=\"hljs-string\">'TitrePage'</span>\n  @endphp\n</code></pre>","children":[]},{"content":"<pre data-lines=\"1786,1787\"><code>OU :\n</code></pre>","children":[],"payload":{"lines":"1786,1787"}},{"content":"<pre><code class=\"language-php\">  @<span class=\"hljs-title function_ invoke__\">section</span>(<span class=\"hljs-string\">'title'</span>, <span class=\"hljs-variable\">$post</span>-&gt;seo_title ?? <span class=\"hljs-variable\">$post</span>-&gt;title)\n  @<span class=\"hljs-title function_ invoke__\">section</span>(<span class=\"hljs-string\">'description'</span>, <span class=\"hljs-variable\">$post</span>-&gt;meta_description)\n  @<span class=\"hljs-title function_ invoke__\">section</span>(<span class=\"hljs-string\">'keywords'</span>, <span class=\"hljs-variable\">$post</span>-&gt;meta_keywords\n</code></pre>","children":[]}],"payload":{"lines":"1779,1780"}}],"payload":{"lines":"1761,1762"}}],"payload":{"lines":"1747,1748","fold":1}},{"content":"Typographie: Plugin <strong>prose</strong> de Tailwind","children":[{"content":"<strong>npm install -D @tailwindcss/typography</strong>","children":[],"payload":{"lines":"1796,1797"}},{"content":"./tailwind.config.js :","children":[],"payload":{"lines":"1797,1798"}},{"content":"exports default {<br>\n&nbsp;&nbsp;...<br>\n&nbsp;&nbsp;plugins: [<br>\n&nbsp;&nbsp;&nbsp;&nbsp;plugins: [require(\"@tailwindcss/typography\"), require(\"daisyui\")],<br>\n&nbsp;&nbsp;],<br>\n}","children":[],"payload":{"lines":"1798,1804"}},{"content":"<em>Utilisation : &lt;div class=\"relative items-center w-full py-5 mx-auto <strong>prose</strong> md:px-12 max-w-7xl\"&gt;</em>","children":[],"payload":{"lines":"1804,1806"}}],"payload":{"lines":"1794,1795","fold":1}},{"content":"Style avec Librairie <strong>prismjs</strong>","children":[{"content":"Configurer <strong>prism.css</strong> et <strong>prism.js</strong> : <a href=\"https://prismjs.com/download.html\">https://prismjs.com/download.html</a><br>\nOU<br>\nRécupérer ceux du site Sillo: <a href=\"https://laravel.sillo.org/storage/css/prism.css\">CSS</a> et <a href=\"https://laravel.sillo.org/storage/scripts/prism.js\">JS</a>","children":[],"payload":{"lines":"1808,1811"}},{"content":"Poser dans le layout:<br>\n...<br>\n&lt;head&gt;<br>\n...<br>\n&nbsp;&nbsp;<strong>&lt;link rel=\"stylesheet\" href=\"{{ asset('storage/css/prism.css') }}\"&gt;</strong><br>\n&lt;/head&gt;<br>\n&lt;body class=\"min-h-screen font-sans antialiased bg-base-200/50 dark:bg-base-200\"&gt;<br>\n...<br>\n&nbsp;&nbsp;<strong>&lt;script src=\"{{ asset('storage/scripts/prism.js') }}\"&gt;&lt;/script&gt;</strong><br>\n&lt;/body&gt;","children":[],"payload":{"lines":"1811,1822"}}],"payload":{"lines":"1806,1807","fold":1}},{"content":"Mode clair/sombre (MaryIU)","children":[{"content":"./tailwind.config.js :<br>\n<strong>export default {<br>\n...<br>\n&nbsp;&nbsp;theme: {<br>\n&nbsp;&nbsp;&nbsp;&nbsp;extend: {},<br>\n&nbsp;&nbsp;},<br>\n&nbsp;&nbsp;darkMode: 'class',<br>\n}</strong>","children":[],"payload":{"lines":"1824,1832"}},{"content":"navigation/navbar.blade.php :<br>\n<strong>&nbsp;&nbsp;&nbsp;&nbsp;&lt;x-theme-toggle title=\"{{ __('Toggle theme') }}\" class=\"w-4 h-8\" /&gt;<br>\n&nbsp;&nbsp;<a href=\"/x-slot:actions\">/x-slot:actions</a><br>\n&lt;/x-nav&gt;</strong>","children":[],"payload":{"lines":"1832,1836"}},{"content":"Doc MaryUI <em><strong><a href=\"https://mary-ui.com/docs/components/theme-toggle\">https://mary-ui.com/docs/components/theme-toggle</a></strong></em>","children":[],"payload":{"lines":"1836,1838"}}],"payload":{"lines":"1822,1823","fold":1}},{"content":"Search bar","children":[{"content":"La route (routes/web.php)","children":[{"content":"<pre><code class=\"language-bash\">  Volt::route(<span class=\"hljs-string\">'/search/{param}'</span>, <span class=\"hljs-string\">'index'</span>)-&gt;name(<span class=\"hljs-string\">'posts.search'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"1840,1841","fold":1}},{"content":"Composant search","children":[{"content":"<pre data-lines=\"1850,1851\"><code>Création composant Search :\n</code></pre>","children":[],"payload":{"lines":"1850,1851"}},{"content":"<pre><code class=\"language-php\">  php artisan make:volt search --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre data-lines=\"1856,1857\"><code>PHP (La logique) :\n</code></pre>","children":[],"payload":{"lines":"1856,1857"}},{"content":"<pre><code class=\"language-bash\">  &lt;?php\n  use Livewire\\Attributes\\Validate;\n  use Livewire\\Volt\\Component;\n  \n  new class extends Component {\n  \n    <span class=\"hljs-comment\">#[Validate('required|string|max:100')]</span>\n    public string <span class=\"hljs-variable\">$search</span> = <span class=\"hljs-string\">''</span>;\n\n    public <span class=\"hljs-keyword\">function</span> <span class=\"hljs-function\"><span class=\"hljs-title\">save</span></span>() {\n      <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable\">$this</span>-&gt;validate();\n\n      <span class=\"hljs-built_in\">return</span> redirect(<span class=\"hljs-string\">'/search/'</span> . <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'search'</span>]);\n    }\n  }; ?&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"1876,1877\"><code>HTML (Blade - La Vue) :\n</code></pre>","children":[],"payload":{"lines":"1876,1877"}},{"content":"<pre><code class=\"language-bash\">  &lt;div&gt;\n    &lt;form wire:submit.prevent=<span class=\"hljs-string\">\"save\"</span>&gt;\n    &lt;x-input placeholder=<span class=\"hljs-string\">\"{{ __('Search') }}...\"</span> wire:model=<span class=\"hljs-string\">\"search\"</span> clearable icon=<span class=\"hljs-string\">\"o-magnifying-glass\"</span> /&gt;\n    &lt;/form&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1848,1849","fold":1}},{"content":"Vue HTML - navigation/navbar.php","children":[{"content":"<pre><code class=\"language-php\">    ...\n    &lt;livewire:search /&gt;\n  &lt;/x-slot:actions&gt;\n&lt;/x-nav&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1886,1887","fold":1}},{"content":"Ajouter search() dans app/Repositories/PostRepository.php","children":[{"content":"<pre data-lines=\"1897,1898\"><code>La fonction qui inclue la chaîne du formulaire pour gérer la recherche :\n</code></pre>","children":[],"payload":{"lines":"1897,1898"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">search</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$search</span></span>): <span class=\"hljs-title\">LengthAwarePaginator</span> </span>{\n  \n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">getBaseQuery</span>()\n    -&gt;<span class=\"hljs-title function_ invoke__\">latest</span>()\n    -&gt;<span class=\"hljs-title function_ invoke__\">where</span>(function (<span class=\"hljs-variable\">$query</span>) <span class=\"hljs-keyword\">use</span> ($<span class=\"hljs-title\">search</span>) {\n    $<span class=\"hljs-title\">query</span>-&gt;<span class=\"hljs-title\">where</span>('<span class=\"hljs-title\">title</span>', '<span class=\"hljs-title\">like</span>', \"%{$<span class=\"hljs-title\">search</span>}%\")\n    -&gt;<span class=\"hljs-title\">orWhere</span>('<span class=\"hljs-title\">body</span>', '<span class=\"hljs-title\">like</span>', \"%{$<span class=\"hljs-title\">search</span>}%\");\n    })\n    -&gt;<span class=\"hljs-title function_ invoke__\">paginate</span>(<span class=\"hljs-title function_ invoke__\">config</span>(<span class=\"hljs-string\">'app.pagination'</span>));\n  }\n</code></pre>","children":[]}],"payload":{"lines":"1895,1896","fold":1}},{"content":"Composant index (Homepage (Page d'accueil))","children":[{"content":"<strong>Bloc PHP</strong> : Quand on récupère les posts..","children":[{"content":"<pre data-lines=\"1916,1918\"><code>...On déclenche le composant search\nsi l'URI comporte un paramètre (function getPosts()) :\n</code></pre>","children":[],"payload":{"lines":"1916,1918"}},{"content":"<pre><code class=\"language-php\">  ...\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$param</span> = <span class=\"hljs-string\">''</span>;\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span> = <span class=\"hljs-string\">''</span>, <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$param</span> = <span class=\"hljs-string\">''</span></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;param = <span class=\"hljs-variable\">$param</span>;\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">request</span>()-&gt;<span class=\"hljs-title function_ invoke__\">is</span>(<span class=\"hljs-string\">'category/*'</span>)) {\n      <span class=\"hljs-variable language_\">$this</span>-&gt;category = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">getCategoryBySlug</span>(<span class=\"hljs-variable\">$slug</span>);\n    }\n  }\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPosts</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">LengthAwarePaginator</span> </span>{\n    <span class=\"hljs-variable\">$postRepository</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">PostRepository</span>();\n\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">empty</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;param)) {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$postRepository</span>-&gt;<span class=\"hljs-title function_ invoke__\">search</span>(<span class=\"hljs-variable\">$this</span>-&gt;param);\n    }\n\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$postRepository</span>-&gt;<span class=\"hljs-title function_ invoke__\">getPostsPaginate</span>(<span class=\"hljs-variable\">$this</span>-&gt;category);\n  }\n</code></pre>","children":[]}],"payload":{"lines":"1914,1915","fold":1}},{"content":"<strong>Bloc Vue Blade</strong> : S'il y a une recherche...","children":[{"content":"<pre data-lines=\"1943,1944\"><code>...Alors, on affiche le titre de la page adapté :\n</code></pre>","children":[],"payload":{"lines":"1943,1944"}},{"content":"<pre><code class=\"language-php\">  @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$category</span>)\n    &lt;x-header title=<span class=\"hljs-string\">\"{{ __('Posts for category ') }} {{ <span class=\"hljs-subst\">$category</span>-&gt;title }}\"</span> size=<span class=\"hljs-string\">\"text-2xl sm:text-3xl md:text-4xl\"</span> /&gt;\n  @<span class=\"hljs-keyword\">elseif</span>(<span class=\"hljs-variable\">$param</span> !== <span class=\"hljs-string\">''</span>)\n    &lt;x-header title=<span class=\"hljs-string\">\"{{ __('Posts for search ') }} '{{ <span class=\"hljs-subst\">$param</span> }}'\"</span> size=<span class=\"hljs-string\">\"text-2xl sm:text-3xl md:text-4xl\"</span> /&gt;\n  @<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"1941,1942","fold":1}}],"payload":{"lines":"1912,1913","fold":1}},{"content":"Traductions nécessaires (<strong>lang/fr.json</strong>)","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"Search...\"</span>: <span class=\"hljs-string\">\"Rechercher...\"</span>,\n  <span class=\"hljs-string\">\"Posts for search \"</span>: <span class=\"hljs-string\">\"Articles pour la recherche\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"1953,1954","fold":1}}],"payload":{"lines":"1838,1839","fold":1}},{"content":"Affichage d'une page","children":[{"content":"Route pages.show","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/pages/{page:slug}'</span>, <span class=\"hljs-string\">'pages.show'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'pages.show'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"1962,1963"}},{"content":"Créer composant pages.show","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:volt pages/show --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1968,1969"}},{"content":"Composant pages.show","children":[{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use App\\Models\\Page;\n  use Livewire\\Volt\\Component;\n  \n  new class extends Component {\n  public Page $page;\n  \n  public function mount(Page $page): void {\n    if (!$page-&gt;active) {\n      abort(404);\n    }\n  \n    $this-&gt;page = $page;\n  }\n  }; ?&gt;\n  \n  &lt;div&gt;\n    @section('title', $page-&gt;seo_title ?? $page-&gt;title)\n    @section('description', $page-&gt;meta_description)\n    @section('keywords', $page-&gt;meta_keywords)\n\n    &lt;div class=\"flex justify-end gap-4\"&gt;\n      @auth\n        @if (Auth::user()-&gt;isAdmin())\n          &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n              &lt;x-button icon=\"c-pencil-square\" link=\"#\" spinner class=\"btn-ghost btn-sm\" /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n              @lang('Edit this page')\n            &lt;/x-slot:content&gt;\n          &lt;/x-popover&gt;\n        @endif\n      @endauth\n    &lt;/div&gt;\n\n    &lt;x-header title=\"{!! $page-&gt;title !!}\" /&gt;\n\n    &lt;div class=\"relative items-center w-full px-5 py-5 mx-auto prose md:px-12 max-w-7xl\"&gt;\n      {!! $page-&gt;body !!}\n    &lt;/div&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1974,1975"}},{"content":"Traduction pages.show","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"Edit this page\"</span>: <span class=\"hljs-string\">\"Modifier cette page\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2021,2022"}}],"payload":{"lines":"1960,1961","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-articles\">https://laravel.sillo.org/posts/mon-cms-les-articles</a></strong></em>","children":[],"payload":{"lines":"2027,2028"}}],"payload":{"lines":"1669,1670","fold":1}},{"content":"- Les menus &amp; le footer","children":[{"content":"Les données pour menus et footer","children":[{"content":"Structures","children":[{"content":"Model &amp; migration Menu","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:model Menu --migration\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">App</span>\\<span class=\"hljs-title class_\">Models</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Model</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\<span class=\"hljs-title\">HasMany</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Menu</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$timestamps</span> = <span class=\"hljs-literal\">false</span>;\n    \n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [\n      <span class=\"hljs-string\">'label'</span>,\n      <span class=\"hljs-string\">'link'</span>,\n      <span class=\"hljs-string\">'order'</span>,\n    ];\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">submenus</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">HasMany</span> </span>{\n      \n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">hasMany</span>(<span class=\"hljs-title class_\">Submenu</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n  }\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'menus'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'label'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'link'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">nullable</span>();\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">integer</span>(<span class=\"hljs-string\">'order'</span>);\n    });\n  }\n</code></pre>","children":[]}],"payload":{"lines":"2035,2036","fold":1}},{"content":"Model &amp; migration Submenu","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:model Submenu --migration\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Submenu</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$timestamps</span> = <span class=\"hljs-literal\">false</span>;\n    \n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [\n      <span class=\"hljs-string\">'label'</span>,\n      <span class=\"hljs-string\">'link'</span>,\n      <span class=\"hljs-string\">'order'</span>,\n    ];\n  }\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'submenus'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'label'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">integer</span>(<span class=\"hljs-string\">'order'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'link'</span>)-&gt;<span class=\"hljs-keyword\">default</span>(<span class=\"hljs-string\">'#'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreignId</span>(<span class=\"hljs-string\">'menu_id'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">constrained</span>()-&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>);\n    });\n  }\n</code></pre>","children":[]}],"payload":{"lines":"2076,2077","fold":1}},{"content":"Model &amp; migration Footer","children":[{"content":"<pre><code class=\"language-php\">  php artisan make:model Footer --migration\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Footer</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-variable\">$timestamps</span> = <span class=\"hljs-literal\">false</span>;\n\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [\n      <span class=\"hljs-string\">'label'</span>,\n      <span class=\"hljs-string\">'link'</span>,\n      <span class=\"hljs-string\">'order'</span>,\n    ];\n  }\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'footers'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'label'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">string</span>(<span class=\"hljs-string\">'link'</span>);\n      <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-keyword\">integer</span>(<span class=\"hljs-string\">'order'</span>);\n    });\n  }\n</code></pre>","children":[]}],"payload":{"lines":"2107,2108","fold":1}}],"payload":{"lines":"2033,2034","fold":1}},{"content":"Population (Seeders)","children":[{"content":"Rappel pour créer un seeder","children":[{"content":"<pre data-lines=\"2141,2148\"><code>Exemple avec le seeder des menus :\n\nphp artisan make:seeder MenusSeeder\n\nOU\n\nCréer le fichier dans database/seeders\n</code></pre>","children":[],"payload":{"lines":"2141,2148"}}],"payload":{"lines":"2139,2140","fold":1}},{"content":"MenusSeeder.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">database</span>\\<span class=\"hljs-title class_\">seeders</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Facades</span>\\<span class=\"hljs-title\">DB</span>;\n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">MenusSeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-variable\">$menus</span> = [\n          [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Catégorie 1'</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-literal\">null</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">3</span>],\n          [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Catégorie 2'</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/category/category-2'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">2</span>],\n          [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Catégorie 3'</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/category/category-3'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">1</span>],\n      ];\n  \n      DB::<span class=\"hljs-title function_ invoke__\">table</span>(<span class=\"hljs-string\">'menus'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">insert</span>(<span class=\"hljs-variable\">$menus</span>);\n  \n      <span class=\"hljs-variable\">$submenus</span> = [\n          [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Post 1'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/posts/post-1'</span>, <span class=\"hljs-string\">'menu_id'</span> =&gt; <span class=\"hljs-number\">1</span>],\n          [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Tout'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">3</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/category/category-1'</span>, <span class=\"hljs-string\">'menu_id'</span> =&gt; <span class=\"hljs-number\">1</span>],\n      ];\n  \n      DB::<span class=\"hljs-title function_ invoke__\">table</span>(<span class=\"hljs-string\">'submenus'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">insert</span>(<span class=\"hljs-variable\">$submenus</span>);\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"2149,2150","fold":1}},{"content":"FooterSeeder.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-meta\">&lt;?php</span>\n  <span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">database</span>\\<span class=\"hljs-title class_\">seeders</span>;\n  \n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Facades</span>\\<span class=\"hljs-title\">DB</span>;\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">FooterSeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n  </span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>) </span>{\n      <span class=\"hljs-comment\">// Données des éléments du pied de page</span>\n      <span class=\"hljs-variable\">$footers</span> = [\n        [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Accueil'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/'</span>],\n        [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Terms'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">3</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/pages/terms'</span>],\n        [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Policy'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">4</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/pages/privacy-policy'</span>],\n        [<span class=\"hljs-string\">'label'</span> =&gt; <span class=\"hljs-string\">'Contact'</span>, <span class=\"hljs-string\">'order'</span> =&gt; <span class=\"hljs-number\">5</span>, <span class=\"hljs-string\">'link'</span> =&gt; <span class=\"hljs-string\">'/contact'</span>],\n      ];\n\n      <span class=\"hljs-comment\">// Insérer les données dans la table footers</span>\n      DB::<span class=\"hljs-title function_ invoke__\">table</span>(<span class=\"hljs-string\">'footers'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">insert</span>(<span class=\"hljs-variable\">$footers</span>);\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"2177,2178","fold":1}},{"content":"DatabaseSeeder.php","children":[{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">call</span>([\n      ...\n      <span class=\"hljs-title class_\">MenusSeeder</span>::<span class=\"hljs-variable language_\">class</span>,\n      <span class=\"hljs-title class_\">FooterSeeder</span>::<span class=\"hljs-variable language_\">class</span>, \n    ]);\n  }\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">  php artisan migrate:fresh --seed\n</code></pre>","children":[]}],"payload":{"lines":"2203,2204","fold":1}}],"payload":{"lines":"2137,2138","fold":1}},{"content":"Nouveauté : app/Providers/AppServiceProvider.php","children":[{"content":"<pre data-lines=\"2221,2222\"><code>Parce que les menus et submenus sont appelés systématiquement :\n</code></pre>","children":[],"payload":{"lines":"2221,2222"}},{"content":"<pre><code class=\"language-php\">  ...\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">Menu</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">View</span>\\<span class=\"hljs-title\">View</span>;\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\{<span class=\"hljs-title\">Facades</span>, <span class=\"hljs-title\">ServiceProvider</span>};\n  \n  <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">AppServiceProvider</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">ServiceProvider</span> </span>{\n    ...\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">boot</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n      <span class=\"hljs-title class_\">Facades\\View</span>::<span class=\"hljs-title function_ invoke__\">composer</span>([<span class=\"hljs-string\">'components.layouts.app'</span>], function (View <span class=\"hljs-variable\">$view</span>) {\n        <span class=\"hljs-variable\">$view</span>-&gt;<span class=\"hljs-title function_ invoke__\">with</span>(\n          <span class=\"hljs-string\">'menus'</span>,\n          <span class=\"hljs-title class_\">Menu</span>::<span class=\"hljs-title function_ invoke__\">with</span>([<span class=\"hljs-string\">'submenus'</span> =&gt; function (<span class=\"hljs-variable\">$query</span>) {\n            <span class=\"hljs-variable\">$query</span>-&gt;<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'order'</span>);\n          }])-&gt;<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'order'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">get</span>()\n        );\n      });\n    }\n  }\n</code></pre>","children":[]}],"payload":{"lines":"2219,2220","fold":1}}],"payload":{"lines":"2031,2032","fold":1}},{"content":"Affichages des menus","children":[{"content":"Ajouter <em>:$menus</em> dans layouts/app.blade.php","children":[{"content":"<pre><code class=\"language-php\">  &lt;livewire:navigation.navbar :<span class=\"hljs-variable\">$menus</span> /&gt;\n  ...\n  &lt;livewire:navigation.sidebar :<span class=\"hljs-variable\">$menus</span> /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2246,2247","fold":1}},{"content":"Barre de Navigation","children":[{"content":"navigation/navbar.blade.php","children":[{"content":"<pre data-lines=\"2258,2259\"><code>Bloc PHP :\n</code></pre>","children":[],"payload":{"lines":"2258,2259"}},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Collection</span>;\n  \n  <span class=\"hljs-keyword\">new</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    \n    <span class=\"hljs-keyword\">public</span> Collection <span class=\"hljs-variable\">$menus</span>;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\">Collection <span class=\"hljs-variable\">$menus</span></span>): <span class=\"hljs-title\">void</span> </span>{\n      <span class=\"hljs-variable language_\">$this</span>-&gt;menus = <span class=\"hljs-variable\">$menus</span>;\n    }\n    ...\n  }\n</code></pre>","children":[]},{"content":"<pre data-lines=\"2274,2275\"><code>Bloc Blade :\n</code></pre>","children":[],"payload":{"lines":"2274,2275"}},{"content":"<pre><code class=\"language-php\">  &lt;span class=\"hidden sm:block\"&gt;\n    @foreach ($menus as $menu)\n      @if ($menu-&gt;submenus-&gt;isNotEmpty())\n        &lt;x-dropdown&gt;\n          &lt;x-slot:trigger&gt;\n            &lt;x-button label=\"{{ $menu-&gt;label }}\"  class=\"btn-ghost\" /&gt;\n          &lt;/x-slot:trigger&gt;\n          @foreach ($menu-&gt;submenus as $submenu)\n            &lt;x-menu-item title=\"{{ $submenu-&gt;label }}\" link=\"{{ $submenu-&gt;link }}\" style=\"min-width: max-content;\" /&gt;\n          @endforeach\n        &lt;/x-dropdown&gt;\n      @else\n        &lt;x-button label=\"{{ $menu-&gt;label }}\" link=\"{{ $menu-&gt;link }}\" :external=\"Str::startsWith($menu-&gt;link, 'http')\" class=\"btn-ghost\" /&gt;\n      @endif\n    @endforeach\n    ...\n  &lt;/span&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2256,2257","fold":1}},{"content":"navigation/sidebar.blade.php","children":[{"content":"<pre><code class=\"language-php\">  ...\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Collection</span>;\n  \n  <span class=\"hljs-keyword\">new</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  \n    <span class=\"hljs-keyword\">public</span> Collection <span class=\"hljs-variable\">$menus</span>;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\">Collection <span class=\"hljs-variable\">$menus</span></span>): <span class=\"hljs-title\">void</span> </span>{\n      <span class=\"hljs-variable language_\">$this</span>-&gt;menus = <span class=\"hljs-variable\">$menus</span>;\n    }\n    ...\n  };\n  ...\n  &lt;x-menu activate-by-route&gt;\n    ... <span class=\"hljs-comment\">// Ici suppression du separator reporté ci-dessous</span>\n      &lt;/x-<span class=\"hljs-keyword\">list</span>-item&gt;\n      @<span class=\"hljs-keyword\">else</span>\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Login') }}\"</span> link=<span class=\"hljs-string\">\"/login\"</span> /&gt;\n      @<span class=\"hljs-keyword\">endif</span>\n    &lt;x-menu-separator /&gt;\n    @<span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$menus</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$menu</span>)\n      @<span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$menu</span>-&gt;submenus-&gt;<span class=\"hljs-title function_ invoke__\">isNotEmpty</span>())\n        &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$menu</span>-&gt;label }}\"</span>&gt;\n          @<span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$menu</span>-&gt;submenus <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$submenu</span>)\n            &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$submenu</span>-&gt;label }}\"</span> link=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$submenu</span>-&gt;link }}\"</span> /&gt;\n          @<span class=\"hljs-keyword\">endforeach</span>\n        &lt;/x-menu-sub&gt;\n      @<span class=\"hljs-keyword\">else</span>\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$menu</span>-&gt;label }}\"</span> link=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$menu</span>-&gt;link }}\"</span> /&gt;\n      @<span class=\"hljs-keyword\">endif</span>\n    @<span class=\"hljs-keyword\">endforeach</span>\n  &lt;/x-menu&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2296,2297","fold":1}}],"payload":{"lines":"2254,2255"}},{"content":"Menu Pied de page","children":[{"content":"<pre data-lines=\"2335,2336\"><code>Composant navigation/footer.blade.php :\n</code></pre>","children":[],"payload":{"lines":"2335,2336"}},{"content":"<pre><code class=\"language-php\">  &lt;?php\n  use App\\Models\\Footer;\n  use Livewire\\Volt\\Component;\n  \n  new class() extends Component {\n  \n    public function with(): array {\n  \n      return [\n        'footers' =&gt; Footer::orderBy('order')-&gt;get(),\n    ];\n  }\n  };\n?&gt;\n\n&lt;footer class=\"p-10 rounded footer footer-center bg-base-200 text-base-content\"&gt;\n  &lt;nav class=\"grid grid-flow-col gap-4\"&gt;\n    @foreach ($footers as $footer)\n      &lt;a href=\"{{ $footer-&gt;link }}\" class=\"link link-hover\"&gt;\n        @lang($footer-&gt;label)\n      &lt;/a&gt;\n    @endforeach\n  &lt;/nav&gt;\n  &lt;nav&gt;\n    &lt;div class=\"grid grid-flow-col gap-4\"&gt;\n      &lt;a href=\"https://github.com/bestmomo/sillo\" title=\"{{ __('Go to the GitHub repository and... Fork it!') }}\" target=\"_blank\"&gt;\n        &lt;svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" \n        height=\"24\" viewBox=\"0 0 24 24\" class=\"fill-current\"&gt;\n          &lt;path d=\"M12 0C5.372 0 0 5.372 0 12c0 5.303 3.438 9.8 8.207 11.387.6.11.793-.26.793-.577v-2.2c-3.338.726-4.033-1.415-4.033-1.415-.546-1.387-1.333-1.757-1.333-1.757-1.089-.744.083-.729.083-.729 1.204.085 1.838 1.237 1.838 1.237 1.07 1.835 2.809 1.305 3.495.998.108-.775.419-1.305.762-1.605-2.665-.305-5.466-1.335-5.466-5.93 0-1.31.467-2.38 1.235-3.22-.124-.303-.535-1.523.117-3.176 0 0 1.008-.322 3.3 1.23.957-.266 1.98-.399 3-.405 1.02.006 2.043.139 3 .405 2.29-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.873.118 3.176.77.84 1.233 1.91 1.233 3.22 0 4.61-2.804 5.62-5.475 5.92.43.37.815 1.1.815 2.22v3.293c0 .319.192.694.801.576C20.565 21.796 24 17.302 24 12c0-6.628-5.372-12-12-12z\" /&gt;\n        &lt;/svg&gt;\n      &lt;/a&gt;\n      &lt;a href=\"https://discord.com/channels/1258750464800063640/1258750464800063646\" title=\"{{ __('Go to the Discord channel') }}\" target=\"_blank\"&gt;\n        &lt;svg width=\"25\" height=\"28\" viewBox=\"0 0 71 80\" class=\"fill-current mt-[-.05rem]\" xmlns=\"http://www.w3.org/2000/svg\"&gt;\n          &lt;path d=\"M60.1045 13.8978C55.5792 11.8214 50.7265 10.2916 45.6527 9.41542C45.5603 9.39851 45.468 9.44077 45.4204 9.52529C44.7963 10.6353 44.105 12.0834 43.6209 13.2216C38.1637 12.4046 32.7345 12.4046 27.3892 13.2216C26.905 12.0581 26.1886 10.6353 25.5617 9.52529C25.5141 9.44359 25.4218 9.40133 25.3294 9.41542C20.2584 10.2888 15.4057 11.8186 10.8776 13.8978C10.8384 13.9147 10.8048 13.9429 10.7825 13.9795C1.57795 27.7309 -0.943561 41.1443 0.293408 54.3914C0.299005 54.4562 0.335386 54.5182 0.385761 54.5576C6.45866 59.0174 12.3413 61.7249 18.1147 63.5195C18.2071 63.5477 18.305 63.5139 18.3638 63.4378C19.7295 61.5728 20.9469 59.6063 21.9907 57.5383C22.0523 57.4172 21.9935 57.2735 21.8676 57.2256C19.9366 56.4931 18.0979 55.6 16.3292 54.5858C16.1893 54.5041 16.1781 54.304 16.3068 54.2082C16.679 53.9293 17.0513 53.6391 17.4067 53.3461C17.471 53.2926 17.5606 53.2813 17.6362 53.3151C29.2558 58.6202 41.8354 58.6202 53.3179 53.3151C53.3935 53.2785 53.4831 53.2898 53.5502 53.3433C53.9057 53.6363 54.2779 53.9293 54.6529 54.2082C54.7816 54.304 54.7732 54.5041 54.6333 54.5858C52.8646 55.6197 51.0259 56.4931 49.0921 57.2228C48.9662 57.2707 48.9102 57.4172 48.9718 57.5383C50.038 59.6034 51.2554 61.5699 52.5959 63.435C52.6519 63.5139 52.7526 63.5477 52.845 63.5195C58.6464 61.7249 64.529 59.0174 70.6019 54.5576C70.6551 54.5182 70.6887 54.459 70.6943 54.3942C72.1747 39.0791 68.2147 25.7757 60.1968 13.9823C60.1772 13.9429 60.1437 13.9147 60.1045 13.8978ZM23.7259 46.3253C20.2276 46.3253 17.3451 43.1136 17.3451 39.1693C17.3451 35.225 20.1717 32.0133 23.7259 32.0133C27.308 32.0133 30.1626 35.2532 30.1066 39.1693C30.1066 43.1136 27.28 46.3253 23.7259 46.3253ZM47.3178 46.3253C43.8196 46.3253 40.9371 43.1136 40.9371 39.1693C40.9371 35.225 43.7636 32.0133 47.3178 32.0133C50.9 32.0133 53.7545 35.2532 53.6986 39.1693C53.6986 43.1136 50.9 46.3253 47.3178 46.3253Z\" /&gt;\n        &lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n  &lt;/nav&gt;\n  &lt;aside&gt;\n    &lt;p&gt;Version 0.1.0&lt;/a&gt; - © {{ date('Y') }} Moi&lt;/p&gt;\n  &lt;/aside&gt;\n&lt;/footer&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"2382,2383\"><code>Dans les layouts (app &amp; auth) :\n</code></pre>","children":[],"payload":{"lines":"2382,2383"}},{"content":"<pre><code class=\"language-php\">    {{-- FOOTER --}}\n    &lt;hr&gt;&lt;br&gt;\n    &lt;livewire:navigation.footer /&gt;\n    &lt;br&gt;\n    \n    {{--  TOAST area --}}\n    &lt;x-toast /&gt;\n    &lt;script src=<span class=\"hljs-string\">\"{{ asset('storage/scripts/prism.js') }}\"</span>&gt;&lt;/script&gt;\n  &lt;/body&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"2396,2397\"><code>./lang/fr.json :\n</code></pre>","children":[],"payload":{"lines":"2396,2397"}},{"content":"<pre><code class=\"language-php\">  <span class=\"hljs-string\">\"Go to the GitHub repository and... Fork it!\"</span>: <span class=\"hljs-string\">\"Aller sur le dépôt GitHub et... Clonez-le !\"</span>,\n  <span class=\"hljs-string\">\"Go to the Discord channel\"</span>: <span class=\"hljs-string\">\"Allez sur le canal Discord\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2333,2334","fold":1}}],"payload":{"lines":"2244,2245"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-menus\">https://laravel.sillo.org/posts/mon-cms-les-menus</a></strong></em>","children":[],"payload":{"lines":"2403,2404"}}],"payload":{"lines":"2029,2030","fold":1}},{"content":"- Les commentaires","children":[{"content":"Model &amp; Migration et factory &amp; seeder Comment","children":[{"content":"Model Comment","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">App</span>\\<span class=\"hljs-title class_\">Models</span>;\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Factories</span>\\<span class=\"hljs-title\">HasFactory</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Model</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Notifications</span>\\<span class=\"hljs-title\">Notifiable</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\{<span class=\"hljs-title\">BelongsTo</span>, <span class=\"hljs-title\">HasMany</span>};\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Comment</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span> </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">HasFactory</span>, <span class=\"hljs-title\">Notifiable</span>;\n\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$fillable</span> = [\n        <span class=\"hljs-string\">'body'</span>,\n        <span class=\"hljs-string\">'post_id'</span>,\n        <span class=\"hljs-string\">'user_id'</span>,\n        <span class=\"hljs-string\">'parent_id'</span>,\n    ];\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">user</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">BelongsTo</span> </span>{\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">belongsTo</span>(<span class=\"hljs-title class_\">User</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">post</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">BelongsTo</span> </span>{\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">belongsTo</span>(<span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">parent</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">BelongsTo</span> </span>{\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">belongsTo</span>(<span class=\"hljs-title class_\">Comment</span>::<span class=\"hljs-variable language_\">class</span>, <span class=\"hljs-string\">'parent_id'</span>);\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">children</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">HasMany</span> </span>{\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">hasMany</span>(<span class=\"hljs-title class_\">Comment</span>::<span class=\"hljs-variable language_\">class</span>, <span class=\"hljs-string\">'parent_id'</span>);\n  }\n}\n</code></pre>","children":[]}],"payload":{"lines":"2409,2410","fold":1}},{"content":"Structure Comment","children":[{"content":"<pre><code class=\"language-php\">php artisan make:model Comment -m\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'comments'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">timestamps</span>();\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">text</span>(<span class=\"hljs-string\">'body'</span>);\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreignId</span>(<span class=\"hljs-string\">'user_id'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">constrained</span>()-&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>);\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreignId</span>(<span class=\"hljs-string\">'post_id'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">constrained</span>()-&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>);\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">unsignedBigInteger</span>(<span class=\"hljs-string\">'parent_id'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">nullable</span>()-&gt;<span class=\"hljs-keyword\">default</span>(<span class=\"hljs-literal\">null</span>);\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreign</span>(<span class=\"hljs-string\">'parent_id'</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">references</span>(<span class=\"hljs-string\">'id'</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">on</span>(<span class=\"hljs-string\">'comments'</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>);\n    });\n}\n</code></pre>","children":[]}],"payload":{"lines":"2448,2449","fold":1}},{"content":"Relations avec Comment","children":[{"content":"Model Post","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\{ <span class=\"hljs-title\">HasMany</span>, <span class=\"hljs-title\">BelongsTo</span>};\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Post</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span> </span>{\n    ...\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">comments</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">HasMany</span> </span>{\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">hasMany</span>(<span class=\"hljs-title class_\">Comment</span>::<span class=\"hljs-variable language_\">class</span>);\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">validComments</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">HasMany</span> </span>{\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">comments</span>()-&gt;<span class=\"hljs-title function_ invoke__\">whereHas</span>(<span class=\"hljs-string\">'user'</span>, function (<span class=\"hljs-variable\">$query</span>) {\n            <span class=\"hljs-variable\">$query</span>-&gt;<span class=\"hljs-title function_ invoke__\">whereValid</span>(<span class=\"hljs-literal\">true</span>);\n      });\n  }\n}\n</code></pre>","children":[]}],"payload":{"lines":"2473,2474"}},{"content":"Model User","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">comments</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">HasMany</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">hasMany</span>(<span class=\"hljs-title class_\">Comment</span>::<span class=\"hljs-variable language_\">class</span>);\n}\n</code></pre>","children":[]}],"payload":{"lines":"2493,2494"}},{"content":"<a href=\"https://laravel.sillo.org/storage/photos/2024/08/535DwpjTWsqCqM6Zut9mwt10mL0FeZp303J1W1Ef.png\">Diagramme UML</a>","children":[],"payload":{"lines":"2501,2502"}}],"payload":{"lines":"2471,2472","fold":1}},{"content":"Population Comment","children":[{"content":"<pre><code class=\"language-php\">php artisan make:factory CommentFactory\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">definition</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">array</span>\n</span>{\n    <span class=\"hljs-keyword\">return</span> [\n        <span class=\"hljs-string\">'body'</span> =&gt; <span class=\"hljs-title function_ invoke__\">fake</span>()-&gt;<span class=\"hljs-title function_ invoke__\">paragraph</span>(<span class=\"hljs-variable\">$nbSentences</span> = <span class=\"hljs-number\">4</span>, <span class=\"hljs-variable\">$variableNbSentences</span> = <span class=\"hljs-literal\">true</span>),\n    ];\n}\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">php artisan make:seeder CommentSeeder\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">Database</span>\\<span class=\"hljs-title class_\">Seeders</span>;\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">Comment</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Seeder</span>;\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">CommentSeeder</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Seeder</span>\n</span>{\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>) </span>{\n        <span class=\"hljs-variable\">$nbrPosts</span> = <span class=\"hljs-number\">9</span>;\n        <span class=\"hljs-variable\">$nbrUsers</span> = <span class=\"hljs-number\">3</span>;\n  \n        <span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-title function_ invoke__\">range</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$nbrPosts</span> - <span class=\"hljs-number\">1</span>) <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$i</span>) {\n            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-variable\">$i</span>, <span class=\"hljs-title function_ invoke__\">rand</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$nbrUsers</span>));\n        }\n  \n        <span class=\"hljs-variable\">$comment</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>);\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n  \n        <span class=\"hljs-variable\">$comment</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>);\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n  \n        <span class=\"hljs-variable\">$comment</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n  \n        <span class=\"hljs-variable\">$comment</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n  \n        <span class=\"hljs-variable\">$comment</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>);\n  \n        <span class=\"hljs-variable\">$comment</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">createComment</span>(<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-variable\">$comment</span>-&gt;id);\n    }\n  \n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">createComment</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$post_id</span>, <span class=\"hljs-variable\">$user_id</span>, <span class=\"hljs-variable\">$id</span> = <span class=\"hljs-literal\">null</span></span>) </span>{\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Comment</span>::<span class=\"hljs-title function_ invoke__\">factory</span>()-&gt;<span class=\"hljs-title function_ invoke__\">create</span>([\n            <span class=\"hljs-string\">'post_id'</span> =&gt; <span class=\"hljs-variable\">$post_id</span>,\n            <span class=\"hljs-string\">'user_id'</span> =&gt; <span class=\"hljs-variable\">$user_id</span>,\n          <span class=\"hljs-string\">'parent_id'</span> =&gt; <span class=\"hljs-variable\">$id</span>,\n      ]);\n  }\n}\n</code></pre>","children":[]},{"content":"<pre data-lines=\"2567,2568\"><code>DatabaseSeeder.php :\n</code></pre>","children":[],"payload":{"lines":"2567,2568"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">run</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">call</span>([\n        ...\n        <span class=\"hljs-title class_\">CommentSeeder</span>::<span class=\"hljs-variable language_\">class</span>,\n    ]);\n}\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">php artisan migrate:fresh --seed\n</code></pre>","children":[]}],"payload":{"lines":"2503,2504","fold":1}}],"payload":{"lines":"2407,2408","fold":1}},{"content":"Modifier dans PostRepository pour Comment","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPostBySlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span></span>): <span class=\"hljs-title\">Post</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">with</span>(<span class=\"hljs-string\">'user:id,name'</span>, <span class=\"hljs-string\">'category'</span>)\n        -&gt;<span class=\"hljs-title function_ invoke__\">withCount</span>(<span class=\"hljs-string\">'validComments'</span>)\n        -&gt;<span class=\"hljs-title function_ invoke__\">whereSlug</span>(<span class=\"hljs-variable\">$slug</span>)-&gt;<span class=\"hljs-title function_ invoke__\">firstOrFail</span>();\n}\n</code></pre>","children":[]}],"payload":{"lines":"2582,2583","fold":1}},{"content":"Ajouter &amp; modifier dans posts.show pour Comment","children":[{"content":"<pre><code class=\"language-php\">new class extends Component {\n    ...\n    public int $commentsCount;\n\n    public function mount($slug): void {\n        $postRepository = new PostRepository();\n        $this-&gt;post = $postRepository-&gt;getPostBySlug($slug);\n        $this-&gt;commentsCount = $this-&gt;post-&gt;valid_comments_count;\n    }\n}; ?&gt;\n   ...\n    &lt;div class=\"flex justify-between\"&gt;\n        &lt;p&gt;@lang('By ') {{ $post-&gt;user-&gt;name }}&lt;/p&gt;\n        &lt;em&gt;\n            @if ($commentsCount &gt; 0)\n                @lang('Number of comments: ') {{ $commentsCount }}\n            @else\n                @lang('No comments')\n            @endif\n        &lt;/em&gt;\n    &lt;/div&gt;\n    &lt;div id=\"bottom\" class=\"relative items-center w-full py-5 mx-auto md:px-12 max-w-7xl\"&gt;\n        @if ($commentsCount &gt; 0)\n            &lt;div class=\"flex justify-center\"&gt;\n                &lt;x-button label=\"{{ $commentsCount &gt; 1 ? __('View comments') : __('View comment') }}\" class=\"btn-outline\" spinner /&gt;\n            &lt;/div&gt;\n        @endif\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"2626,2627\"><code>Traductions Comment nécessaires dans posts.show :\n</code></pre>","children":[],"payload":{"lines":"2626,2627"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Number of comments: \"</span>: <span class=\"hljs-string\">\"Nombre de commentaires : \"</span>,\n<span class=\"hljs-string\">\"View comments\"</span>: <span class=\"hljs-string\">\"Voir les commentaires\"</span>,\n<span class=\"hljs-string\">\"All comments\"</span>: <span class=\"hljs-string\">\"Tous les commentaires\"</span>,\n<span class=\"hljs-string\">\"No comments\"</span>: <span class=\"hljs-string\">\"Aucun commentaire\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2592,2593","fold":1}},{"content":"Voir les commentaires dans posts.show","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n...\nuse Illuminate\\Support\\Collection;\n\nnew class extends Component {\n    ...\n    public Collection $comments;\n    public bool $listComments = false;\n    ...\n    public function showComments(): void {\n        $this-&gt;listComments = true;\n\n        $this-&gt;comments = $this-&gt;post\n            -&gt;validComments()\n            -&gt;where('parent_id', null)\n            -&gt;withCount([\n                'children' =&gt; function ($query) {\n                    $query-&gt;whereHas('user', function ($q) {\n                        $q-&gt;where('valid', true);\n                    });\n                },\n            ])\n            -&gt;with([\n                'user' =&gt; function ($query) {\n                    $query-&gt;select('id', 'name', 'email', 'role')-&gt;withCount('comments');\n                },\n            ])\n            -&gt;latest()\n            -&gt;get();\n        dd ($this-&gt;comments); \n        // Commenter le dd() ci-dessus après avoir observé le bon contenu de $this-&gt;comments\n        // Qui doit-être un truc style : \n        //   Illuminate\\Database\\Eloquent\\Collection {#609 ▼ // resources\\views\\livewire\\posts\\show.blade.php:44\n        //     #items: array:3 [▼\n        //       0 =&gt; App\\Models\\Comment {#612 ▶}\n        //       1 =&gt; App\\Models\\Comment {#606 ▶}\n        //       2 =&gt; App\\Models\\Comment {#616 ▶}\n        //     ]\n        //     #escapeWhenCastingToString: false\n        //   }\n        // Supprimer ces lignes commentées après avoir observé ce résultat à partir de // Commenter...\n    }\n}; ?&gt;\n...\n// Modifier le bouton pour l'activer au click\n&lt;x-button label=\"{{ $commentsCount &gt; 1 ? \n  __('View comments') : __('View comment') }}\"\n  wire:click=\"showComments\"\n  class=\"btn-outline\" spinner /&gt;\n...\n</code></pre>","children":[]}],"payload":{"lines":"2635,2636","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-commentaires-1-2\">https://laravel.sillo.org/posts/mon-cms-les-commentaires-1-2</a></strong></em>","children":[],"payload":{"lines":"2690,2691"}},{"content":"Le formulaire (Composant posts/comment-form)","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt posts/comment-form --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">@if ($showForm)\n    &lt;x-card title=\"{{ $formTitle }}\" shadow=\"hidden\" class=\"!p-0\"&gt;\n        &lt;x-form wire:submit=\"{{ $formAction }}\" class=\"mb-4\"&gt;\n            &lt;x-textarea wire:model=\"message\" hint=\"{{ __('Max 10000 chars') }}\" rows=\"5\" inline /&gt;\n            &lt;x-slot:actions&gt;\n                @if ($formAction === 'updateComment')\n                    &lt;x-button label=\"{{ __('Cancel') }}\" wire:click=\"toggleModifyForm(false)\"\n                        class=\"btn-ghost\" spinner /&gt;\n                @endif\n                &lt;x-button label=\"{{ __('Save') }}\" class=\"btn-primary\" type=\"submit\" spinner=\"save\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n@else\n    &lt;div class=\"mb-4\"&gt;{!! $message !!}&lt;/div&gt;\n@endif\n</code></pre>","children":[]}],"payload":{"lines":"2692,2693","fold":1}},{"content":"Gravatar","children":[{"content":"Installer Gravatar","children":[{"content":"<pre><code class=\"language-php\">composer <span class=\"hljs-keyword\">require</span> creativeorange/gravatar ~<span class=\"hljs-number\">1.0</span>\n---\nUsage:\n<span class=\"hljs-title class_\">Gravatar</span>::<span class=\"hljs-title function_ invoke__\">get</span>(<span class=\"hljs-string\">'email@example.com'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"2719,2720"}},{"content":"<a href=\"https://gravatar.com/\">Créer son Gravatar</a>","children":[],"payload":{"lines":"2728,2729"}}],"payload":{"lines":"2717,2718","fold":1}},{"content":"Les notifications","children":[{"content":"Création de commentaire","children":[{"content":"<pre><code class=\"language-php\">php artisan make:notification CommentCreated\n</code></pre>","children":[]},{"content":"<pre data-lines=\"2738,2739\"><code>app/Notifications/CommentCreated.php :\n</code></pre>","children":[],"payload":{"lines":"2738,2739"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">App</span>\\<span class=\"hljs-title class_\">Notifications</span>;\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">Comment</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Bus</span>\\<span class=\"hljs-title\">Queueable</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Notifications</span>\\<span class=\"hljs-title\">Notification</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Notifications</span>\\<span class=\"hljs-title\">Messages</span>\\<span class=\"hljs-title\">MailMessage</span>;\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">CommentCreated</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Notification</span>\n</span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Queueable</span>;\n  \n    <span class=\"hljs-keyword\">public</span> Comment <span class=\"hljs-variable\">$comment</span>;\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\">Comment <span class=\"hljs-variable\">$comment</span></span>) </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;comment = <span class=\"hljs-variable\">$comment</span>;\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">via</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">object</span> <span class=\"hljs-variable\">$notifiable</span></span>): <span class=\"hljs-title\">array</span> </span>{\n        <span class=\"hljs-keyword\">return</span> [<span class=\"hljs-string\">'mail'</span>];\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">toMail</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">object</span> <span class=\"hljs-variable\">$notifiable</span></span>): <span class=\"hljs-title\">MailMessage</span> </span>{\n        <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MailMessage</span>())\n            -&gt;<span class=\"hljs-title function_ invoke__\">subject</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'A comment has been created on your post'</span>))\n            -&gt;<span class=\"hljs-title function_ invoke__\">line</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'A comment has been created on your post'</span>) . <span class=\"hljs-string\">' \"'</span> . <span class=\"hljs-variable\">$this</span>-&gt;comment-&gt;post-&gt;title . <span class=\"hljs-string\">'\" '</span> . <span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'by'</span>) . <span class=\"hljs-string\">' '</span> . <span class=\"hljs-variable\">$this</span>-&gt;comment-&gt;user-&gt;name . <span class=\"hljs-string\">'.'</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">lineIf</span>(!<span class=\"hljs-variable\">$this</span>-&gt;comment-&gt;user-&gt;valid, <span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'This comment is awaiting moderation.'</span>))\n            -&gt;<span class=\"hljs-title function_ invoke__\">action</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Manage this comment'</span>), <span class=\"hljs-string\">\"#\"</span>);\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">toArray</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">object</span> <span class=\"hljs-variable\">$notifiable</span></span>): <span class=\"hljs-title\">array</span> </span>{\n        <span class=\"hljs-keyword\">return</span> [\n        ];\n    }\n}\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"A comment has been created on your post\"</span>: <span class=\"hljs-string\">\"Un commentaire a été ajouté à votre article\"</span>,\n<span class=\"hljs-string\">\"This comment is awaiting moderation.\"</span>: <span class=\"hljs-string\">\"Ce commentaire est en attente de modération.\"</span>,\n<span class=\"hljs-string\">\"Manage this comment\"</span>: <span class=\"hljs-string\">\"Gérer ce commentaire\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2732,2733","fold":1}},{"content":"Affichage des commentaires 1er niveau","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt posts/commentBase --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\{ Comment, Post };\nuse App\\Notifications\\CommentCreated;\nuse Illuminate\\Contracts\\Database\\Eloquent\\Builder;\nuse Livewire\\Attributes\\Validate;\nuse Livewire\\Volt\\Component;\n\nnew class() extends Component {\n    public int $postId;\n    public ?Comment $comment    = null;\n    public bool $showCreateForm = true;\n    public bool $showModifyForm = false;\n    public bool $alert          = false;\n  \n    #[Validate('required|max:10000')]\n    public string $message = '';\n  \n    public function mount($postId): void {\n        $this-&gt;postId = $postId;\n    }\n  \n    public function createComment(): void {\n        $data = $this-&gt;validate();\n  \n        if (!Auth::user()-&gt;valid) {\n            $this-&gt;alert = true;\n        }\n  \n        $post = Post::select('id', 'title', 'user_id')-&gt;with('user')-&gt;findOrFail($this-&gt;postId);\n  \n        $this-&gt;comment = Comment::create([\n            'user_id' =&gt; Auth::id(),\n            'post_id' =&gt; $this-&gt;postId,\n            'body'    =&gt; $this-&gt;message,\n        ]);\n  \n        if ($this-&gt;post-&gt;user_id != Auth::id()) {\n            $post-&gt;user-&gt;notify(new CommentCreated($this-&gt;comment));\n        }\n  \n        $this-&gt;message = $data['message'];\n    }\n  \n    public function updateComment(): void {\n        $data = $this-&gt;validate();\n  \n        $this-&gt;comment-&gt;body = $data['message'];\n        $this-&gt;comment-&gt;save();\n  \n        $this-&gt;toggleModifyForm(false);\n    }\n  \n    public function toggleModifyForm(bool $state): void {\n        $this-&gt;showModifyForm = $state;\n    }\n  \n    public function deleteComment(): void {\n        $this-&gt;comment-&gt;delete();\n  \n        $this-&gt;comment = null;\n        $this-&gt;message = '';\n    }\n}; ?&gt;\n\n&lt;div class=\"flex flex-col mt-4\"&gt;\n    @if ($this-&gt;comment)\n\n        @if ($alert)\n            &lt;x-alert title=\"{!! __('This is your first comment') !!}\" description=\"{!! __('It will be validated by an administrator before it appears here') !!}\" icon=\"o-exclamation-triangle\"\n                class=\"alert-warning\" /&gt;\n        @else\n            &lt;div class=\"flex flex-col justify-between mb-4 md:flex-row\"&gt;\n                &lt;x-avatar :image=\"Gravatar::get(Auth::user()-&gt;email)\" class=\"!w-24\"&gt;\n                    &lt;x-slot:title class=\"pl-2 text-xl\"&gt;\n                        {{ Auth::user()-&gt;name }}\n                    &lt;/x-slot:title&gt;\n                    &lt;x-slot:subtitle class=\"flex flex-col gap-1 pl-2 mt-2 text-gray-500\"&gt;\n                        &lt;x-icon name=\"o-calendar\" label=\"{{ $comment-&gt;created_at-&gt;diffForHumans() }}\" /&gt;\n                        &lt;x-icon name=\"o-chat-bubble-left\"\n                            label=\"{{ $comment-&gt;user-&gt;comments_count }} {{ __(' comments') }}\" /&gt;\n                    &lt;/x-slot:subtitle&gt;\n                &lt;/x-avatar&gt;\n\n                &lt;div class=\"flex flex-col mt-4 space-y-2 lg:mt-0 lg:flex-row lg:items-center lg:space-y-0 lg:space-x-2\"&gt;\n                    &lt;x-button label=\"{{ __('Modify') }}\" wire:click=\"toggleModifyForm(true)\"\n                        class=\"btn-outline btn-sm\" /&gt;\n                    &lt;x-button label=\"{{ __('Delete') }}\" wire:click=\"deleteComment()\"\n                        wire:confirm=\"{{ __('Are you sure to delete this comment?') }}\"\n                        class=\"btn-outline btn-error btn-sm\" /&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            @include('livewire.posts.comment-form', ['formTitle' =&gt; __('Update your comment'), 'formAction' =&gt; 'updateComment', 'showForm' =&gt; $showModifyForm, 'message' =&gt; $comment-&gt;body])\n\n        @endif\n\n    @else\n        @include('livewire.posts.comment-form', ['formTitle' =&gt; __('Leave a comment'), 'formAction' =&gt; 'createComment', 'showForm' =&gt; true, 'message' =&gt; ''])\n    @endif\n\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"This is your first comment\"</span>: <span class=\"hljs-string\">\"C'est votre premier commentaire\"</span>,\n<span class=\"hljs-string\">\"It will be validate by an administrator before it appears here\"</span>: <span class=\"hljs-string\">\"Il sera valide par un administrateur avant qu'il ne soit affiché ici\"</span>,\n<span class=\"hljs-string\">\"Leave a comment\"</span>: <span class=\"hljs-string\">\"Laissez un commentaire\"</span>,\n<span class=\"hljs-string\">\"Your comment\"</span>: <span class=\"hljs-string\">\"Votre commentaire\"</span>,\n<span class=\"hljs-string\">\"Update your comment\"</span>: <span class=\"hljs-string\">\"Modifier votre commentaire\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this comment?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer ce commentaire ?\"</span>,\n<span class=\"hljs-string\">\"Comments\"</span>: <span class=\"hljs-string\">\"Commentaires\"</span>,\n<span class=\"hljs-string\">\"Modify\"</span>: <span class=\"hljs-string\">\"Modifier\"</span>,\n<span class=\"hljs-string\">\"1 comment\"</span>: <span class=\"hljs-string\">\"1 commentaire\"</span>,\n<span class=\"hljs-string\">\"comments\"</span>: <span class=\"hljs-string\">\"commentaires\"</span>\n</code></pre>","children":[]},{"content":"<pre data-lines=\"2906,2907\"><code>Modification de posts.show :\n</code></pre>","children":[],"payload":{"lines":"2906,2907"}},{"content":"<pre><code class=\"language-php\">...\n   &lt;div id=\"bottom\" class=\"relative items-center w-full py-5 mx-auto md:px-12 max-w-7xl\"&gt;\n        @if ($listComments)\n            &lt;x-card title=\"{{ __('Comments') }}\" shadow separator&gt;\n                 Affichage des commentaires ici !\n                @auth\n                    &lt;livewire:posts.commentBase :postId=\"$post-&gt;id\" /&gt;\n                @endauth\n            &lt;/x-card&gt;\n        @else\n            @if ($commentsCount &gt; 0)\n                &lt;div class=\"flex justify-center\"&gt;\n                    &lt;x-button label=\"{{ $commentsCount &gt; 1 ? __('View comments') : __('View comment') }}\"\n                        wire:click=\"showComments\" class=\"btn-outline\" spinner /&gt;\n                &lt;/div&gt;\n            @else\n                @auth\n                    &lt;livewire:posts.commentBase :postId=\"$post-&gt;id\" /&gt;\n                @endauth\n            @endif\n        @endif\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2784,2785","fold":1}},{"content":"Notification de réponse à un commentaire","children":[{"content":"<pre><code class=\"language-php\">php artisan make:notification CommentAnswerCreated\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">App</span>\\<span class=\"hljs-title class_\">Notifications</span>;\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\<span class=\"hljs-title\">Comment</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Bus</span>\\<span class=\"hljs-title\">Queueable</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Notifications</span>\\<span class=\"hljs-title\">Messages</span>\\<span class=\"hljs-title\">MailMessage</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Notifications</span>\\<span class=\"hljs-title\">Notification</span>;\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">CommentAnswerCreated</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Notification</span>\n</span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Queueable</span>;\n\n    <span class=\"hljs-keyword\">public</span> Comment <span class=\"hljs-variable\">$comment</span>;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">__construct</span>(<span class=\"hljs-params\">Comment <span class=\"hljs-variable\">$comment</span></span>) </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;comment = <span class=\"hljs-variable\">$comment</span>;\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">via</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">object</span> <span class=\"hljs-variable\">$notifiable</span></span>): <span class=\"hljs-title\">array</span> </span>{\n        <span class=\"hljs-keyword\">return</span> [<span class=\"hljs-string\">'mail'</span>];\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">toMail</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">object</span> <span class=\"hljs-variable\">$notifiable</span></span>): <span class=\"hljs-title\">MailMessage</span> </span>{\n        <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MailMessage</span>())\n            -&gt;<span class=\"hljs-title function_ invoke__\">subject</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'An answer has been created on your comment'</span>))\n            -&gt;<span class=\"hljs-title function_ invoke__\">line</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'An answer has been created on your comment'</span>) . <span class=\"hljs-string\">' \"'</span> . <span class=\"hljs-variable\">$this</span>-&gt;comment-&gt;post-&gt;title . <span class=\"hljs-string\">'\" '</span> . <span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'by'</span>) . <span class=\"hljs-string\">' '</span> . <span class=\"hljs-variable\">$this</span>-&gt;comment-&gt;user-&gt;name . <span class=\"hljs-string\">'.'</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">action</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Show this comment'</span>), <span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'posts.show'</span>, <span class=\"hljs-variable\">$this</span>-&gt;comment-&gt;post-&gt;slug));\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">toArray</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">object</span> <span class=\"hljs-variable\">$notifiable</span></span>): <span class=\"hljs-title\">array</span> </span>{\n        <span class=\"hljs-keyword\">return</span> [\n        ];\n    }\n}\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"An answer has been created on your comment\"</span>: <span class=\"hljs-string\">\"Une réponse a été apportée à votre commentaire\"</span>,\n<span class=\"hljs-string\">\"Show this comment\"</span>: <span class=\"hljs-string\">\"Voir ce commentaire\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2934,2935","fold":1}}],"payload":{"lines":"2730,2731","fold":1}},{"content":"Composant pour l'affichage des commentaires","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt posts/comment --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\{ Comment, Reaction };\nuse App\\Notifications\\{CommentAnswerCreated, CommentCreated};\nuse Illuminate\\Support\\Collection;\nuse Livewire\\Attributes\\Validate;\nuse Livewire\\Volt\\Component;\n\nnew class() extends Component {\n    public ?Comment $comment;\n    public ?Collection $children;\n    public bool $showAnswerForm = false;\n    public bool $showModifyForm = false;\n    public bool $alert          = false;\n    public int $children_count  = 0;\n    public int $depth;\n  \n    #[Validate('required|max:10000')]\n    public string $message = '';\n  \n    public function mount($comment, $depth): void {\n        $this-&gt;comment = $comment;\n        $this-&gt;depth   = $depth;\n        $this-&gt;message = strip_tags($comment-&gt;body);\n        $this-&gt;children_count = $comment-&gt;children_count;\n    }\n  \n    public function showAnswers(): void {\n        $this-&gt;children = Comment::where('parent_id', $this-&gt;comment-&gt;id)\n            -&gt;with([\n                'user' =&gt; function ($query) {\n                    $query-&gt;select('id', 'name', 'email', 'role')-&gt;withCount('comments');\n                },\n            ])\n            -&gt;withCount(['children' =&gt; function ($query) {\n                $query-&gt;whereHas('user', function ($q) {\n                    $q-&gt;where('valid', true);\n                });\n            }])\n            -&gt;get();\n  \n        $this-&gt;children_count = 0;\n    }\n  \n    public function toggleAnswerForm(bool $state): void {\n        $this-&gt;showAnswerForm = $state;\n        $this-&gt;message        = '';\n    }\n  \n    public function toggleModifyForm(bool $state): void {\n        $this-&gt;showModifyForm = $state;\n    }\n  \n    public function createAnswer(): void {\n        $data              = $this-&gt;validate();\n        $data['parent_id'] = $this-&gt;comment-&gt;id;\n        $data['user_id']   = Auth::id();\n        $data['post_id']   = $this-&gt;comment-&gt;post_id;\n        $data['body']      = $this-&gt;message;\n  \n        $item = Comment::create($data);\n  \n        $item-&gt;save();\n  \n        if ($item-&gt;post-&gt;user_id != Auth::id()) {\n            $item-&gt;post-&gt;user-&gt;notify(new CommentCreated($item));\n        }\n  \n        $author = $this-&gt;comment-&gt;user;\n        if ($author-&gt;id != $item-&gt;post-&gt;user_id &amp;&amp; $author-&gt;id != Auth::id()) {\n            $author-&gt;notify(new CommentAnswerCreated($item));\n        }\n  \n        $this-&gt;toggleAnswerForm(false);\n  \n        $this-&gt;showAnswers();\n    }\n  \n    public function updateAnswer(): void {\n        $data = $this-&gt;validate();\n  \n        $this-&gt;comment-&gt;body = $data['message'];\n        $this-&gt;comment-&gt;save();\n  \n        $this-&gt;toggleModifyForm(false);\n    }\n  \n    public function deleteComment(): void {\n        $this-&gt;comment-&gt;delete();\n        $this-&gt;childs  = null;\n        $this-&gt;comment = null;\n    } \n}; ?&gt;\n\n&lt;div&gt;\n    &lt;style&gt;\n        @media (max-width: 768px) {\n            .ml-0 { margin-left: 0rem; }\n            .ml-3 { margin-left: 0.75rem; }\n            .ml-6 { margin-left: 1.5rem; }\n            .ml-9 { margin-left: 2.25rem; }\n        }\n        @media (min-width: 769px) {\n            .ml-0 { margin-left: 0rem; }\n            .ml-3 { margin-left: 3rem; }\n            .ml-6 { margin-left: 6rem; }\n            .ml-9 { margin-left: 9rem; }\n        }\n    &lt;/style&gt;\n\n    @if ($comment)\n        &lt;div class=\"flex flex-col mt-4 ml-{{ $depth * 3 }} lg:ml-{{ $depth * 3 }} border-2 border-gray-400 rounded-md p-2 selection:transition duration-500 ease-in-out shadow-md shadow-gray-500 hover:shadow-xl hover:shadow-gray-500\" &gt;\n\n            &lt;div class=\"flex flex-col justify-between mb-4 md:flex-row\"&gt;\n                &lt;x-avatar :image=\"Gravatar::get($comment-&gt;user-&gt;email)\" class=\"!w-24\"&gt;\n                    &lt;x-slot:title class=\"pl-2 text-xl\"&gt;\n                        {{ $comment-&gt;user-&gt;name }}\n                    &lt;/x-slot:title&gt;\n                    &lt;x-slot:subtitle class=\"flex flex-col gap-1 pl-2 mt-2 text-gray-500\"&gt;\n                        &lt;x-icon name=\"o-calendar\" label=\"{{ $comment-&gt;created_at-&gt;diffForHumans() }}\" /&gt;\n                        &lt;x-icon name=\"o-chat-bubble-left\"  label=\"{{ $comment-&gt;user-&gt;comments_count == 0 ? '' : ($comment-&gt;user-&gt;comments_count == 1 ? __('1 comment') : $comment-&gt;user-&gt;comments_count . ' ' . __('comments')) }}\" /&gt;\n                    &lt;/x-slot:subtitle&gt;\n                &lt;/x-avatar&gt;\n\n                &lt;div class=\"flex flex-col mt-4 space-y-2 lg:mt-0 lg:flex-row lg:items-center lg:space-y-0 lg:space-x-2\"&gt;\n                    @auth\n                        @if (Auth::user()-&gt;name == $comment-&gt;user-&gt;name)\n                            &lt;x-button label=\"{{ __('Modify') }}\" wire:click=\"toggleModifyForm(true)\"\n                                class=\"btn-outline btn-warning btn-sm\" spinner /&gt;\n                            &lt;x-button label=\"{{ __('Delete') }}\" wire:click=\"deleteComment()\"\n                                wire:confirm=\"{{ __('Are you sure to delete this comment?') }}\"\n                                class=\"mt-2 btn-outline btn-error btn-sm\" spinner /&gt;\n                        @endif\n                        @if ($depth &lt; 3)\n                            &lt;x-button label=\"{{ __('Answer') }}\" wire:click=\"toggleAnswerForm(true)\"\n                                class=\"mt-2 btn-outline btn-sm\" spinner /&gt;\n                        @endif\n                    @endauth\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            @if(!$showModifyForm)\n                &lt;div class=\"mb-4\"&gt;\n                    {!! nl2br($comment-&gt;body) !!}\n                &lt;/div&gt;\n            @endif\n            @if ($showModifyForm || $showAnswerForm)\n                &lt;x-card :title=\"($showModifyForm ? __('Update your comment') : __('Your answer'))\" shadow=\"hidden\" class=\"!p-0\"&gt;\n                    &lt;x-form :wire:submit=\"($showModifyForm ? 'updateAnswer' : 'createAnswer')\" class=\"mb-4\"&gt;\n                        &lt;x-textarea wire:model=\"message\" :placeholder=\"($showAnswerForm ? __('Your answer') . ' ...' : '')\" hint=\"{{ __('Max 10000 chars') }}\" rows=\"5\" inline /&gt;\n                        &lt;x-slot:actions&gt;\n                            &lt;x-button label=\"{{ __('Cancel') }}\" :wire:click=\"($showModifyForm ? 'toggleModifyForm(false)' : 'toggleAnswerForm(false)')\"\n                                class=\"btn-ghost\" /&gt;\n                            &lt;x-button label=\"{{ __('Save') }}\" class=\"btn-primary\" type=\"submit\" spinner=\"save\" /&gt;\n                        &lt;/x-slot:actions&gt;\n                    &lt;/x-form&gt;\n                &lt;/x-card&gt;\n            @endif\n\n            @if ($alert)\n                &lt;x-alert title=\"{!! __('This is your first comment') !!}\"\n                    description=\"{{ __('It will be validated by an administrator before it appears here') }}\"\n                    icon=\"o-exclamation-triangle\" class=\"alert-warning\" /&gt;\n            @endif\n\n            @if($children_count &gt; 0)\n                &lt;x-button label=\"{{ __('Show the answers') }} ({{ $children_count }})\" wire:click=\"showAnswers\" class=\"mt-2 btn-outline btn-sm\" spinner /&gt;\n            @endif\n\n        &lt;/div&gt;\n    @endif\n\n    @if($children)\n        @foreach ($children as $child)\n            &lt;livewire:posts.comment :comment=\"$child\" :depth=\"$depth + 1\" :key=\"$child-&gt;id\"&gt;\n        @endforeach\n    @endif\n\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Answer\"</span>: <span class=\"hljs-string\">\"Répondre\"</span>,\n<span class=\"hljs-string\">\"Show the answers\"</span>: <span class=\"hljs-string\">\"Afficher les réponses\"</span>\n</code></pre>","children":[]},{"content":"<pre data-lines=\"3174,3175\"><code>Adaptation du posts.show à la place de : 'Affichage des commentaires ici !'\n</code></pre>","children":[],"payload":{"lines":"3174,3175"}},{"content":"<pre><code class=\"language-php\">    @<span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$comments</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$comment</span>)\n        @<span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-variable\">$comment</span>-&gt;parent_id)\n            &lt;livewire:posts.comment :<span class=\"hljs-variable\">$comment</span> :depth=<span class=\"hljs-string\">\"0\"</span> :key=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$comment</span>-&gt;id\"</span> /&gt;\n        @<span class=\"hljs-keyword\">endif</span>\n    @<span class=\"hljs-keyword\">endforeach</span>\n</code></pre>","children":[]}],"payload":{"lines":"2982,2983","fold":1}},{"content":"Sécurité // {!! $uneVariabledansDuCodeBladeQuiContient DuCodeDestinéÀLaVue !!}","children":[{"content":"<pre><code class=\"language-php\">composer <span class=\"hljs-keyword\">require</span> mews/purifier\n---\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mews</span>\\<span class=\"hljs-title\">Purifier</span>\\<span class=\"hljs-title\">Casts</span>\\<span class=\"hljs-title\">CleanHtmlInput</span>;\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Comment</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n</span>{\n    ...\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$casts</span> = [\n        <span class=\"hljs-string\">'body'</span> =&gt; <span class=\"hljs-title class_\">CleanHtmlInput</span>::<span class=\"hljs-variable language_\">class</span>,\n    ];\n    ...\n}\n</code></pre>","children":[]}],"payload":{"lines":"3184,3185","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-commentaires-2-2\">https://laravel.sillo.org/posts/mon-cms-les-commentaires-2-2</a></strong></em>","children":[],"payload":{"lines":"3201,3202"}}],"payload":{"lines":"2405,2406","fold":1}},{"content":"- Le profil","children":[{"content":"Route du profil","children":[{"content":"<pre data-lines=\"3207,3210\"><code>- (Pensez que ce n'est que pour les \"autorisés\"\n→ **Middleware('auth')**) et comme il y aura d'autres routes\npour \"eux\", en faire un **group()**\n</code></pre>","children":[],"payload":{"lines":"3207,3210"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/profile'</span>, <span class=\"hljs-string\">'auth.profile'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'profile'</span>);\n});\n</code></pre>","children":[]}],"payload":{"lines":"3205,3206","fold":1}},{"content":"Liens dans les vues adhoc","children":[{"content":"<pre data-lines=\"3219,3220\"><code>- Pour les grands écrans, dans **navigation.navbar** :\n</code></pre>","children":[],"payload":{"lines":"3219,3220"}},{"content":"<pre><code class=\"language-bash\">@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$user</span> = auth()-&gt;user())\n    &lt;x-dropdown&gt;\n        &lt;x-slot:trigger&gt;\n            &lt;x-button label=<span class=\"hljs-string\">\"{{ <span class=\"hljs-variable\">$user</span>-&gt;name }}\"</span> class=<span class=\"hljs-string\">\"btn-ghost\"</span> /&gt;\n        &lt;/x-slot:trigger&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Profile') }}\"</span> <span class=\"hljs-built_in\">link</span>=<span class=\"hljs-string\">\"{{ route('profile') }}\"</span> /&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"3230,3231\"><code>- Pour les plus petits, dans **navigation.sidebar** :\n</code></pre>","children":[],"payload":{"lines":"3230,3231"}},{"content":"<pre><code class=\"language-bash\">@<span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$user</span> = auth()-&gt;user())\n    &lt;x-menu-separator /&gt;\n        &lt;x-list-item :item=<span class=\"hljs-string\">\"<span class=\"hljs-variable\">$user</span>\"</span> value=<span class=\"hljs-string\">\"name\"</span> sub-value=<span class=\"hljs-string\">\"email\"</span> no-separator no-hover class=<span class=\"hljs-string\">\"-mx-2 !-my-2 rounded\"</span>&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button icon=<span class=\"hljs-string\">\"o-power\"</span> wire:click=<span class=\"hljs-string\">\"logout\"</span> class=<span class=\"hljs-string\">\"btn-circle btn-ghost btn-xs\"</span> tooltip-left=<span class=\"hljs-string\">\"{{ __('Logout') }}\"</span> no-wire-navigate /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-list-item&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Profile') }}\"</span> icon=<span class=\"hljs-string\">\"o-user\"</span> <span class=\"hljs-built_in\">link</span>=<span class=\"hljs-string\">\"{{ route('profile') }}\"</span> /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"3217,3218","fold":1}},{"content":"Composant Profile","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt auth/profile --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\User;\nuse Illuminate\\Support\\Facades\\{Auth, Hash};\nuse Illuminate\\Support\\Str;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\Layout;\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Profile')] #[Layout('components.layouts.auth')] class extends Component {\n    use Toast;\n\n    public User $user;\n    public string $email = '';\n    public string $password = '';\n    public string $password_confirmation = '';\n\n    public function mount(): void {\n        $this-&gt;user = Auth::user();\n        $this-&gt;email = $this-&gt;user-&gt;email;\n    }\n\n    public function save(): void {\n        $data = $this-&gt;validate([\n            'email' =&gt; ['required', 'email', Rule::unique('users')-&gt;ignore($this-&gt;user-&gt;id)],\n            'password' =&gt; 'confirmed',\n        ]);\n\n        if (!empty($data['password'])) {\n            $data['password'] = Hash::make($data['password']);\n        }\n\n        $this-&gt;user-&gt;update($data);\n        $this-&gt;success(__('Profile updated with success.'), redirectTo: '/profile');\n    }\n\n    public function deleteAccount(): void {\n        $this-&gt;user-&gt;delete();\n        $this-&gt;success(__('Account deleted with success.'), redirectTo: '/');\n    }\n\n    public function generatePassword($length = 16): void {\n        $this-&gt;password = Str::random($length);\n        $this-&gt;password_confirmation = $this-&gt;password;\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-card class=\"flex items-center justify-center h-screen\" title=\"\"&gt;\n\n        &lt;a href=\"/\" title=\"{{ __('Go on site') }}\"&gt;\n            &lt;x-card class=\"items-center py-0\" title=\"{{ __('Update profile') }}\" shadow separator\n                progress-indicator&gt;&lt;/x-card&gt;\n        &lt;/a&gt;\n\n        &lt;x-form wire:submit=\"save\"&gt;\n\n            &lt;x-avatar :image=\"Gravatar::get($user-&gt;email)\" class=\"!w-24\"&gt;\n                &lt;x-slot:title class=\"pl-2 text-xl\"&gt;\n                    {{ $user-&gt;name }}\n                &lt;/x-slot:title&gt;\n                &lt;x-slot:subtitle class=\"flex flex-col gap-1 pl-2 mt-2 text-gray-500\"&gt;\n                    &lt;x-icon name=\"o-hand-raised\" label=\"{!! __('Your name can\\'t be changed') !!}\" /&gt;\n                    &lt;a href=\"https://fr.gravatar.com/\"&gt;\n                        &lt;x-icon name=\"c-user\" label=\"{{ __('You can change your profile picture on Gravatar') }}\" /&gt;\n                    &lt;/a&gt;\n                &lt;/x-slot:subtitle&gt;\n            &lt;/x-avatar&gt;\n\n            &lt;x-input label=\"{{ __('E-mail') }}\" wire:model=\"email\" icon=\"o-envelope\" inline /&gt;&lt;hr&gt;\n            &lt;x-input label=\"{{ __('Password') }}\" wire:model=\"password\" icon=\"o-key\" inline /&gt;\n            &lt;x-input label=\"{{ __('Confirm Password') }}\" wire:model=\"password_confirmation\" icon=\"o-key\" inline /&gt;\n            &lt;x-button label=\"{{ __('Generate a secure password') }}\" wire:click=\"generatePassword()\" icon=\"m-wrench\"\n                class=\"btn-outline btn-sm\" /&gt;\n\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Cancel') }}\" link=\"/\" class=\"btn-ghost\" /&gt;\n                &lt;x-button label=\"{{ __('Delete account') }}\" icon=\"c-hand-thumb-down\"\n                    wire:confirm=\"{{ __('Are you sure to delete your account?') }}\" wire:click=\"deleteAccount\"\n                    class=\"btn-warning\" /&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"3243,3244","fold":1}},{"content":"Traductions pour Profile","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Update profile\"</span>: <span class=\"hljs-string\">\"Modifier le profil\"</span>,\n<span class=\"hljs-string\">\"Your name can't be changed\"</span>: <span class=\"hljs-string\">\"Votre nom ne peut pas être modifié\"</span>,\n<span class=\"hljs-string\">\"You can change your profile picture on Gravatar\"</span>: <span class=\"hljs-string\">\"Vous pouvez changer votre image de profil sur Gravatar\"</span>,\n<span class=\"hljs-string\">\"Generate a secure password\"</span>: <span class=\"hljs-string\">\"Créer un mot de passe sécurisé\"</span>,\n<span class=\"hljs-string\">\"Profile updated with success.\"</span>: <span class=\"hljs-string\">\"Profil mis à jour avec succès.\"</span>,\n<span class=\"hljs-string\">\"Delete account\"</span>: <span class=\"hljs-string\">\"Supprimer le compte\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete your account?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer votre compte ?\"</span>,\n<span class=\"hljs-string\">\"Profile\"</span>: <span class=\"hljs-string\">\"Profil\"</span>,\n<span class=\"hljs-string\">\"Go on site\"</span>: <span class=\"hljs-string\">\"Allez sur le site\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"3339,3340","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-le-profil\">https://laravel.sillo.org/posts/mon-cms-le-profil</a></strong></em>","children":[],"payload":{"lines":"3353,3354"}}],"payload":{"lines":"3203,3204","fold":1}},{"content":"- Les favoris","children":[{"content":"Fonctionnalité des Favoris","children":[{"content":"Migration Favoris","children":[{"content":"<pre><code class=\"language-php\">php artisan make:migration create_favorites_table\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">up</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-title class_\">Schema</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-string\">'favorites'</span>, function (Blueprint <span class=\"hljs-variable\">$table</span>) {\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreignId</span>(<span class=\"hljs-string\">'user_id'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">constrained</span>()-&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>);\n        <span class=\"hljs-variable\">$table</span>-&gt;<span class=\"hljs-title function_ invoke__\">foreignId</span>(<span class=\"hljs-string\">'post_id'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">constrained</span>()-&gt;<span class=\"hljs-title function_ invoke__\">onDelete</span>(<span class=\"hljs-string\">'cascade'</span>);\n    });\n}\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">php artisan migrate\n</code></pre>","children":[]}],"payload":{"lines":"3359,3360","fold":1}},{"content":"Relation n:n (User &amp; Post)","children":[{"content":"<pre data-lines=\"3381,3387\"><code>À noter :\nComme la convention de nommage de table pivot est non respectée\n(Devrait être 'posts_users' mais est 'favorites'), on doit\npréciser ce nom dans les relations BelongsToMany\n\nModels/User.php :\n</code></pre>","children":[],"payload":{"lines":"3381,3387"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\{ <span class=\"hljs-title\">HasMany</span>, <span class=\"hljs-title\">BelongsToMany</span> };\n...\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">favoritePosts</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">BelongsToMany</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">belongsToMany</span>(<span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-variable language_\">class</span>, <span class=\"hljs-string\">'favorites'</span>);\n}\n</code></pre>","children":[]},{"content":"<pre data-lines=\"3396,3397\"><code>Models/Post.php :\n</code></pre>","children":[],"payload":{"lines":"3396,3397"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Database</span>\\<span class=\"hljs-title\">Eloquent</span>\\<span class=\"hljs-title\">Relations</span>\\{ <span class=\"hljs-title\">HasMany</span>, <span class=\"hljs-title\">BelongsTo</span>, <span class=\"hljs-title\">BelongsToMany</span> };\n...\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">favoritedByUsers</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">BelongsToMany</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">belongsToMany</span>(<span class=\"hljs-title class_\">User</span>::<span class=\"hljs-variable language_\">class</span>, <span class=\"hljs-string\">'favorites'</span>);\n}\n</code></pre>","children":[]}],"payload":{"lines":"3379,3380","fold":1}},{"content":"PostRepository: getPostBySlug()","children":[{"content":"<pre data-lines=\"3408,3409\"><code>Vérifier en plus si l'user a mis le post en favori :\n</code></pre>","children":[],"payload":{"lines":"3408,3409"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPostBySlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span></span>): <span class=\"hljs-title\">Post</span> </span>{\n    <span class=\"hljs-variable\">$userId</span> = <span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n  \n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">with</span>(<span class=\"hljs-string\">'user:id,name'</span>, <span class=\"hljs-string\">'category'</span>)\n        -&gt;<span class=\"hljs-title function_ invoke__\">withCount</span>(<span class=\"hljs-string\">'validComments'</span>)\n        -&gt;<span class=\"hljs-title function_ invoke__\">withExists</span>([\n            <span class=\"hljs-string\">'favoritedByUsers as is_favorited'</span> =&gt; function (<span class=\"hljs-variable\">$query</span>) <span class=\"hljs-keyword\">use</span> ($<span class=\"hljs-title\">userId</span>) {\n                $<span class=\"hljs-title\">query</span>-&gt;<span class=\"hljs-title\">where</span>('<span class=\"hljs-title\">user_id</span>', $<span class=\"hljs-title\">userId</span>);\n            },\n      ])\n      -&gt;<span class=\"hljs-title function_ invoke__\">where</span>(<span class=\"hljs-string\">'slug'</span>, <span class=\"hljs-variable\">$slug</span>)-&gt;<span class=\"hljs-title function_ invoke__\">firstOrFail</span>();\n}\n</code></pre>","children":[]}],"payload":{"lines":"3406,3407","fold":1}},{"content":"Route &amp; lien Favoris","children":[{"content":"<pre data-lines=\"3427,3428\"><code>Ajout de la route dans **routes/web.php** :\n</code></pre>","children":[],"payload":{"lines":"3427,3428"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/favorites'</span>, <span class=\"hljs-string\">'index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.favorites'</span>);\n});\n</code></pre>","children":[]}],"payload":{"lines":"3425,3426","fold":1}},{"content":"Favoris dans posts.show","children":[{"content":"<pre data-lines=\"3438,3440\"><code>On affiche l'icône étoile pour mettre en favoris\nou retirer l'article des favoris :\n</code></pre>","children":[],"payload":{"lines":"3438,3440"}},{"content":"<pre><code class=\"language-php\">public function favoritePost(): void {\n    $user = auth()-&gt;user();\n\n    if ($user) {\n        $user-&gt;favoritePosts()-&gt;attach($this-&gt;post-&gt;id);\n        $this-&gt;post-&gt;is_favorited = true;\n    }\n}\n\npublic function unfavoritePost(): void {\n    $user = auth()-&gt;user();\n\n    if ($user) {\n        $user-&gt;favoritePosts()-&gt;detach($this-&gt;post-&gt;id);\n        $this-&gt;post-&gt;is_favorited = false;\n    }\n}\n...\n&lt;div id=\"top\" class=\"flex justify-end gap-4\"&gt;\n    @auth\n        &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n                @if ($post-&gt;is_favorited)\n                    &lt;x-button icon=\"s-star\" wire:click=\"unfavoritePost\" spinner\n                        class=\"text-yellow-500 btn-ghost btn-sm\" /&gt;\n                @else\n                    &lt;x-button icon=\"s-star\" wire:click=\"favoritePost\" spinner class=\"btn-ghost btn-sm\" /&gt;\n                @endif\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n                @if ($post-&gt;is_favorited)\n                    @lang('Remove from favorites')\n                @else\n                    @lang('Bookmark this post')\n                @endif\n            &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n    @endauth\n    ...\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Bookmark this post\"</span>: <span class=\"hljs-string\">\"Marquer cet article\"</span>,\n<span class=\"hljs-string\">\"Remove from favorites\"</span>: <span class=\"hljs-string\">\"Supprimer des favoris\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"3436,3437","fold":1}},{"content":"PostRepository pour \"is_favorited\"","children":[{"content":"<pre data-lines=\"3491,3492\"><code>Si connecté, trouver ses articles favoris :\n</code></pre>","children":[],"payload":{"lines":"3491,3492"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Facades</span>\\<span class=\"hljs-title\">DB</span>;\n...\n<span class=\"hljs-keyword\">protected</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getBaseQuery</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">Builder</span> </span>{\n\t...\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">select</span>(<span class=\"hljs-string\">'id'</span>, <span class=\"hljs-string\">'slug'</span>, <span class=\"hljs-string\">'image'</span>, <span class=\"hljs-string\">'title'</span>, <span class=\"hljs-string\">'user_id'</span>, <span class=\"hljs-string\">'category_id'</span>, <span class=\"hljs-string\">'created_at'</span>, <span class=\"hljs-string\">'pinned'</span>)\n    ...\n    -&gt;<span class=\"hljs-title function_ invoke__\">when</span>(<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">check</span>(), function (<span class=\"hljs-variable\">$query</span>) {\n        <span class=\"hljs-variable\">$userId</span> = <span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">id</span>();\n        <span class=\"hljs-variable\">$query</span>-&gt;<span class=\"hljs-title function_ invoke__\">addSelect</span>([\n            <span class=\"hljs-string\">'is_favorited'</span> =&gt; DB::<span class=\"hljs-title function_ invoke__\">table</span>(<span class=\"hljs-string\">'favorites'</span>)\n                -&gt;<span class=\"hljs-title function_ invoke__\">selectRaw</span>(<span class=\"hljs-string\">'1'</span>)\n                -&gt;<span class=\"hljs-title function_ invoke__\">whereColumn</span>(<span class=\"hljs-string\">'post_id'</span>, <span class=\"hljs-string\">'posts.id'</span>)\n                -&gt;<span class=\"hljs-title function_ invoke__\">where</span>(<span class=\"hljs-string\">'user_id'</span>, <span class=\"hljs-variable\">$userId</span>)\n                -&gt;<span class=\"hljs-title function_ invoke__\">limit</span>(<span class=\"hljs-number\">1</span>)\n        ]);\n    });\n}\n</code></pre>","children":[]}],"payload":{"lines":"3489,3490","fold":1}},{"content":"Page d'accueil (Homepage)","children":[{"content":"<pre><code class=\"language-php\">&lt;x-slot:menu&gt;\n    @if ($post-&gt;pinned)\n        &lt;x-badge value=\"{{ __('Pinned') }}\" class=\"p-3 badge-warning\" /&gt;\n    @endif\n    @auth\n        @if ($post-&gt;is_favorited)\n            &lt;x-icon name=\"s-star\" class=\"w-6 h-6 text-yellow-500 cursor-pointer\" /&gt;\n        @endif\n    @endauth\n&lt;/x-slot:menu&gt;\n</code></pre>","children":[]}],"payload":{"lines":"3513,3514","fold":1}},{"content":"Ajout de getFavoritePosts() dans PostRepository","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\{<span class=\"hljs-title\">Category</span>, <span class=\"hljs-title\">Post</span>, <span class=\"hljs-title\">User</span>};\n...\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getFavoritePosts</span>(<span class=\"hljs-params\">User <span class=\"hljs-variable\">$user</span></span>): <span class=\"hljs-title\">LengthAwarePaginator</span> </span>{\n\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">getBaseQuery</span>()\n        -&gt;<span class=\"hljs-title function_ invoke__\">whereHas</span>(<span class=\"hljs-string\">'favoritedByUsers'</span>, function (Builder <span class=\"hljs-variable\">$query</span>) {\n            <span class=\"hljs-variable\">$query</span>-&gt;<span class=\"hljs-title function_ invoke__\">where</span>(<span class=\"hljs-string\">'user_id'</span>, <span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">id</span>());\n        })\n        -&gt;<span class=\"hljs-title function_ invoke__\">latest</span>()\n      -&gt;<span class=\"hljs-title function_ invoke__\">paginate</span>(<span class=\"hljs-title function_ invoke__\">config</span>(<span class=\"hljs-string\">'app.pagination'</span>));\n}\n</code></pre>","children":[]},{"content":"<pre data-lines=\"3544,3545\"><code>Ajout du bouton dans navigation/navbar :\n</code></pre>","children":[],"payload":{"lines":"3544,3545"}},{"content":"<pre><code class=\"language-php\">        ...\n        @auth\n            @if ($user-&gt;favoritePosts()-&gt;exists())\n                &lt;a title=\"{{ __('Your favorites posts') }}\" href=\"{{ route('posts.favorites') }}\"&gt;&lt;x-icon name=\"s-star\"\n                        class=\"w-7 h-7\" /&gt;&lt;/a&gt;\n            @endif\n        @endauth\n        &lt;x-theme-toggle title=\"{{ __('Toggle theme') }}\" class=\"w-4 h-8\" /&gt;\n        &lt;livewire:search /&gt;\n    &lt;/x-slot:actions&gt;\n&lt;/x-nav&gt;\n</code></pre>","children":[]}],"payload":{"lines":"3528,3529","fold":1}},{"content":"Afficher la page Favoris","children":[{"content":"<pre data-lines=\"3564,3568\"><code>- On défini une nouvelle propriété $favorites\n- mount() : On gère le cas où la requête est \"/favorites\" (On met la propriété favorites à true)\n- getPosts() : Si la propriété favorites est à true, on appelle getFavoritePosts(auth()-&gt;user()) \n-Pour le HTML, on adapte alors le titre de la page\n</code></pre>","children":[],"payload":{"lines":"3564,3568"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$favorites</span>     = <span class=\"hljs-literal\">false</span>;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span> = <span class=\"hljs-string\">''</span>, <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$param</span> = <span class=\"hljs-string\">''</span></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;param = <span class=\"hljs-variable\">$param</span>;\n  \n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">request</span>()-&gt;<span class=\"hljs-title function_ invoke__\">is</span>(<span class=\"hljs-string\">'category/*'</span>)) {\n        <span class=\"hljs-variable language_\">$this</span>-&gt;category = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">getCategoryBySlug</span>(<span class=\"hljs-variable\">$slug</span>);\n    } <span class=\"hljs-keyword\">elseif</span> (<span class=\"hljs-title function_ invoke__\">request</span>()-&gt;<span class=\"hljs-title function_ invoke__\">is</span>(<span class=\"hljs-string\">'favorites'</span>)) {\n        <span class=\"hljs-variable language_\">$this</span>-&gt;favorites = <span class=\"hljs-literal\">true</span>;\n    }\n}\n...\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPosts</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">LengthAwarePaginator</span> </span>{\n    ...\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">$this</span>-&gt;favorites) {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$postRepository</span>-&gt;<span class=\"hljs-title function_ invoke__\">getFavoritePosts</span>(<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>());\n    }     \n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$postRepository</span>-&gt;<span class=\"hljs-title function_ invoke__\">getPostsPaginate</span>(<span class=\"hljs-variable\">$this</span>-&gt;category);\n}\n...\n@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$category</span>)\n    &lt;x-header title=<span class=\"hljs-string\">\"{{ __('Posts for category ') }} {{ <span class=\"hljs-subst\">$category</span>-&gt;title }}\"</span> size=<span class=\"hljs-string\">\"text-2xl sm:text-3xl md:text-4xl\"</span> /&gt;\n@<span class=\"hljs-keyword\">elseif</span>(<span class=\"hljs-variable\">$param</span> !== <span class=\"hljs-string\">''</span>)\n    &lt;x-header title=<span class=\"hljs-string\">\"{{ __('Posts for search ') }} '{{ <span class=\"hljs-subst\">$param</span> }}'\"</span> size=<span class=\"hljs-string\">\"text-2xl sm:text-3xl md:text-4xl\"</span> /&gt;\n@<span class=\"hljs-keyword\">elseif</span>(<span class=\"hljs-variable\">$favorites</span>)\n    &lt;x-header title=<span class=\"hljs-string\">\"{{ __('Your favorites posts') }}\"</span> size=<span class=\"hljs-string\">\"text-2xl sm:text-3xl md:text-4xl\"</span> /&gt;\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Your favorites posts\"</span>: <span class=\"hljs-string\">\"Vos articles favoris\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"3560,3561","fold":1}}],"payload":{"lines":"3357,3358","fold":1}},{"content":"Boutons pour scroller (Aller en bas et en haut)","children":[{"content":"<pre data-lines=\"3605,3606\"><code>resources/css/app.css :\n</code></pre>","children":[],"payload":{"lines":"3605,3606"}},{"content":"<pre><code class=\"language-php\">html {\n    scroll-behavior: smooth;\n}\n</code></pre>","children":[]},{"content":"<pre data-lines=\"3613,3614\"><code>posts.show :\n</code></pre>","children":[],"payload":{"lines":"3613,3614"}},{"content":"<pre><code class=\"language-php\">      ...\n\n    &lt;div id=\"top\" class=\"flex justify-end gap-4\"&gt;\n\n        .... (Nouveau x-popover :)\n\n        &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n                &lt;a href=\"#bottom\"&gt;&lt;x-icon name=\"c-arrow-long-down\" /&gt;&lt;/a&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n                @lang('To bottom')\n            &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n    &lt;/div&gt;\n\n    ... (Nouveau div :)\n\n    &lt;div id=\"bottom\" class=\"relative flex justify-end w-full py-5 mx-auto md:px-12 max-w-7xl\"&gt;\n        ...\n        &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n                &lt;a href=\"#top\"&gt;&lt;x-icon name=\"c-arrow-long-up\" /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n                @lang('To up')\n            &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n    &lt;/div&gt;\n\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"To up\"</span>: <span class=\"hljs-string\">\"Vers le haut\"</span>,\n<span class=\"hljs-string\">\"To bottom\"</span>: <span class=\"hljs-string\">\"Vers le bas\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"3603,3604","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-favoris\">https://laravel.sillo.org/posts/mon-cms-les-favoris</a></strong></em>","children":[],"payload":{"lines":"3653,3654"}}],"payload":{"lines":"3355,3356","fold":1}},{"content":"<strong>II / B A C K - O F F I C E &nbsp;:</strong>","children":[],"payload":{"lines":"3655,3656"}},{"content":"- L'administration","children":[{"content":"Gestion des rôles","children":[{"content":"Model User : Admin ou Redac","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">isAdmin</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">bool</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">'admin'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role;\n}\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">isRedac</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">bool</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">'redac'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role;\n}\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">isAdminOrRedac</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">bool</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">'admin'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role || <span class=\"hljs-string\">'redac'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role;\n}\n</code></pre>","children":[]}],"payload":{"lines":"3661,3662","fold":1}},{"content":"Middlewares","children":[{"content":"<strong>admin</strong>","children":[{"content":"<pre><code class=\"language-php\">php artisan make:middleware IsAdmin\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">handle</span>(<span class=\"hljs-params\">Request <span class=\"hljs-variable\">$request</span>, <span class=\"hljs-built_in\">Closure</span> <span class=\"hljs-variable\">$next</span></span>): <span class=\"hljs-title\">Response</span>\n</span>{\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>()) {\n        <span class=\"hljs-title function_ invoke__\">abort</span>(<span class=\"hljs-number\">403</span>);\n    }\n  \n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$next</span>(<span class=\"hljs-variable\">$request</span>);\n}\n</code></pre>","children":[]}],"payload":{"lines":"3679,3680"}},{"content":"<strong>adminOrRedac</strong>","children":[{"content":"<pre><code class=\"language-php\">php artisan make:middleware IsAdminOrRedac\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">handle</span>(<span class=\"hljs-params\">Request <span class=\"hljs-variable\">$request</span>, <span class=\"hljs-built_in\">Closure</span> <span class=\"hljs-variable\">$next</span></span>): <span class=\"hljs-title\">Response</span>\n</span>{\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>() &amp;&amp; !<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isRedac</span>()) {\n        <span class=\"hljs-title function_ invoke__\">abort</span>(<span class=\"hljs-number\">403</span>);\n    }\n  \n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$next</span>(<span class=\"hljs-variable\">$request</span>);\n}\n</code></pre>","children":[]}],"payload":{"lines":"3696,3697"}}],"payload":{"lines":"3677,3678","fold":1}}],"payload":{"lines":"3659,3660"}},{"content":"Tableau de Bord","children":[{"content":"Route","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Http</span>\\<span class=\"hljs-title\">Middleware</span>\\<span class=\"hljs-title\">IsAdminOrRedac</span>;\n...\n<span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/dashboard'</span>, <span class=\"hljs-string\">'admin.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'admin'</span>);\n    });\n});\n</code></pre>","children":[]}],"payload":{"lines":"3715,3716","fold":1}},{"content":"SideBar","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/sidebar --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse Illuminate\\Support\\Facades\\{Auth, Session};\nuse Livewire\\Volt\\Component;\n\nnew class() extends Component {\n  public function logout(): void {\n    Auth::guard('web')-&gt;logout();\n  \n    Session::invalidate();\n    Session::regenerateToken();\n  \n    $this-&gt;redirect('/');\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-menu activate-by-route&gt;\n        &lt;x-menu-separator /&gt;\n        &lt;x-list-item :item=\"Auth::user()\" value=\"name\" sub-value=\"email\" no-separator no-hover class=\"-mx-2 !-my-2 rounded\"&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button icon=\"o-power\" wire:click=\"logout\" class=\"btn-circle btn-ghost btn-xs\"\n                    tooltip-left=\"{{ __('Logout') }}\" no-wire-navigate /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-list-item&gt;\n        &lt;x-menu-separator /&gt;\n        &lt;x-menu-item title=\"{{ __('Dashboard') }}\" icon=\"s-building-office-2\" link=\"{{ route('admin') }}\" /&gt;      \n        &lt;x-menu-item icon=\"m-arrow-right-end-on-rectangle\" title=\"{{ __('Go on site') }}\" link=\"/\" /&gt;\n        &lt;x-menu-item&gt;\n            &lt;x-theme-toggle /&gt;\n        &lt;/x-menu-item&gt;\n    &lt;/x-menu&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"3728,3729","fold":1}},{"content":"Layout","children":[{"content":"<pre data-lines=\"3772,3773\"><code>Créer views/layouts/admin.blade.php :\n</code></pre>","children":[],"payload":{"lines":"3772,3773"}},{"content":"<pre><code class=\"language-php\">&lt;!DOCTYPE html&gt;\n&lt;html lang=\"{{ str_replace('_', '-', app()-&gt;getLocale()) }}\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover\"&gt;\n    &lt;meta name=\"csrf-token\" content=\"{{ csrf_token() }}\"&gt;\n    &lt;title&gt;{{ isset($title) ? $title . ' | ' . config('app.name') : config('app.name') }}&lt;/title&gt;\n\n    @vite(['resources/css/app.css', 'resources/js/app.js'])\n&lt;/head&gt;\n\n&lt;body class=\"min-h-screen font-sans antialiased bg-base-200/50 dark:bg-base-200\"&gt;\n\n    {{-- MAIN --}}\n    &lt;x-main full-width&gt;\n\n        {{-- SIDEBAR --}}\n        &lt;x-slot:sidebar drawer=\"main-drawer\" collapsible class=\"bg-base-100\"&gt;\n            &lt;livewire:admin.sidebar /&gt;\n        &lt;/x-slot:sidebar&gt;\n\n        &lt;x-slot:content&gt;\n            &lt;!-- Drawer toggle for \"main-drawer\" --&gt;\n            &lt;label for=\"main-drawer\" class=\"mr-3 lg:hidden\"&gt;\n                &lt;x-icon name=\"o-bars-3\" class=\"cursor-pointer\" /&gt;\n            &lt;/label&gt;\n            {{ $slot }}\n        &lt;/x-slot:content&gt;\n\n    &lt;/x-main&gt;\n\n    {{--  TOAST area --}}\n    &lt;x-toast /&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>","children":[]}],"payload":{"lines":"3770,3771","fold":1}},{"content":"Composant","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\{Comment, Page, Post, User};\nuse Illuminate\\Database\\Eloquent\\Builder;\nuse Illuminate\\Support\\Facades\\Auth;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Dashboard')] #[Layout('components.layouts.admin')] class extends Component {\n    use Toast;\n  \n    public array $headersPosts;\n    public bool $openGlance = true;\n  \n    public function mount(): void {\n        $this-&gt;headersPosts = [['key' =&gt; 'date', 'label' =&gt; __('Date')], ['key' =&gt; 'title', 'label' =&gt; __('Title')]];\n    }\n  \n    public function deleteComment(Comment $comment): void {\n        $comment-&gt;delete();\n  \n        $this-&gt;warning('Comment deleted', __('Good bye!'), position: 'toast-bottom');\n    }\n  \n    public function with(): array {\n        $user    = Auth::user();\n        $isRedac = $user-&gt;isRedac();\n        $userId  = $user-&gt;id;\n  \n        return [\n            'pages'          =&gt; Page::select('id', 'title', 'slug')-&gt;get(),\n            'posts'          =&gt; Post::select('id', 'title', 'slug', 'user_id', 'created_at', 'updated_at')-&gt;when($isRedac, fn (Builder $q) =&gt; $q-&gt;where('user_id', $userId))-&gt;latest()-&gt;get(),\n            'commentsNumber' =&gt; Comment::when($isRedac, fn (Builder $q) =&gt; $q-&gt;whereRelation('post', 'user_id', $userId))-&gt;count(),\n            'comments'       =&gt; Comment::with('user', 'post:id,title,slug')-&gt;when($isRedac, fn (Builder $q) =&gt; $q-&gt;whereRelation('post', 'user_id', $userId))-&gt;latest()-&gt;take(5)-&gt;get(),\n            'users'          =&gt; User::count(),\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-collapse wire:model=\"openGlance\" class=\"shadow-md\"&gt;\n        &lt;x-slot:heading&gt;\n            @lang('In a glance')\n        &lt;/x-slot:heading&gt;\n        &lt;x-slot:content class=\"flex flex-wrap gap-4\"&gt;\n\n            &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                &lt;x-stat title=\"{{ __('Posts') }}\" description=\"\" value=\"{{ $posts-&gt;count() }}\" icon=\"s-document-text\"\n                    class=\"shadow-hover\" /&gt;\n            &lt;/a&gt;\n\n            @if (Auth::user()-&gt;isAdmin())\n                &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                    &lt;x-stat title=\"{{ __('Pages') }}\" value=\"{{ $pages-&gt;count() }}\" icon=\"s-document\"\n                        class=\"shadow-hover\" /&gt;\n                &lt;/a&gt;\n                &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                    &lt;x-stat title=\"{{ __('Users') }}\" value=\"{{ $users }}\" icon=\"s-user\"\n                        class=\"shadow-hover\" /&gt;\n                &lt;/a&gt;\n            @endif\n            &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                &lt;x-stat title=\"{{ __('Comments') }}\" value=\"{{ $commentsNumber }}\" icon=\"c-chat-bubble-left\"\n                    class=\"shadow-hover\" /&gt;\n            &lt;/a&gt;\n        &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n\n    &lt;br&gt;\n\n    @foreach ($comments as $comment)\n        @if (!$comment-&gt;user-&gt;valid)\n            &lt;x-alert title=\"{!! __('Comment to valid from ') . $comment-&gt;user-&gt;name !!}\" description=\"{!! $comment-&gt;body !!}\" icon=\"c-chat-bubble-left\"\n                class=\"shadow-md alert-warning\"&gt;\n                &lt;x-slot:actions&gt;\n                    &lt;x-button link=\"#\" label=\"{!! __('Show the comments') !!}\" /&gt;\n                &lt;/x-slot:actions&gt;\n            &lt;/x-alert&gt;\n            &lt;br&gt;\n        @endif\n    @endforeach\n\n    &lt;x-collapse class=\"shadow-md\"&gt;\n        &lt;x-slot:heading&gt;\n            @lang('Recent posts')\n        &lt;/x-slot:heading&gt;\n        &lt;x-slot:content&gt;\n            &lt;x-table :headers=\"$headersPosts\" :rows=\"$posts-&gt;take(5)\" striped&gt;\n                @scope('cell_date', $post)\n                    @lang('Created') {{ $post-&gt;created_at-&gt;diffForHumans() }}\n                    @if ($post-&gt;updated_at != $post-&gt;created_at)\n                        &lt;br&gt;\n                        @lang('Updated') {{ $post-&gt;updated_at-&gt;diffForHumans() }}\n                    @endif\n                @endscope\n                @scope('actions', $post)\n                    &lt;x-popover&gt;\n                        &lt;x-slot:trigger&gt;\n                            &lt;x-button icon=\"s-document-text\" link=\"{{ route('posts.show', $post-&gt;slug) }}\" spinner class=\"btn-ghost btn-sm\" /&gt;                          \n                        &lt;/x-slot:trigger&gt;\n                        &lt;x-slot:content class=\"pop-small\"&gt;\n                            @lang('Show post')\n                        &lt;/x-slot:content&gt;\n                    &lt;/x-popover&gt;\n                @endscope\n            &lt;/x-table&gt;\n        &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n\n    &lt;br&gt;\n\n    &lt;x-collapse class=\"shadow-md\"&gt;\n        &lt;x-slot:heading&gt;\n            @lang('Recent Comments')\n        &lt;/x-slot:heading&gt;\n        &lt;x-slot:content&gt;\n            @foreach ($comments as $comment)\n                &lt;x-list-item :item=\"$comment\" no-separator no-hover&gt;\n                    &lt;x-slot:avatar&gt;\n                        &lt;x-avatar :image=\"Gravatar::get($comment-&gt;user-&gt;email)\"&gt;\n                            &lt;x-slot:title&gt;\n                                {{ $comment-&gt;user-&gt;name }}\n                            &lt;/x-slot:title&gt;\n                        &lt;/x-avatar&gt;\n                    &lt;/x-slot:avatar&gt;\n                    &lt;x-slot:value&gt;\n                        @lang ('in post:') {{ $comment-&gt;post-&gt;title }}\n                    &lt;/x-slot:value&gt;\n                    &lt;x-slot:actions&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"c-eye\" link=\"#\" spinner class=\"btn-ghost btn-sm\" /&gt;                       \n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Edit or answer')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"s-document-text\" link=\"{{ route('posts.show', $comment-&gt;post-&gt;slug) }}\" spinner class=\"btn-ghost btn-sm\" /&gt;                     \n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Show post')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-trash\" wire:click=\"deleteComment({{ $comment-&gt;id }})\"\n                                    wire:confirm=\"{{ __('Are you sure to delete this comment?') }}\" \n                                    spinner class=\"text-red-500 btn-ghost btn-sm\" /&gt;                 \n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Delete')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    &lt;/x-slot:actions&gt;\n                &lt;/x-list-item&gt;\n                &lt;p class=\"ml-16\"&gt;{!! Str::words(nl2br($comment-&gt;body), 20, ' ...') !!}&lt;/p&gt;\n                &lt;br&gt;\n            @endforeach\n        &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"3815,3816","fold":1}},{"content":"Traductions Dashboard","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"In a glance\"</span>: <span class=\"hljs-string\">\"En un coup d'oeil\"</span>,\n<span class=\"hljs-string\">\"Recent posts\"</span>: <span class=\"hljs-string\">\"Articles récents\"</span>,\n<span class=\"hljs-string\">\"Users\"</span>: <span class=\"hljs-string\">\"Utilisateurs\"</span>,\n<span class=\"hljs-string\">\"Dashboard\"</span>: <span class=\"hljs-string\">\"Tableau de bord\"</span>,\n<span class=\"hljs-string\">\"Recent Comments\"</span>: <span class=\"hljs-string\">\"Commentaires récents\"</span>,\n<span class=\"hljs-string\">\"Show post\"</span>: <span class=\"hljs-string\">\"Afficher l'article\"</span>,\n<span class=\"hljs-string\">\"in post:\"</span>: <span class=\"hljs-string\">\"dans l'article :\"</span>,\n<span class=\"hljs-string\">\"Edit or answer\"</span>: <span class=\"hljs-string\">\"Modifier ou répondre\"</span>,\n<span class=\"hljs-string\">\"Posts\"</span>: <span class=\"hljs-string\">\"Articles\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"3987,3988","fold":1}},{"content":"Lien dans les menus","children":[{"content":"Dans navigation.navbar","children":[{"content":"<pre><code class=\"language-php\">&lt;x-slot:actions&gt;\n    &lt;span class=\"hidden sm:block\"&gt;\n        ...\n        @if ($user = auth()-&gt;user())\n            &lt;x-dropdown&gt;\n                ...User name\n                @if ($user-&gt;isAdminOrRedac())\n                    &lt;x-menu-item title=\"{{ __('Administration') }}\" link=\"{{ route('admin') }}\" /&gt;\n                @endif\n                &lt;x-menu-separator /&gt;\n                ... Profile\n                &lt;x-menu-separator /&gt;\n                ... Logout\n            &lt;/x-dropdown&gt;\n        @else ...\n</code></pre>","children":[]}],"payload":{"lines":"4003,4004"}},{"content":"Dans navigation.sidebar","children":[{"content":"<pre><code class=\"language-php\">    ... Logout\n    &lt;/x-<span class=\"hljs-keyword\">list</span>-item&gt;\n    @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$user</span>-&gt;<span class=\"hljs-title function_ invoke__\">isAdminOrRedac</span>())\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Administration') }}\"</span> icon=<span class=\"hljs-string\">\"s-building-office-2\"</span> link=<span class=\"hljs-string\">\"{{ route('admin') }}\"</span> /&gt;\n    @<span class=\"hljs-keyword\">endif</span>\n    &lt;x-menu-separator /&gt;\n    ... Profile\n</code></pre>","children":[]}],"payload":{"lines":"4023,4024"}}],"payload":{"lines":"4001,4002","fold":1}},{"content":"Redac &amp; Admin: Redirection lors du login","children":[{"content":"<pre data-lines=\"4037,4038\"><code>Composant auth.login :\n</code></pre>","children":[],"payload":{"lines":"4037,4038"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">login</span>(<span class=\"hljs-params\"></span>) </span>{\n    ...\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>()) {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_ invoke__\">redirect</span>()-&gt;<span class=\"hljs-title function_ invoke__\">intended</span>(<span class=\"hljs-string\">'/admin/dashboard'</span>);\n    }\n    ... <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">redirectIntended</span>()...\n}\n</code></pre>","children":[]}],"payload":{"lines":"4035,4036","fold":1}}],"payload":{"lines":"3713,3714"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-ladministration\">https://laravel.sillo.org/posts/mon-cms-ladministration</a></strong></em>","children":[],"payload":{"lines":"4049,4050"}}],"payload":{"lines":"3657,3658","fold":1}},{"content":"- Les Articles","children":[{"content":"Tableau des articles","children":[{"content":"Route Articles","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        ...\n        <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/posts/index'</span>, <span class=\"hljs-string\">'admin.posts.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.index'</span>);\n  });\n});\n</code></pre>","children":[]}],"payload":{"lines":"4055,4056","fold":1}},{"content":"Navigation Articles","children":[{"content":"<pre data-lines=\"4069,4070\"><code>Lien des articles dans dashboard (Pavé 'En un coup d'oeil') :\n</code></pre>","children":[],"payload":{"lines":"4069,4070"}},{"content":"<pre><code class=\"language-php\">... admin.index, pavé Posts\n&lt;a href=\"{{ route('posts.index') }}\" class=\"flex-grow\" title=\"{{ __('All posts') }}\"&gt;\n    &lt;x-stat title=\"{{ __('Posts') }}\" description=\"\" value=\"{{ $posts-&gt;count() }}\" icon=\"s-document-text\" class=\"shadow-hover\" /&gt;\n&lt;/a&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"4078,4079\"><code>Lien des articles dans admin/sidebar :\n</code></pre>","children":[],"payload":{"lines":"4078,4079"}},{"content":"<pre><code class=\"language-php\">... Lien Dashboard\n&lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Posts') }}\"</span> icon=<span class=\"hljs-string\">\"s-document-text\"</span>&gt;\n    &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All posts') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('posts.index') }}\"</span> /&gt;\n&lt;/x-menu-sub&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"4087,4088\"><code>lang/fr.json :\n</code></pre>","children":[],"payload":{"lines":"4087,4088"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"All posts\"</span>: <span class=\"hljs-string\">\"Tous les articles\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"4067,4068","fold":1}},{"content":"Composant Articles","children":[{"content":"CLI","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/posts/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"4095,4096","fold":1}},{"content":"Code admin.posts.index","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Mary\\Traits\\Toast;\nuse Livewire\\Volt\\Component;\nuse Livewire\\WithPagination;\nuse App\\Models\\{Post, Category};\nuse Illuminate\\Support\\Facades\\Auth;\nuse App\\Repositories\\PostRepository;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Illuminate\\Pagination\\LengthAwarePaginator;\nuse Illuminate\\Database\\Eloquent\\{Builder, Collection};\n\nnew \n#[Layout('components.layouts.admin'), Title('List Posts')]\nclass extends Component {\n    use Toast, WithPagination;\n\n    public string $search = '';\n    public Collection $categories;\n    public $category_id = 0;\n    public array $sortBy  = ['column' =&gt; 'created_at', 'direction' =&gt; 'desc'];\n\n    public function mount(): void {\n        $this-&gt;categories = $this-&gt;getCategories();\n    }\n\n    public function getCategories(): Collection {\n        if (Auth::user()-&gt;isAdmin()) {\n            return Category::all();\n        }\n      \n        return Category::whereHas('posts', fn (Builder $q) =&gt; $q-&gt;where('user_id', Auth::id()))-&gt;get();\n        }\n      \n    public function headers(): array {\n        $headers = [\n            ['key' =&gt; 'title', 'label' =&gt; __('Title')],\n        ];\n  \n        if (Auth::user()-&gt;isAdmin()) {\n            $headers = array_merge($headers, [['key' =&gt; 'user_name', 'label' =&gt; __('Author')]]);\n        }\n  \n        return array_merge($headers, [\n            ['key' =&gt; 'category_title', 'label' =&gt; __('Category')],\n            ['key' =&gt; 'comments_count', 'label' =&gt; __('')],\n            ['key' =&gt; 'active', 'label' =&gt; __('Published')],\n            ['key' =&gt; 'date', 'label' =&gt; __('Date')],\n      ]);\n      }\n\n    public function posts(): LengthAwarePaginator {\n        return Post::query()\n            -&gt;select('id', 'title', 'slug', 'category_id', 'active', 'user_id', 'created_at', 'updated_at')\n            -&gt;when(Auth::user()-&gt;isAdmin(), fn (Builder $q) =&gt; $q-&gt;withAggregate('user', 'name'))\n            -&gt;when(!Auth::user()-&gt;isAdmin(), fn (Builder $q) =&gt; $q-&gt;where('user_id', Auth::id()))\n            -&gt;withAggregate('category', 'title')\n            -&gt;withcount('comments')\n            -&gt;when($this-&gt;search, fn (Builder $q) =&gt; $q-&gt;where('title', 'like', \"%{$this-&gt;search}%\"))\n            -&gt;when($this-&gt;category_id, fn (Builder $q) =&gt; $q-&gt;where('category_id', $this-&gt;category_id))\n            -&gt;when('date' === $this-&gt;sortBy['column'], fn (Builder $q) =&gt; $q-&gt;orderBy('created_at', $this-&gt;sortBy['direction']), fn (Builder $q) =&gt; $q-&gt;orderBy($this-&gt;sortBy['column'], $this-&gt;sortBy['direction']))\n            -&gt;latest()\n            -&gt;paginate(6);\n    }\n\n    public function deletePost(int $postId): void {\n        $post = Post::findOrFail($postId);\n        $post-&gt;delete();\n        $this-&gt;success(\"{$post-&gt;title} \" . __('deleted'));\n    }\n\n    public function clonePost(int $postId): void {\n        $originalPost       = Post::findOrFail($postId);\n        $clonedPost         = $originalPost-&gt;replicate();\n        $postRepository     = new PostRepository();\n        $clonedPost-&gt;slug   = $postRepository-&gt;generateUniqueSlug($originalPost-&gt;slug);\n        $clonedPost-&gt;active = false;\n        $clonedPost-&gt;save();\n  \n        // Ici on redirigera vers le formulaire de modification de l'article cloné\n    }\n      \n    public function with(): array {\n        return [\n            'headers' =&gt; $this-&gt;headers(),\n            'posts'   =&gt; $this-&gt;posts(),\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Posts') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-input placeholder=\"{{ __('Search...') }}\" wire:model.live.debounce=\"search\" clearable icon=\"o-magnifying-glass\" /&gt;\n            &lt;x-button label=\"{{ __('Add a post') }}\" class=\"btn-outline lg:hidden\" link=\"{{ route('posts.create') }}\" /&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n\n    &lt;x-collapse&gt;\n        &lt;x-slot:heading&gt;\n            @lang(__('Filters'))\n        &lt;/x-slot:heading&gt;\n        &lt;x-slot:content&gt;\n            &lt;x-select label=\"{{ __('Category') }}\" :options=\"$categories\" placeholder=\"{{ __('Select a category') }}\"\n                option-label=\"title\" wire:model=\"category_id\" wire:change=\"$refresh\" /&gt;\n        &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n  \n    &lt;br&gt;\n\n    @if ($posts-&gt;count() &gt; 0)\n        &lt;x-card&gt;\n            &lt;x-table striped :headers=\"$headers\" :rows=\"$posts\" :sort-by=\"$sortBy\" link=\"#\" with-pagination&gt;\n\n                @scope('header_comments_count', $header)\n                    {{ $header['label'] }}\n                    &lt;x-icon name=\"c-chat-bubble-left\" /&gt;\n                @endscope\n\n                @scope('cell_comments_count', $post)\n                    @if ($post-&gt;comments_count &gt; 0)\n                        &lt;x-badge value=\"{{ $post-&gt;comments_count }}\" class=\"badge-primary\" /&gt;\n                    @endif\n                @endscope\n\n                @scope('cell_active', $post)\n                    @if ($post-&gt;active)\n                        &lt;x-icon name=\"o-check-circle\" /&gt;\n                    @endif\n                @endscope\n\n                @scope('cell_date', $post)\n                    @lang('Created') {{ $post-&gt;created_at-&gt;diffForHumans() }}\n                    @if ($post-&gt;updated_at != $post-&gt;created_at)\n                        &lt;br&gt;\n                        @lang('Updated') {{ $post-&gt;updated_at-&gt;diffForHumans() }}\n                    @endif\n                @endscope\n\n                @scope('actions', $post)\n                    &lt;div class=\"flex\"&gt;\n                        &lt;x-popover&gt;\n                            &lt;div class=\"flex\"&gt;\n                                &lt;x-slot:trigger&gt;\n                                    &lt;x-button icon=\"o-finger-print\" wire:click=\"clonePost({{ $post-&gt;id }})\" spinner\n                                        class=\"btn-ghost btn-sm\" /&gt;\n                                &lt;/x-slot:trigger&gt;\n                                &lt;x-slot:content class=\"pop-small\"&gt;\n                                    @lang('Clone')\n                                &lt;/x-slot:content&gt;\n                            &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-trash\" wire:click=\"deletePost({{ $post-&gt;id }})\"\n                                    wire:confirm=\"{{ __('Are you sure to delete this post?') }}\" spinner\n                                    class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Delete')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    &lt;/div&gt;\n                @endscope\n\n            &lt;/x-table&gt;\n        &lt;/x-card&gt;\n    @endif\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4101,4102","fold":1}},{"content":"Dans PostRepository","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">generateUniqueSlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span></span>): <span class=\"hljs-title\">string</span> </span>{\n    <span class=\"hljs-variable\">$newSlug</span> = <span class=\"hljs-variable\">$slug</span>;\n    <span class=\"hljs-variable\">$counter</span> = <span class=\"hljs-number\">1</span>;\n    <span class=\"hljs-keyword\">while</span> (<span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">where</span>(<span class=\"hljs-string\">'slug'</span>, <span class=\"hljs-variable\">$newSlug</span>)-&gt;<span class=\"hljs-title function_ invoke__\">exists</span>()) {\n        <span class=\"hljs-variable\">$newSlug</span> = <span class=\"hljs-variable\">$slug</span> . <span class=\"hljs-string\">'-'</span> . <span class=\"hljs-variable\">$counter</span>;\n        ++<span class=\"hljs-variable\">$counter</span>;\n  }\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$newSlug</span>;\n}\n</code></pre>","children":[]}],"payload":{"lines":"4275,4276","fold":1}},{"content":"Traductions admin posts list","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Title\"</span>: <span class=\"hljs-string\">\"Titre\"</span>,\n<span class=\"hljs-string\">\"Author\"</span>: <span class=\"hljs-string\">\"Auteur\"</span>,\n<span class=\"hljs-string\">\"Updated\"</span>: <span class=\"hljs-string\">\"Mis à jour\"</span>,\n<span class=\"hljs-string\">\"Category\"</span>: <span class=\"hljs-string\">\"Catégorie\"</span>,\n<span class=\"hljs-string\">\"Published\"</span>: <span class=\"hljs-string\">\"Publié\"</span>,\n<span class=\"hljs-string\">\"Add a post\"</span>: <span class=\"hljs-string\">\"Ajouter un article\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this post?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cet article ?\"</span>,\n<span class=\"hljs-string\">\"deleted\"</span>: <span class=\"hljs-string\">\"supprimé\"</span>,\n<span class=\"hljs-string\">\"Clone\"</span>: <span class=\"hljs-string\">\"Dupliquer\"</span>,\n<span class=\"hljs-string\">\"Filters\"</span>: <span class=\"hljs-string\">\"Filtres\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"4289,4290","fold":1}}],"payload":{"lines":"4093,4094","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-tableau-des-articles\">https://laravel.sillo.org/posts/mon-cms-tableau-des-articles</a></strong></em>","children":[],"payload":{"lines":"4304,4305"}}],"payload":{"lines":"4053,4054"}},{"content":"Créer un article","children":[{"content":"Route admin/posts/create","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        ...\n        <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/posts/create'</span>, <span class=\"hljs-string\">'admin.posts.create'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.create'</span>);\n  });\n});\n</code></pre>","children":[]}],"payload":{"lines":"4308,4309","fold":1}},{"content":"Menu (admin.sidebar)","children":[{"content":"<pre><code class=\"language-php\">&lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Posts') }}\"</span> icon=<span class=\"hljs-string\">\"s-document-text\"</span>&gt;\n    &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All posts') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('posts.index') }}\"</span> /&gt;\n    &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Add a post') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('posts.create') }}\"</span> /&gt;\n&lt;/x-menu-sub&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4320,4321","fold":1}},{"content":"Composant (Formulaire)","children":[{"content":"CLI admin.posts.create","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/posts/create --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"4331,4332","fold":1}},{"content":"Code Création article","children":[{"content":"Base du code","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Livewire\\Volt\\Component;\nuse App\\Models\\Category;\nuse Livewire\\Attributes\\Layout;\n\nnew #[Layout('components.layouts.admin')] \nclass extends Component {\n    public function with(): array {\n      return [\n        'categories' =&gt; Category::orderBy('title')-&gt;get(),\n    ];}\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Add a post') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-form wire:submit=\"save\"&gt;\n            &lt;x-select label=\"{{ __('Category') }}\" option-label=\"title\" :options=\"$categories\" wire:model=\"category_id\"\n                wire:change=\"$refresh\" /&gt;\n            &lt;br&gt;\n            &lt;div class=\"flex gap-6\"&gt;\n                &lt;x-checkbox label=\"{{ __('Published') }}\" wire:model=\"active\" /&gt;\n                &lt;x-checkbox label=\"{{ __('Pinned') }}\" wire:model=\"pinned\" /&gt;\n            &lt;/div&gt;\n            &lt;x-input type=\"text\" wire:model=\"title\" label=\"{{ __('Title') }}\"\n                placeholder=\"{{ __('Enter the title') }}\" wire:change=\"$refresh\" /&gt;\n            &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;\n            {{-- &lt;x-editor wire:model=\"body\" label=\"{{ __('Content') }}\" :config=\"config('tinymce.config')\"\n                folder=\"{{ 'photos/' . now()-&gt;format('Y/m') }}\" /&gt; --}}\n            &lt;x-card title=\"{{ __('SEO') }}\" shadow separator&gt;\n                &lt;x-input placeholder=\"{{ __('Title') }}\" wire:model=\"seo_title\" hint=\"{{ __('Max 70 chars') }}\" /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Description') }}\" wire:model=\"meta_description\"\n                    hint=\"{{ __('Max 160 chars') }}\" rows=\"2\" inline /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Keywords') }}\" wire:model=\"meta_keywords\"\n                    hint=\"{{ __('Keywords separated by comma') }}\" rows=\"1\" inline /&gt;\n            &lt;/x-card&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4339,4340","fold":1}},{"content":"Propriétés - Validation","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Attributes</span>\\{<span class=\"hljs-title\">Layout</span>, <span class=\"hljs-title\">Validate</span>};\n...\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$category_id</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|string|max:16777215'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$body</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|string|max:255'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:255|unique:posts,slug|regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$active</span> = <span class=\"hljs-literal\">false</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$pinned</span> = <span class=\"hljs-literal\">false</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:70'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$seo_title</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:160'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_description</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|regex:/^[A-Za-z0-9-éèàù]{1,50}?(,[A-Za-z0-9-éèàù]{1,50})*$/'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_keywords</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-variable\">$category</span>          = <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">first</span>();\n    <span class=\"hljs-variable language_\">$this</span>-&gt;category_id = <span class=\"hljs-variable\">$category</span>-&gt;id;\n}\n</code></pre>","children":[]}],"payload":{"lines":"4394,4395","fold":1}},{"content":"Update du slug du title","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updatedTitle</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$value</span></span>) </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;slug      = <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">slug</span>(<span class=\"hljs-variable\">$value</span>);\n    <span class=\"hljs-variable language_\">$this</span>-&gt;seo_title = <span class=\"hljs-variable\">$value</span>;\n}\n</code></pre>","children":[]}],"payload":{"lines":"4431,4432","fold":1}},{"content":"Enregistrement","children":[{"content":"<pre><code class=\"language-php\">...\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mary</span>\\<span class=\"hljs-title\">Traits</span>\\<span class=\"hljs-title\">Toast</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\{<span class=\"hljs-title\">Category</span>, <span class=\"hljs-title\">Post</span>};\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Toast</span>;\n    ...\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>) </span>{\n        <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>();\n        <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">create</span>(\n            <span class=\"hljs-variable\">$data</span> + [\n                <span class=\"hljs-string\">'user_id'</span>     =&gt; <span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">id</span>(),\n                <span class=\"hljs-string\">'category_id'</span> =&gt; <span class=\"hljs-variable\">$this</span>-&gt;category_id,\n            ],\n    );\n\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Post added with success.'</span>), <span class=\"hljs-attr\">redirectTo</span>: <span class=\"hljs-string\">'/admin/posts/index'</span>);\n    }\n}\n</code></pre>","children":[]}],"payload":{"lines":"4440,4441","fold":1}}],"payload":{"lines":"4337,4338"}},{"content":"Traductions admin.posts.create","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Select a category\"</span>: <span class=\"hljs-string\">\"Sélectionnez une catégorie\"</span>,\n<span class=\"hljs-string\">\"Pinned\"</span>: <span class=\"hljs-string\">\"Épinglé\"</span>,\n<span class=\"hljs-string\">\"Content\"</span>: <span class=\"hljs-string\">\"Contenu\"</span>,\n<span class=\"hljs-string\">\"META Keywords\"</span>: <span class=\"hljs-string\">\"META mots-clefs\"</span>,\n<span class=\"hljs-string\">\"Keywords separated by comma\"</span>: <span class=\"hljs-string\">\"Mots-clefs séparés par une virgule\"</span>,\n<span class=\"hljs-string\">\"Max 70 chars\"</span>: <span class=\"hljs-string\">\"Max 70 caractères\"</span>,\n<span class=\"hljs-string\">\"Max 160 chars\"</span>: <span class=\"hljs-string\">\"Max 160 caractères\"</span>,\n<span class=\"hljs-string\">\"Enter the title\"</span>: <span class=\"hljs-string\">\"Entrez le titre\"</span>,\n<span class=\"hljs-string\">\"Post added with success.\"</span>: <span class=\"hljs-string\">\"Article ajouté avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"4465,4466","fold":1}}],"payload":{"lines":"4329,4330","fold":1}},{"content":"Éditeur (TinyMCE)","children":[{"content":"Installation hébergée (Usage Illimité → Notre choix)","children":[{"content":"<a href=\"https://www.tiny.cloud/get-tiny\">Télécharger Free TinyMCE</a>","children":[],"payload":{"lines":"4483,4484"}},{"content":"À décompresser dans : ./storage/app/public/scripts","children":[],"payload":{"lines":"4485,4486"}},{"content":"Paramétrages","children":[{"content":"<pre data-lines=\"4489,4490\"><code>./config/tinymce.php :\n</code></pre>","children":[],"payload":{"lines":"4489,4490"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-keyword\">return</span> [\n<span class=\"hljs-string\">'config'</span> =&gt; [\n  <span class=\"hljs-string\">'language'</span>       =&gt; <span class=\"hljs-title function_ invoke__\">env</span>(<span class=\"hljs-string\">'APP_TINYMCE_LOCALE'</span>, <span class=\"hljs-string\">'en_US'</span>),\n  <span class=\"hljs-string\">'plugins'</span>        =&gt; <span class=\"hljs-string\">'codesample fullscreen'</span>,\n  <span class=\"hljs-string\">'toolbar'</span>        =&gt; <span class=\"hljs-string\">'undo redo style | fontfamily fontsize | alignleft aligncenter alignright alignjustify | bullist numlist | copy cut paste pastetext | hr | codesample | link image quicktable | fullscreen'</span>,\n  <span class=\"hljs-string\">'toolbar_sticky'</span> =&gt; <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-string\">'min_height'</span>     =&gt; <span class=\"hljs-number\">1000</span>,\n  <span class=\"hljs-string\">'license_key'</span>    =&gt; <span class=\"hljs-string\">'gpl'</span>,\n  <span class=\"hljs-string\">'valid_elements'</span> =&gt; <span class=\"hljs-string\">'*[*]'</span>,\n  ],\n];\n</code></pre>","children":[]},{"content":"<pre data-lines=\"4506,4507\"><code>Fichier ./.env :\n</code></pre>","children":[],"payload":{"lines":"4506,4507"}},{"content":"<pre><code class=\"language-php\">APP_TINYMCE_LOCALE=fr_FR\n</code></pre>","children":[]}],"payload":{"lines":"4487,4488"}},{"content":"Traductions TinyMCE","children":[{"content":"<a href=\"https://www.tiny.cloud/get-tiny/language-packages\">Récupérer les fichiers de traduction</a>","children":[],"payload":{"lines":"4514,4515"}},{"content":"Les copier dans : ./storage/app/public/scripts/fr_FR.js","children":[],"payload":{"lines":"4515,4517"}}],"payload":{"lines":"4512,4513"}},{"content":"Activation de TinyMCE","children":[{"content":"<pre data-lines=\"4519,4520\"><code>Fichier ./resources\\views\\components\\layouts\\admin.blade.php :\n</code></pre>","children":[],"payload":{"lines":"4519,4520"}},{"content":"<pre><code class=\"language-php\">&lt;script src=<span class=\"hljs-string\">\"{{ asset('storage/scripts/tinymce.min.js') }}\"</span> &gt;&lt;/script&gt;\n... @<span class=\"hljs-title function_ invoke__\">vite</span>(...)\n</code></pre>","children":[]},{"content":"<pre data-lines=\"4526,4527\"><code>Dans la vue du composant admin.posts.create :\n</code></pre>","children":[],"payload":{"lines":"4526,4527"}},{"content":"<pre><code class=\"language-php\">&lt;x-editor wire:model=<span class=\"hljs-string\">\"body\"</span> label=<span class=\"hljs-string\">\"{{ __('Content') }}\"</span> :config=<span class=\"hljs-string\">\"config('tinymce.config')\"</span> folder=<span class=\"hljs-string\">\"{{ 'photos/' . now()-&gt;format('Y/m') }}\"</span> /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4517,4518"}}],"payload":{"lines":"4481,4482","fold":1}},{"content":"Installation CDN (Usage limité: 1000 appels/mois - Mise à jour auto)","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Fichier ./resources\\views\\components\\layouts\\admin.blade.php</span>\n&lt;script src=<span class=\"hljs-string\">\"https://cdn.tiny.cloud/1/YOUR-KEY-HERE/tinymce/6/tinymce.min.js\"</span> referrerpolicy=<span class=\"hljs-string\">\"origin\"</span>&gt;&lt;/script&gt;\n... @<span class=\"hljs-title function_ invoke__\">vite</span>(...)\n</code></pre>","children":[]}],"payload":{"lines":"4532,4533","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://mary-ui.com/docs/components/editor\">https://mary-ui.com/docs/components/editor</a></strong></em>","children":[],"payload":{"lines":"4540,4541"}}],"payload":{"lines":"4479,4480","fold":1}},{"content":"Gestion de l'image","children":[{"content":"Ajout du trait Livewire WithFileUploads","children":[{"content":"<pre data-lines=\"4546,4547\"><code>admin.posts.create :\n</code></pre>","children":[],"payload":{"lines":"4546,4547"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Features</span>\\<span class=\"hljs-title\">SupportFileUploads</span>\\<span class=\"hljs-title\">TemporaryUploadedFile</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">WithFileUploads</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">WithFileUploads</span>, <span class=\"hljs-title\">Toast</span>;\n\n    <span class=\"hljs-meta\">#[Rule</span>(<span class=\"hljs-string\">'required|image|max:2000'</span>)<span class=\"hljs-meta\">]</span>\n    <span class=\"hljs-keyword\">public</span> ?TemporaryUploadedFile <span class=\"hljs-variable\">$photo</span> = <span class=\"hljs-literal\">null</span>;\n</code></pre>","children":[]}],"payload":{"lines":"4544,4545","fold":1}},{"content":"Image / défaut","children":[{"content":"<a href=\"https://laravel.sillo.org/ask.jpg\">Récupérer l'image</a>","children":[],"payload":{"lines":"4562,4563"}},{"content":"À poser dans : ./public/storage/ask.jpg","children":[],"payload":{"lines":"4563,4565"}}],"payload":{"lines":"4560,4561","fold":1}},{"content":"Composant de MaryUI dans le formulaire","children":[{"content":"<pre><code class=\"language-php\">            &lt;x-file wire:model=\"photo\" label=\"{{ __('Featured image') }}\"\n                hint=\"{{ __('Click on the image to modify') }}\" accept=\"image/png, image/jpeg\"&gt;\n                &lt;img src=\"{{ $photo == '' ? '/storage/ask.jpg' : $photo }}\" class=\"h-40\" /&gt;\n            &lt;/x-file&gt;\n            &lt;x-slot:actions&gt;\n                ...\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4565,4566","fold":1}},{"content":"Traductions pour Image","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Featured image\"</span>: <span class=\"hljs-string\">\"Image mise en avant\"</span>,\n<span class=\"hljs-string\">\"Click on the image to modify\"</span>: <span class=\"hljs-string\">\"Cliquez sur cette image pour la modifier\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"4580,4581","fold":1}},{"content":"Save Image","children":[{"content":"<pre data-lines=\"4589,4591\"><code>Par défaut, image temporaire ./storage/app/livewire-tmp\n→ Ajouter :\n</code></pre>","children":[],"payload":{"lines":"4589,4591"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>();\n\n    <span class=\"hljs-variable\">$date</span> = <span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">format</span>(<span class=\"hljs-string\">'Y/m'</span>);\n    <span class=\"hljs-variable\">$path</span> = <span class=\"hljs-variable\">$date</span> . <span class=\"hljs-string\">'/'</span> . <span class=\"hljs-title function_ invoke__\">basename</span>(<span class=\"hljs-variable\">$this</span>-&gt;photo-&gt;<span class=\"hljs-title function_ invoke__\">store</span>(<span class=\"hljs-string\">'photos/'</span> . <span class=\"hljs-variable\">$date</span>, <span class=\"hljs-string\">'public'</span>));\n\n    <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">create</span>(\n        <span class=\"hljs-variable\">$data</span> + [\n            <span class=\"hljs-string\">'user_id'</span>     =&gt; <span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">id</span>(),\n            <span class=\"hljs-string\">'category_id'</span> =&gt; <span class=\"hljs-variable\">$this</span>-&gt;category_id,\n            <span class=\"hljs-string\">'image'</span>       =&gt; <span class=\"hljs-variable\">$path</span>,\n        ],\n    );\n\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Post added with success.'</span>), <span class=\"hljs-attr\">redirectTo</span>: <span class=\"hljs-string\">'/admin/posts/index'</span>);\n}\n</code></pre>","children":[]}],"payload":{"lines":"4587,4588","fold":1}},{"content":"Url des images","children":[{"content":"<pre data-lines=\"4613,4614\"><code>Ajout dans app/helpers.php :\n</code></pre>","children":[],"payload":{"lines":"4613,4614"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">function_exists</span>(<span class=\"hljs-string\">'replaceAbsoluteUrlsWithRelative'</span>)) {\n  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">replaceAbsoluteUrlsWithRelative</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$content</span></span>) </span>{\n      <span class=\"hljs-variable\">$baseUrl</span> = <span class=\"hljs-title function_ invoke__\">url</span>(<span class=\"hljs-string\">'/'</span>);\n  \n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-string\">'/'</span> !== <span class=\"hljs-title function_ invoke__\">substr</span>(<span class=\"hljs-variable\">$baseUrl</span>, -<span class=\"hljs-number\">1</span>)) {\n          <span class=\"hljs-variable\">$baseUrl</span> .= <span class=\"hljs-string\">'/'</span>;\n      }\n    \n      <span class=\"hljs-variable\">$pattern</span>     = <span class=\"hljs-string\">'/&lt;img\\s+[^&gt;]*src=\"(?:https?:\\/\\/)?'</span> . <span class=\"hljs-title function_ invoke__\">preg_quote</span>(<span class=\"hljs-title function_ invoke__\">parse_url</span>(<span class=\"hljs-variable\">$baseUrl</span>, PHP_URL_HOST), <span class=\"hljs-string\">'/'</span>) . <span class=\"hljs-string\">'\\/([^\"]+)\"/i'</span>;\n      <span class=\"hljs-variable\">$replacement</span> = <span class=\"hljs-string\">'&lt;img src=\"/$1\"'</span>;\n  \n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_ invoke__\">preg_replace</span>(<span class=\"hljs-variable\">$pattern</span>, <span class=\"hljs-variable\">$replacement</span>, <span class=\"hljs-variable\">$content</span>);\n  }\n}\n</code></pre>","children":[]},{"content":"<pre data-lines=\"4632,4633\"><code>Adaptation de save() :\n</code></pre>","children":[],"payload":{"lines":"4632,4633"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>) </span>{\n   ...\n    <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>] = <span class=\"hljs-title function_ invoke__\">replaceAbsoluteUrlsWithRelative</span>(<span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>]);\n \n    <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">create</span>(\n    ...\n}\n</code></pre>","children":[]}],"payload":{"lines":"4611,4612","fold":1}}],"payload":{"lines":"4542,4543","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-creer-un-article\">https://laravel.sillo.org/posts/mon-cms-creer-un-article</a></strong></em>","children":[],"payload":{"lines":"4644,4645"}}],"payload":{"lines":"4306,4307"}},{"content":"Modifier un article","children":[{"content":"Route posts.edit","children":[{"content":"<pre data-lines=\"4650,4651\"><code>Dans le groupe du middleware 'IsAdminOrRedac' :\n</code></pre>","children":[],"payload":{"lines":"4650,4651"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/posts/{post:slug}/edit'</span>, <span class=\"hljs-string\">'admin.posts.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"4648,4649","fold":1}},{"content":"Lien dans tableau des articles (admin.posts.index)","children":[{"content":"<pre><code class=\"language-php\">&lt;x-table striped :headers=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$headers</span>\"</span> :rows=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$posts</span>\"</span> :sort-by=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$sortBy</span>\"</span> link=<span class=\"hljs-string\">\"/admin/posts/{slug}/edit\"</span> with-pagination&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4656,4657","fold":1}},{"content":"Composant édition articles admin.posts.edit","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/posts/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"4662,4663","fold":1}},{"content":"La logique admin.posts.edit","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\{<span class=\"hljs-title\">Category</span>, <span class=\"hljs-title\">Post</span>};\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Collection</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Facades</span>\\<span class=\"hljs-title\">Storage</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Str</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Validation</span>\\<span class=\"hljs-title\">Rule</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Attributes</span>\\{<span class=\"hljs-title\">Layout</span>, <span class=\"hljs-title\">Title</span>};\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Features</span>\\<span class=\"hljs-title\">SupportFileUploads</span>\\<span class=\"hljs-title\">TemporaryUploadedFile</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Volt</span>\\<span class=\"hljs-title\">Component</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">WithFileUploads</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mary</span>\\<span class=\"hljs-title\">Traits</span>\\<span class=\"hljs-title\">Toast</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Title</span>(<span class=\"hljs-string\">'Edit Post'</span>), <span class=\"hljs-meta\">Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">WithFileUploads</span>, <span class=\"hljs-title\">Toast</span>;\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$postId</span>;\n  <span class=\"hljs-keyword\">public</span> ?Collection <span class=\"hljs-variable\">$categories</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$category_id</span>;\n  <span class=\"hljs-keyword\">public</span> Post <span class=\"hljs-variable\">$post</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$body</span>                  = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span>                 = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span>                  = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$active</span>                  = <span class=\"hljs-literal\">false</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$pinned</span>                  = <span class=\"hljs-literal\">false</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$seo_title</span>             = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_description</span>      = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_keywords</span>         = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> ?TemporaryUploadedFile <span class=\"hljs-variable\">$photo</span> = <span class=\"hljs-literal\">null</span>;\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\">Post <span class=\"hljs-variable\">$post</span></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">Auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isRedac</span>() &amp;&amp; <span class=\"hljs-variable\">$post</span>-&gt;user_id !== <span class=\"hljs-title function_ invoke__\">Auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">id</span>()) {\n      <span class=\"hljs-title function_ invoke__\">abort</span>(<span class=\"hljs-number\">403</span>);\n    }\n  \n    <span class=\"hljs-variable language_\">$this</span>-&gt;post = <span class=\"hljs-variable\">$post</span>;\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">fill</span>(<span class=\"hljs-variable\">$this</span>-&gt;post);\n    <span class=\"hljs-variable language_\">$this</span>-&gt;categories = <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'title'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">get</span>();\n  }\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updatedTitle</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$value</span></span>) </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;slug      = <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">slug</span>(<span class=\"hljs-variable\">$value</span>);\n    <span class=\"hljs-variable language_\">$this</span>-&gt;seo_title = <span class=\"hljs-variable\">$value</span>;\n  }\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>) </span>{\n    <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>([\n      <span class=\"hljs-string\">'title'</span>            =&gt; <span class=\"hljs-string\">'required|string|max:255'</span>,\n      <span class=\"hljs-string\">'body'</span>             =&gt; <span class=\"hljs-string\">'required|string|max:16777215'</span>,\n      <span class=\"hljs-string\">'category_id'</span>      =&gt; <span class=\"hljs-string\">'required'</span>,\n      <span class=\"hljs-string\">'photo'</span>            =&gt; <span class=\"hljs-string\">'nullable|image|max:2000'</span>,\n      <span class=\"hljs-string\">'active'</span>           =&gt; <span class=\"hljs-string\">'required'</span>,\n      <span class=\"hljs-string\">'pinned'</span>           =&gt; <span class=\"hljs-string\">'required'</span>,\n      <span class=\"hljs-string\">'slug'</span>             =&gt; [<span class=\"hljs-string\">'required'</span>, <span class=\"hljs-string\">'string'</span>, <span class=\"hljs-string\">'max:255'</span>, <span class=\"hljs-string\">'regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/'</span>, <span class=\"hljs-title class_\">Rule</span>::<span class=\"hljs-title function_ invoke__\">unique</span>(<span class=\"hljs-string\">'posts'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">ignore</span>(<span class=\"hljs-variable\">$this</span>-&gt;post-&gt;id)],\n      <span class=\"hljs-string\">'seo_title'</span>        =&gt; <span class=\"hljs-string\">'required|max:70'</span>,\n      <span class=\"hljs-string\">'meta_description'</span> =&gt; <span class=\"hljs-string\">'required|max:160'</span>,\n      <span class=\"hljs-string\">'meta_keywords'</span>    =&gt; <span class=\"hljs-string\">'required|regex:/^[A-Za-z0-9-éèàù]{1,50}?(,[A-Za-z0-9-éèàù]{1,50})*$/'</span>,\n    ]);\n  \n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">$this</span>-&gt;photo) {\n      <span class=\"hljs-variable\">$date</span>          = <span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">format</span>(<span class=\"hljs-string\">'Y/m'</span>);\n      <span class=\"hljs-variable\">$path</span>          = <span class=\"hljs-variable\">$date</span> . <span class=\"hljs-string\">'/'</span> . <span class=\"hljs-title function_ invoke__\">basename</span>(<span class=\"hljs-variable\">$this</span>-&gt;photo-&gt;<span class=\"hljs-title function_ invoke__\">store</span>(<span class=\"hljs-string\">'photos/'</span> . <span class=\"hljs-variable\">$date</span>, <span class=\"hljs-string\">'public'</span>));\n      <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'image'</span>] = <span class=\"hljs-variable\">$path</span>;\n    }\n  \n    <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>] = <span class=\"hljs-title function_ invoke__\">replaceAbsoluteUrlsWithRelative</span>(<span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>]);\n  \n    <span class=\"hljs-variable language_\">$this</span>-&gt;post-&gt;<span class=\"hljs-title function_ invoke__\">update</span>(\n      <span class=\"hljs-variable\">$data</span> + [\n      <span class=\"hljs-string\">'category_id'</span> =&gt; <span class=\"hljs-variable\">$this</span>-&gt;category_id,\n      ],\n    );\n  \n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Post updated with success.'</span>));\n  }\n}; <span class=\"hljs-meta\">?&gt;</span>\n</code></pre>","children":[]}],"payload":{"lines":"4668,4669","fold":1}},{"content":"Formulaire d'édition","children":[{"content":"<pre><code class=\"language-php\">&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a post') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n\n    &lt;x-card&gt;\n        &lt;x-form wire:submit=\"save\"&gt;\n            &lt;x-select label=\"{{ __('Category') }}\" option-label=\"title\" :options=\"$categories\" wire:model=\"category_id\" wire:change=\"$refresh\" /&gt;\n            &lt;br&gt;\n            &lt;div class=\"flex gap-6\"&gt;\n                &lt;x-checkbox label=\"{{ __('Published') }}\" wire:model=\"active\" /&gt;\n                &lt;x-checkbox label=\"{{ __('Pinned') }}\" wire:model=\"pinned\" /&gt;\n            &lt;/div&gt;\n            &lt;x-input type=\"text\" wire:model=\"title\" label=\"{{ __('Title') }}\"\n                placeholder=\"{{ __('Enter the title') }}\" wire:change=\"$refresh\" /&gt;\n            &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;\n            &lt;x-editor wire:model=\"body\" label=\"{{ __('Content') }}\" :config=\"config('tinymce.config')\"\n                folder=\"{{ 'photos/' . now()-&gt;format('Y/m') }}\" /&gt;\n            &lt;x-card title=\"{{ __('SEO') }}\" shadow separator&gt;\n                &lt;x-input placeholder=\"{{ __('Title') }}\" wire:model=\"seo_title\" hint=\"{{ __('Max 70 chars') }}\" /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Description') }}\" wire:model=\"meta_description\"\n                    hint=\"{{ __('Max 160 chars') }}\" rows=\"2\" inline /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Keywords') }}\" wire:model=\"meta_keywords\"\n                    hint=\"{{ __('Keywords separated by comma') }}\" rows=\"1\" inline /&gt;\n            &lt;/x-card&gt;\n            &lt;x-file wire:model=\"photo\" label=\"{{ __('Featured image') }}\"\n                hint=\"{{ __('Click on the image to modify') }}\" accept=\"image/png, image/jpeg\"&gt;\n                &lt;img src=\"{{ asset('storage/photos/' . $post-&gt;image) }}\" class=\"h-40\" /&gt;\n            &lt;/x-file&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Preview') }}\" icon=\"m-sun\" link=\"{{ '/posts/' . $post-&gt;slug }}\" external\n                    class=\"btn-outline\" /&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4749,4750","fold":1}},{"content":"Traductions Édition","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit a post\"</span>: <span class=\"hljs-string\">\"Modifier un article\"</span>,\n<span class=\"hljs-string\">\"Post updated with success.\"</span>: <span class=\"hljs-string\">\"Article mis à jour avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"4797,4798","fold":1}},{"content":"Bouton édition dans le posts.show","children":[{"content":"HTML","children":[{"content":"<pre><code class=\"language-php\">@auth\n    &lt;x-popover&gt;\n        ...\n    &lt;/x-popover&gt;\n    @if (Auth::user()-&gt;isAdmin() || Auth::user()-&gt;id == $post-&gt;user_id)\n        &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n                &lt;x-button icon=\"c-pencil-square\" link=\"{{ route('posts.edit', $post) }}\" spinner\n                    class=\"btn-ghost btn-sm\" /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n                @lang('Edit this post')\n            &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n    @endif\n@endauth\n</code></pre>","children":[]}],"payload":{"lines":"4806,4807"}},{"content":"Traduction Édition du post","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit this post\"</span>: <span class=\"hljs-string\">\"Modifier cet article\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"4827,4828"}}],"payload":{"lines":"4804,4805","fold":1}},{"content":"Bouton clone dans le posts.show","children":[{"content":"HTML Clone","children":[{"content":"<pre><code class=\"language-php\">@if (Auth::user()-&gt;isAdmin() || Auth::user()-&gt;id == $post-&gt;user_id)\n    &lt;x-popover&gt;\n        ...\n    &lt;/x-popover&gt;\n    &lt;x-popover&gt;\n        &lt;x-slot:trigger&gt;\n            &lt;x-button icon=\"o-finger-print\" wire:click=\"clonePost({{ $post-&gt;id }})\" spinner\n                class=\"btn-ghost btn-sm\" /&gt;\n        &lt;/x-slot:trigger&gt;\n        &lt;x-slot:content class=\"pop-small\"&gt;\n            @lang('Clone this post')\n        &lt;/x-slot:content&gt;\n    &lt;/x-popover&gt;\n@endif\n</code></pre>","children":[]}],"payload":{"lines":"4835,4836","fold":1}},{"content":"Traduction Clone","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Clone this post\"</span>: <span class=\"hljs-string\">\"Dupliquer cet article\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"4854,4855","fold":1}},{"content":"Logique du clonage","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">clonePost</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$postId</span></span>): <span class=\"hljs-title\">void</span>\n</span>{\n    <span class=\"hljs-variable\">$originalPost</span> = <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">findOrFail</span>(<span class=\"hljs-variable\">$postId</span>);\n    <span class=\"hljs-variable\">$clonedPost</span> = <span class=\"hljs-variable\">$originalPost</span>-&gt;<span class=\"hljs-title function_ invoke__\">replicate</span>();\n    <span class=\"hljs-variable\">$postRepository</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">PostRepository</span>();\n    <span class=\"hljs-variable\">$clonedPost</span>-&gt;slug = <span class=\"hljs-variable\">$postRepository</span>-&gt;<span class=\"hljs-title function_ invoke__\">generateUniqueSlug</span>(<span class=\"hljs-variable\">$originalPost</span>-&gt;slug);\n    <span class=\"hljs-variable\">$clonedPost</span>-&gt;active = <span class=\"hljs-literal\">false</span>;\n    <span class=\"hljs-variable\">$clonedPost</span>-&gt;<span class=\"hljs-title function_ invoke__\">save</span>();\n\n    <span class=\"hljs-title function_ invoke__\">redirect</span>()-&gt;<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'posts.edit'</span>, <span class=\"hljs-variable\">$clonedPost</span>-&gt;slug);\n}\n</code></pre>","children":[]}],"payload":{"lines":"4860,4861","fold":1}}],"payload":{"lines":"4833,4834","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-modifier-un-article\">https://laravel.sillo.org/posts/mon-cms-modifier-un-article</a></strong></em>","children":[],"payload":{"lines":"4876,4877"}}],"payload":{"lines":"4646,4647"}}],"payload":{"lines":"4051,4052","fold":1}},{"content":"- Les Catégories","children":[{"content":"Route categories.index","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Http</span>\\<span class=\"hljs-title\">Middleware</span>\\{<span class=\"hljs-title\">IsAdmin</span>, <span class=\"hljs-title\">IsAdminOrRedac</span>};\n...\n<span class=\"hljs-comment\">// Dans le groupe du middleware 'IsAdminOrRedac'</span>\n<span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/categories/index'</span>, <span class=\"hljs-string\">'admin.categories.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'categories.index'</span>);\n});\n</code></pre>","children":[]}],"payload":{"lines":"4880,4881","fold":1}},{"content":"Item dans barre latérale","children":[{"content":"<pre data-lines=\"4893,4894\"><code>HTML Item dans admin.sidebar :\n</code></pre>","children":[],"payload":{"lines":"4893,4894"}},{"content":"<pre><code class=\"language-php\">&lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Posts') }}\"</span> icon=<span class=\"hljs-string\">\"s-document-text\"</span>&gt;\n    ...\n    @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Categories') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('categories.index') }}\"</span> /&gt;\n    @<span class=\"hljs-keyword\">endif</span>\n&lt;/x-menu-sub&gt; \n</code></pre>","children":[]},{"content":"<pre data-lines=\"4904,4905\"><code>Traduction Item :\n</code></pre>","children":[],"payload":{"lines":"4904,4905"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Categories\"</span>: <span class=\"hljs-string\">\"Catégories\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"4891,4892","fold":1}},{"content":"Création composant category.index","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/categories/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"4910,4911","fold":1}},{"content":"Code composant categories.index","children":[{"content":"Code de base","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Livewire\\Volt\\Component;\nuse App\\Models\\Category;\nuse Livewire\\WithPagination;\nuse Livewire\\Attributes\\Layout;\n\nnew #[Layout('components.layouts.admin')] \nclass extends Component {\n    use WithPagination;\n\n    public array $sortBy = ['column' =&gt; 'title', 'direction' =&gt; 'asc'];\n\n    public function headers(): array {\n        return [['key' =&gt; 'title', 'label' =&gt; __('Title')], ['key' =&gt; 'slug', 'label' =&gt; 'Slug']];\n    }\n  \n    public function with(): array {\n        return [\n            'categories' =&gt; Category::orderBy(...array_values($this-&gt;sortBy))-&gt;paginate(10),\n            'headers'    =&gt; $this-&gt;headers(),\n        ];\n    }\n  \n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Categories') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-table striped :headers=\"$headers\" :rows=\"$categories\" :sort-by=\"$sortBy\" link=\"#\"\n            with-pagination&gt;\n        &lt;/x-table&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4918,4919","fold":1}},{"content":"Ajout bouton supprimer catégorie","children":[{"content":"HTML Supprimer catégorie","children":[{"content":"<pre><code class=\"language-php\">&lt;x-table striped :headers=\"$headers\" :rows=\"$categories\" :sort-by=\"$sortBy\" link=\"#\"\n    with-pagination&gt;\n        @scope('actions', $category)\n        &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n                &lt;x-button icon=\"o-trash\" wire:click=\"delete({{ $category-&gt;id }})\"\n                    wire:confirm=\"{{ __('Are you sure to delete this category?') }}\" spinner\n                    class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n                @lang('Delete')\n            &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n    @endscope\n&lt;/x-table&gt;\n</code></pre>","children":[]}],"payload":{"lines":"4963,4964"}},{"content":"Logique Supprimer catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">delete</span>(<span class=\"hljs-params\">Category <span class=\"hljs-variable\">$category</span></span>): <span class=\"hljs-title\">void</span> </span>{\n    <span class=\"hljs-variable\">$category</span>-&gt;<span class=\"hljs-title function_ invoke__\">delete</span>();\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Category deleted with success.'</span>));\n}\n</code></pre>","children":[]}],"payload":{"lines":"4983,4984"}},{"content":"Traduction Supprimer catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Are you sure to delete this category?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cette catégorie ?\"</span>,\n<span class=\"hljs-string\">\"Category deleted with success.\"</span>: <span class=\"hljs-string\">\"Catégorie supprimée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"4992,4993"}}],"payload":{"lines":"4961,4962","fold":1}},{"content":"Formulaire catégorie","children":[{"content":"Composant formulaire creation/modification","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/categories/category-form\n</code></pre>","children":[]}],"payload":{"lines":"5001,5002"}},{"content":"HTML admin/categories/category-form.blade.php","children":[{"content":"<pre><code class=\"language-php\">&lt;x-form wire:submit=\"save\"&gt;\n    &lt;x-input label=\"{{ __('Title') }}\" wire:model.debounce.500ms=\"title\" wire:change=\"$refresh\" /&gt;\n    &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;\n    &lt;x-slot:actions&gt;\n        &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n            class=\"btn-primary\" /&gt;\n    &lt;/x-slot:actions&gt;\n&lt;/x-form&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5007,5008"}},{"content":"Ajout du formulaire Créer catégorie (categories.index)","children":[{"content":"<pre><code class=\"language-php\">    &lt;x-card title=<span class=\"hljs-string\">\"{{ __('Create a new category') }}\"</span>&gt;\n        @<span class=\"hljs-keyword\">include</span>(<span class=\"hljs-string\">'livewire.admin.categories.category-form'</span>)\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5020,5021"}},{"content":"Complément logique validation catégorie","children":[{"content":"<pre><code class=\"language-php\">...\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mary</span>\\<span class=\"hljs-title\">Traits</span>\\<span class=\"hljs-title\">Toast</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Str</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Attributes</span>\\{<span class=\"hljs-title\">Layout</span>, <span class=\"hljs-title\">Validate</span>};\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Toast</span>, <span class=\"hljs-title\">WithPagination</span>;\n    ...\n    <span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:255|unique:categories,title'</span>)<span class=\"hljs-meta\">]</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span> = <span class=\"hljs-string\">''</span>;\n  \n    <span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:255|unique:posts,slug|regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/'</span>)<span class=\"hljs-meta\">]</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span> = <span class=\"hljs-string\">''</span>;\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updatedTitle</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$value</span></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">generateSlug</span>(<span class=\"hljs-variable\">$value</span>);\n    }\n  \n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">generateSlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;slug = <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">of</span>(<span class=\"hljs-variable\">$title</span>)-&gt;<span class=\"hljs-title function_ invoke__\">slug</span>(<span class=\"hljs-string\">'-'</span>);\n    }\n  \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>();\n        <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-variable\">$data</span>);\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Category created with success.'</span>));\n  }\n</code></pre>","children":[]}],"payload":{"lines":"5029,5030"}},{"content":"Traduction Créer catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Create a new category\"</span>: <span class=\"hljs-string\">\"Créer une nouvelle catégorie\"</span>,\n<span class=\"hljs-string\">\"Category created with success.\"</span>: <span class=\"hljs-string\">\"Catégorie créée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5062,5063"}}],"payload":{"lines":"4999,5000","fold":1}}],"payload":{"lines":"4916,4917","fold":1}},{"content":"Modification d'une catégorie","children":[{"content":"Route pour la modification de catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/categories/{category}/edit'</span>, <span class=\"hljs-string\">'admin.categories.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'categories.edit'</span>);\n});\n</code></pre>","children":[]}],"payload":{"lines":"5071,5072"}},{"content":"Lien dans tableau des catégories","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// admin/categories/index</span>\n&lt;x-table striped :headers=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$headers</span>\"</span> :rows=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$categories</span>\"</span> :sort-by=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$sortBy</span>\"</span> link=<span class=\"hljs-string\">\"/admin/categories/{id}/edit\"</span> with-pagination&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5080,5081"}},{"content":"Création du composant modification","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/categories/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"5087,5088"}},{"content":"Code du composant d'édition","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Mary\\Traits\\Toast;\nuse App\\Models\\Category;\nuse Illuminate\\Support\\Str;\nuse Livewire\\Volt\\Component;\nuse Livewire\\Attributes\\Layout;\nuse Illuminate\\Validation\\Rule;\n\nnew #[Layout('components.layouts.admin')] \nclass extends Component {\n  use Toast;\n  \n  public Category $category;\n  public string $title = '';\n  public string $slug  = '';\n  \n  public function mount(Category $category): void {\n    $this-&gt;category = $category;\n    $this-&gt;fill($this-&gt;category-&gt;toArray());\n  }\n  \n  public function updatedTitle($value): void {\n    $this-&gt;generateSlug($value);\n  }\n  \n  public function save(): void {\n    $data = $this-&gt;validate($this-&gt;rules());\n    $this-&gt;category-&gt;update($data);\n    $this-&gt;success(__('Category updated successfully.'), redirectTo: '/admin/categories/index');\n  }\n  \n  protected function rules(): array {\n  return [\n      'title' =&gt; 'required|string|max:255',\n      'slug'  =&gt; ['required', 'string', 'max:255', 'regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/', Rule::unique('categories')-&gt;ignore($this-&gt;category-&gt;id)],\n  ];\n  }\n  \n  private function generateSlug(string $title): void {\n    $this-&gt;slug = Str::of($title)-&gt;slug('-');\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a category') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        @include('livewire.admin.categories.category-form')\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5093,5094","fold":1}},{"content":"Traduction modification de catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Category updated successfully.\"</span>: <span class=\"hljs-string\">\"Catégorie mise à jour avec succès.\"</span>,\n<span class=\"hljs-string\">\"Edit a category\"</span>: <span class=\"hljs-string\">\"Modifier une catégorie\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5152,5153"}}],"payload":{"lines":"5069,5070","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-categories\">https://laravel.sillo.org/posts/mon-cms-les-categories</a></strong></em>","children":[],"payload":{"lines":"5159,5160"}}],"payload":{"lines":"4878,4879","fold":1}},{"content":"- Les Pages","children":[{"content":"Liste des pages","children":[{"content":"Route Pages","children":[{"content":"<pre data-lines=\"5167,5168\"><code>Groupe middleware IsAdminOrRedac &gt; IsAdmin :\n</code></pre>","children":[],"payload":{"lines":"5167,5168"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/pages/index'</span>, <span class=\"hljs-string\">'admin.pages.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'pages.index'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"5165,5166","fold":1}},{"content":"Navigation Pages","children":[{"content":"<pre data-lines=\"5175,5176\"><code>Lien Pages dans le pavé en haut du dashboard (admin.index) :\n</code></pre>","children":[],"payload":{"lines":"5175,5176"}},{"content":"<pre><code class=\"language-php\"> &lt;a href=\"{{ route('pages.index') }}\" class=\"flex-grow\" title=\"{{ __('All pages') }}\"&gt;\n    &lt;x-stat title=\"{{ __('Pages') }}\" value=\"{{ $pages-&gt;count() }}\" icon=\"s-document\" class=\"shadow-hover\" /&gt;\n&lt;/a&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"5183,5184\"><code>Lien Pages dans admin.sidebar :\n</code></pre>","children":[],"payload":{"lines":"5183,5184"}},{"content":"<pre><code class=\"language-php\">...&lt;/x-menu-sub&gt;\n@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Pages') }}\"</span> icon=<span class=\"hljs-string\">\"s-document\"</span>&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All pages') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('pages.index') }}\"</span> /&gt;\n    &lt;/x-menu-sub&gt;\n@<span class=\"hljs-keyword\">endif</span>\n...\n</code></pre>","children":[]},{"content":"<pre data-lines=\"5195,5196\"><code>Traduction Pages :\n</code></pre>","children":[],"payload":{"lines":"5195,5196"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"All pages\"</span>: <span class=\"hljs-string\">\"Toutes les pages\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"5173,5174","fold":1}},{"content":"Composant Pages","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/pages/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\Page;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Livewire\\WithPagination;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Pages'), Layout('components.layouts.admin')] \nclass extends Component {\n  use Toast, WithPagination;\n  \n  public function headers(): array {\n    return [\n      ['key' =&gt; 'title',  'label' =&gt; __('Title')],\n      ['key' =&gt; 'slug',   'label' =&gt; 'Slug'],\n      ['key' =&gt; 'active', 'label' =&gt; __('Published')]\n    ];\n  }\n  \n  public function deletePage(Page $page): void {\n    $page-&gt;delete();\n    $this-&gt;success(__('Page deleted'));\n  }\n  \n  public function with(): array {\n    return [\n      'pages'   =&gt; Page::select('id', 'title', 'slug', 'active')-&gt;get(),\n      'headers' =&gt; $this-&gt;headers(),\n    ];\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Pages') }}\" separator progress-indicator &gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n            &lt;x-button icon=\"c-document-plus\" label=\"{{ __('Add a page') }}\" class=\"btn-outline\"\n                link=\"#\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n\n    &lt;x-card&gt;\n        &lt;x-table striped :headers=\"$headers\" :rows=\"$pages\" link=\"#\"&gt;\n            @scope('cell_active', $page)\n                @if ($page-&gt;active)\n                    &lt;x-icon name=\"o-check-circle\" /&gt;\n                @endif\n            @endscope\n            @scope('actions', $page)\n                &lt;x-popover&gt;\n                    &lt;x-slot:trigger&gt;\n                        &lt;x-button icon=\"o-trash\" wire:click=\"deletePage({{ $page-&gt;id }})\"\n                            wire:confirm=\"{{ __('Are you sure to delete this page?') }}\" spinner\n                            class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                    &lt;/x-slot:trigger&gt;\n                    &lt;x-slot:content class=\"pop-small\"&gt;\n                        @lang('Delete')\n                    &lt;/x-slot:content&gt;\n                &lt;/x-popover&gt;\n            @endscope\n        &lt;/x-table&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"All pages\"</span>: <span class=\"hljs-string\">\"Toutes les pages\"</span>,\n<span class=\"hljs-string\">\"Add a page\"</span>: <span class=\"hljs-string\">\"Ajouter une page\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this page?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cette page ?\"</span>,\n<span class=\"hljs-string\">\"Page deleted\"</span>: <span class=\"hljs-string\">\"Page effacée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5201,5202","fold":1}}],"payload":{"lines":"5163,5164","fold":1}},{"content":"Création pages","children":[{"content":"Route Ajouter Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Groupe middleware IsAdminOrRedac &gt; IsAdmin</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/pages/create'</span>, <span class=\"hljs-string\">'admin.pages.create'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'pages.create'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"5283,5284","fold":1}},{"content":"Liens Ajouter Pages","children":[{"content":"<pre data-lines=\"5292,5293\"><code>admin.pages.index :\n</code></pre>","children":[],"payload":{"lines":"5292,5293"}},{"content":"<pre><code class=\"language-php\">&lt;x-button icon=\"c-document-plus\" label=\"{{ __('Add a page') }}\" class=\"btn-outline\" link=\"{{ route('pages.create') }}\" /&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"5298,5299\"><code>admin.sidebar :\n</code></pre>","children":[],"payload":{"lines":"5298,5299"}},{"content":"<pre><code class=\"language-php\">@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Pages') }}\"</span> icon=<span class=\"hljs-string\">\"s-document\"</span>&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All pages') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('pages.index') }}\"</span> /&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Add a page') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('pages.create') }}\"</span> /&gt;\n    &lt;/x-menu-sub&gt;\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"5290,5291","fold":1}},{"content":"Formulaire Pages (Création &amp; modification)","children":[{"content":"<pre data-lines=\"5311,5312\"><code>Créer pages/page-form.blade.php :\n</code></pre>","children":[],"payload":{"lines":"5311,5312"}},{"content":"<pre><code class=\"language-php\">&lt;x-card&gt;\n    &lt;x-form wire:submit=\"save\"&gt;\n        &lt;x-input type=\"text\" wire:model=\"title\" label=\"{{ __('Title') }}\"\n            placeholder=\"{{ __('Enter the title') }}\" wire:change=\"$refresh\" /&gt;\n        &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;&lt;br&gt;\n        &lt;x-checkbox label=\"{{ __('Published') }}\" wire:model=\"active\" /&gt;&lt;br&gt;\n        &lt;x-editor wire:model=\"body\" label=\"{{ __('Content') }}\" :config=\"config('tinymce.config')\"\n            folder=\"{{ 'photos/' . now()-&gt;format('Y/m') }}\" /&gt;\n        &lt;x-card title=\"{{ __('SEO') }}\" shadow separator&gt;\n            &lt;x-input placeholder=\"{{ __('Title') }}\" wire:model=\"seo_title\" hint=\"{{ __('Max 70 chars') }}\" /&gt;\n            &lt;br&gt;\n            &lt;x-textarea label=\"{{ __('META Description') }}\" wire:model=\"meta_description\"\n                hint=\"{{ __('Max 160 chars') }}\" rows=\"2\" inline /&gt;\n            &lt;br&gt;\n            &lt;x-textarea label=\"{{ __('META Keywords') }}\" wire:model=\"meta_keywords\"\n                hint=\"{{ __('Keywords separated by comma') }}\" rows=\"1\" inline /&gt;\n        &lt;/x-card&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                class=\"btn-primary\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-form&gt;\n&lt;/x-card&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5309,5310","fold":1}},{"content":"CLI Creation Pages","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/pages/create --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"5339,5340","fold":1}},{"content":"Code composant Créer Pages","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\Page;\nuse illuminate\\Support\\Str;\nuse Livewire\\Attributes\\{Layout, Validate, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Create Page'), Layout('components.layouts.admin')] \nclass extends Component {\n    use Toast;\n  \n    #[Validate('required|max:65000')]\n    public string $body = '';\n  \n    #[Validate('required|max:255')]\n    public string $title = '';\n  \n    #[Validate('required|max:255|unique:posts,slug|regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/')]\n    public string $slug = '';\n  \n    #[Validate('required')]\n    public bool $active = false;\n  \n    #[Validate('required|max:70')]\n    public string $seo_title = '';\n  \n    #[Validate('required|max:160')]\n    public string $meta_description = '';\n  \n    #[Validate('required|regex:/^[A-Za-z0-9-éèàù]{1,50}(, ?[A-Za-z0-9-éèàù]{1,50})*$/')]\n    public string $meta_keywords = '';\n  \n    public function updatedTitle($value): void {\n        $this-&gt;generateSlug($value);\n        $this-&gt;seo_title = $value;\n    }\n  \n    public function save() {\n        $data = $this-&gt;validate();\n        Page::create($data);\n        $this-&gt;success(__('Page added with success.'), redirectTo: '/admin/pages/index');\n    }\n  \n    private function generateSlug(string $title): void {\n        $this-&gt;slug = Str::of($title)-&gt;slug('-');\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Add a page') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    @include('livewire.admin.pages.page-form')\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5345,5346","fold":1}},{"content":"Traduction Ajouter Pages &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Page added with success.\"</span>: <span class=\"hljs-string\">\"Page ajoutée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5407,5408"}}],"payload":{"lines":"5281,5282","fold":1}},{"content":"Modification (édition) pages","children":[{"content":"Route Éditer Pages","children":[{"content":"<pre data-lines=\"5417,5418\"><code>Groupe middleware IsAdminOrRedac &gt; IsAdmin :\n</code></pre>","children":[],"payload":{"lines":"5417,5418"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/pages/{page:slug}/edit'</span>, <span class=\"hljs-string\">'admin.pages.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'pages.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"5415,5416","fold":1}},{"content":"Lien Éditer Pages","children":[{"content":"<pre data-lines=\"5425,5426\"><code>admin.pages.index :\n</code></pre>","children":[],"payload":{"lines":"5425,5426"}},{"content":"<pre><code class=\"language-php\">&lt;x-table striped :headers=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$headers</span>\"</span> :rows=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$pages</span>\"</span> link=<span class=\"hljs-string\">\"/admin/pages/{slug}/edit\"</span>&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5423,5424","fold":1}},{"content":"CLI édition Pages","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/pages/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"5431,5432","fold":1}},{"content":"Code Éditer Pages","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\Page;\nuse illuminate\\Support\\Str;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Edit Page'), Layout('components.layouts.admin')] \nclass extends Component {\n    use Toast;\n  \n    public Page $page;\n    public string $body             = '';\n    public string $title            = '';\n    public string $slug             = '';\n    public bool $active             = false;\n    public string $seo_title        = '';\n    public string $meta_description = '';\n    public string $meta_keywords    = '';\n  \n    public function mount(Page $page): void {\n        $this-&gt;page = $page;\n        $this-&gt;fill($this-&gt;page);\n    }\n  \n    public function updatedTitle($value): void {\n        $this-&gt;generateSlug($value);\n    }\n  \n    public function save() {\n        $data = $this-&gt;validate([\n            'title'            =&gt; 'required|string|max:255',\n            'body'             =&gt; 'required|max:65000',\n            'active'           =&gt; 'required',\n            'slug'             =&gt; ['required', 'string', 'max:255', 'regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/', Rule::unique('pages')-&gt;ignore($this-&gt;page-&gt;id)],\n            'seo_title'        =&gt; 'required|max:70',\n            'meta_description' =&gt; 'required|max:160',\n            'meta_keywords'    =&gt; 'required|regex:/^[A-Za-z0-9-éèàù]{1,50}?(,[A-Za-z0-9-éèàù]{1,50})*$/',\n        ]);\n  \n        $this-&gt;page-&gt;update($data);\n      \n        $this-&gt;success(__('Page edited with success.'), redirectTo: '/admin/pages/index');\n    }\n  \n    private function generateSlug(string $title): void {\n        $this-&gt;slug = Str::of($title)-&gt;slug('-');\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a page') }}\" shadow separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    @include('livewire.admin.pages.page-form')\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5437,5438","fold":1}},{"content":"Traduction Éditer Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Page edited with success.\"</span>: <span class=\"hljs-string\">\"Page mise à jour avec succès.\"</span>,\n<span class=\"hljs-string\">\"Edit a page\"</span>: <span class=\"hljs-string\">\"Modifier une page\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5502,5503","fold":1}}],"payload":{"lines":"5413,5414","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-pages\">https://laravel.sillo.org/posts/mon-cms-les-pages</a></strong></em>","children":[],"payload":{"lines":"5509,5510"}}],"payload":{"lines":"5161,5162","fold":1}},{"content":"- Les Comptes (Users)","children":[{"content":"Liste des comptes","children":[{"content":"Route Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/users/index'</span>, <span class=\"hljs-string\">'admin.users.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'users.index'</span>);\n});\n</code></pre>","children":[]}],"payload":{"lines":"5515,5516","fold":1}},{"content":"Liens Comptes","children":[{"content":"<pre data-lines=\"5526,5527\"><code>admin.sidebar :\n</code></pre>","children":[],"payload":{"lines":"5526,5527"}},{"content":"<pre><code class=\"language-php\">@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    ...\n    &lt;x-menu-item icon=<span class=\"hljs-string\">\"s-user\"</span> title=<span class=\"hljs-string\">\"{{ __('Accounts') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('users.index') }}\"</span> /&gt;\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]},{"content":"<pre data-lines=\"5535,5536\"><code>admin.index (Pavé) :\n</code></pre>","children":[],"payload":{"lines":"5535,5536"}},{"content":"<pre><code class=\"language-php\">@if (Auth::user()-&gt;isAdmin())\n    ...\n    &lt;a href=\"{{ route('users.index') }}\" class=\"flex-grow\" title=\"{{ __('Users list') }}\"&gt;\n        &lt;x-stat title=\"{{ __('Users') }}\" value=\"{{ $users }}\" icon=\"s-user\" class=\"shadow-hover\" /&gt;\n    &lt;/a&gt;\n@endif\n</code></pre>","children":[]}],"payload":{"lines":"5524,5525","fold":1}},{"content":"Composant Comptes","children":[{"content":"Création composant Comptes","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/users/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"5548,5549","fold":1}},{"content":"Code Comptes","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\User;\nuse Illuminate\\Pagination\\LengthAwarePaginator;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Livewire\\WithPagination;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Users'), Layout('components.layouts.admin')] class extends Component {\n    use Toast;\n    use WithPagination;\n  \n    public string $search = '';\n    public array $sortBy  = ['column' =&gt; 'name', 'direction' =&gt; 'asc'];\n    public string $role   = 'all';\n    public array $roles   = [];\n  \n    public function deleteUser(User $user): void {\n        $user-&gt;delete();\n        $this-&gt;success($user-&gt;name . ' ' . __('deleted'));\n    }\n  \n    // Définir les en-têtes de table.\n    public function headers(): array {\n        $headers = [\n            ['key' =&gt; 'name',  'label' =&gt; __('Name')],\n            ['key' =&gt; 'email', 'label' =&gt; 'E-mail'],\n            ['key' =&gt; 'role',  'label' =&gt; __('Role')],\n            ['key' =&gt; 'valid', 'label' =&gt; __('Valid')],\n        ];\n      \n        if ('user' !== $this-&gt;role) {\n            $headers = array_merge($headers, [\n                ['key' =&gt; 'posts_count', 'label' =&gt; __('Posts')],\n            ]);\n        }\n      \n        return array_merge($headers, [\n            ['key' =&gt; 'comments_count', 'label' =&gt; __('Comments')],\n            ['key' =&gt; 'created_at',     'label' =&gt; __('Registration')],\n      ]);\n    }\n  \n    public function users(): LengthAwarePaginator {\n        $query = User::query()\n            -&gt;when($this-&gt;search, fn ($q) =&gt; $q\n                -&gt;where('name', 'like', \"%{$this-&gt;search}%\")\n                -&gt;orWhere('email', 'like', \"%{$this-&gt;search}%\"))\n            -&gt;when('all' !== $this-&gt;role, fn ($q) =&gt; $q\n                -&gt;where('role', $this-&gt;role))\n            -&gt;withCount('posts', 'comments')\n            -&gt;orderBy(...array_values($this-&gt;sortBy));\n      \n        $users = $query-&gt;paginate(10);\n      \n        $userCountsByRole = User::selectRaw('role, count(*) as total')\n            -&gt;groupBy('role')\n            -&gt;pluck('total', 'role');\n      \n        $totalUsers = $userCountsByRole-&gt;sum();\n      \n        $this-&gt;roles = collect([\n            'all'   =&gt; __('All') . \" ({$totalUsers})\",\n            'admin' =&gt; __('Administrators'),\n            'redac' =&gt; __('Redactors'),\n            'user'  =&gt; __('Users'),\n        ])\n        -&gt;map(function ($roleName, $roleId) use ($userCountsByRole) {\n            $count = $userCountsByRole-&gt;get($roleId, 0);\n      \n            return [\n                'name' =&gt; 'all' === $roleId ? $roleName : \"{$roleName} ({$count})\",\n                'id'   =&gt; $roleId,\n            ];\n        })\n        -&gt;values()\n        -&gt;all();\n  \n        return $users;\n    }\n  \n        public function with(): array {\n            return [\n                'users'   =&gt; $this-&gt;users(),\n                'headers' =&gt; $this-&gt;headers(),\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header separator progress-indicator&gt;\n        &lt;x-slot:title&gt;\n            &lt;a href=\"/admin/dashboard\" title=\"{{ __('Back to Dashboard') }}\"&gt;\n                {{ __('Users') }}\n            &lt;/a&gt;\n        &lt;/x-slot:title&gt;\n        &lt;x-slot:middle class=\"!justify-end\"&gt;\n            &lt;x-input placeholder=\"{{ __('Search') }}...\" wire:model.live.debounce=\"search\" clearable\n                icon=\"o-magnifying-glass\" /&gt;\n        &lt;/x-slot:middle&gt;\n    &lt;/x-header&gt;\n\n\n    &lt;x-radio inline :options=\"$roles\" wire:model=\"role\" wire:change=\"$refresh\" /&gt;\n    &lt;br&gt;\n\n    &lt;x-card&gt;\n\n        @if (count($users))\n\n            &lt;x-table striped :headers=\"$headers\" :rows=\"$users\" :sort-by=\"$sortBy\" link=\"/admin/users/{id}/edit\"\n                with-pagination&gt;\n                @scope('cell_name', $user)\n                    &lt;x-avatar :image=\"Gravatar::get($user-&gt;email)\"&gt;\n                        &lt;x-slot:title&gt;\n                            {{ $user-&gt;name }}\n                        &lt;/x-slot:title&gt;\n                    &lt;/x-avatar&gt;\n                @endscope\n                @scope('cell_valid', $user)\n                    @if ($user-&gt;valid)\n                        &lt;x-icon name=\"o-check-circle\" /&gt;\n                    @endif\n                @endscope\n                @scope('cell_role', $user)\n                    @if ($user-&gt;role === 'admin')\n                        &lt;x-badge value=\"{{ __('Administrator') }}\" class=\"badge-error\" /&gt;\n                    @elseif($user-&gt;role === 'redac')\n                        &lt;x-badge value=\"{{ __('Redactor') }}\" class=\"badge-warning\" /&gt;\n                    @elseif($user-&gt;role === 'user')\n                        {{ __('User') }}\n                    @endif\n                @endscope\n                @scope('cell_posts_count', $user)\n                    @if ($user-&gt;posts_count &gt; 0)\n                        &lt;x-badge value=\"{{ $user-&gt;posts_count }}\" class=\"badge-primary\" /&gt;\n                    @endif\n                @endscope\n                @scope('cell_comments_count', $user)\n                    @if ($user-&gt;comments_count &gt; 0)\n                        &lt;x-badge value=\"{{ $user-&gt;comments_count }}\" class=\"badge-success\" /&gt;\n                    @endif\n                @endscope\n                @scope('cell_created_at', $user)\n                    {{ $user-&gt;created_at-&gt;isoFormat('LL') }}\n                @endscope\n                @scope('actions', $user)\n                    &lt;div class=\"flex\"&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-envelope\" link=\"mailto:{{ $user-&gt;email }}\" no-wire-navigate spinner\n                                    class=\"text-blue-500 btn-ghost btn-sm\" /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Send an email')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-trash\" wire:click=\"deleteUser({{ $user-&gt;id }})\"\n                                    wire:confirm=\"{{ __('Are you sure to delete this user?') }}\"\n                                    confirm-text=\"Are you sure?\" spinner class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Delete')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    &lt;/div&gt;\n                @endscope\n            &lt;/x-table&gt;\n        @else\n            &lt;p&gt;@lang('No users with these criteria').&lt;/p&gt;\n        @endif\n\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5554,5555","fold":1}},{"content":"Traductions Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Accounts\"</span>: <span class=\"hljs-string\">\"Comptes\"</span>,\n<span class=\"hljs-string\">\"No users with these criteria\"</span>: <span class=\"hljs-string\">\"Aucun utilisateur avec ces critères\"</span>,\n<span class=\"hljs-string\">\"All\"</span>: <span class=\"hljs-string\">\"Tous\"</span>,\n<span class=\"hljs-string\">\"Users list\"</span>: <span class=\"hljs-string\">\"Liste des utilisateurs\"</span>,\n<span class=\"hljs-string\">\"Administrators\"</span>: <span class=\"hljs-string\">\"Administrateurs\"</span>,\n<span class=\"hljs-string\">\"Redactors\"</span>: <span class=\"hljs-string\">\"Rédacteurs\"</span>,\n<span class=\"hljs-string\">\"Administrator\"</span>: <span class=\"hljs-string\">\"Administrateur\"</span>,\n<span class=\"hljs-string\">\"Redactor\"</span>: <span class=\"hljs-string\">\"Rédacteur\"</span>,\n<span class=\"hljs-string\">\"Role\"</span>: <span class=\"hljs-string\">\"Rôle\"</span>,\n<span class=\"hljs-string\">\"Valid\"</span>: <span class=\"hljs-string\">\"Valide\"</span>,\n<span class=\"hljs-string\">\"Valid user\"</span>: <span class=\"hljs-string\">\"Utilisateur validé\"</span>,\n<span class=\"hljs-string\">\"Send an email\"</span>: <span class=\"hljs-string\">\"Envoyer un email\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this user?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cet utilisateur ?\"</span>,\n<span class=\"hljs-string\">\"Registration\"</span>: <span class=\"hljs-string\">\"Inscription\"</span>,\n<span class=\"hljs-string\">\"Back to Dashboard\"</span>: <span class=\"hljs-string\">\"Retour sur le Tableau de Bord\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5735,5736","fold":1}}],"payload":{"lines":"5546,5547","fold":1}}],"payload":{"lines":"5513,5514","fold":1}},{"content":"Modification de comptes","children":[{"content":"Route Modification Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Groupe middleware IsAdminOrRedac &gt; IsAdmin</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/users/{user}/edit'</span>, <span class=\"hljs-string\">'admin.users.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'users.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"5757,5758","fold":1}},{"content":"Lien Modification Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Déjà fait dans affichage de la liste (Composant Comptes) :</span>\n<span class=\"hljs-comment\">// (&lt;x-table striped :headers=\"$headers\" :rows=\"$users\" :sort-by=\"$sortBy\" link=\"/admin/users/{id}/edit\" with-pagination&gt;)</span>\n</code></pre>","children":[]}],"payload":{"lines":"5764,5765","fold":1}},{"content":"Composant Modification Comptes","children":[{"content":"CLI Modification Comptes","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/users/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"5773,5774","fold":1}},{"content":"Code Modification Comptes","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\User;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Edit User'), Layout('components.layouts.admin')]\nclass extends Component {\n    use Toast;\n  \n    public User $user;\n    public string $name  = '';\n    public string $email = '';\n    public string $role  = '';\n    public bool $valid   = false;\n    public bool $isStudent;\n  \n    public function mount(User $user): void {\n        $this-&gt;user = $user;\n        $this-&gt;fill($this-&gt;user);\n    }\n  \n    public function save() {\n        $data = $this-&gt;validate([\n            'name'  =&gt; ['required', 'string', 'max:255'],\n            'email' =&gt; ['required', 'email', Rule::unique('users')-&gt;ignore($this-&gt;user-&gt;id)],\n            'role'  =&gt; ['required', Rule::in(['admin', 'redac', 'user'])],\n            'valid' =&gt; ['required', 'boolean'],\n        ]);\n  \n        $this-&gt;user-&gt;update($data);\n      \n        $this-&gt;success(__('User edited with success.'), redirectTo: '/admin/users/index');\n    }\n  \n    public function with(): array {\n        return [\n            'roles' =&gt; [\n                ['name' =&gt; __('Administrator'), 'id' =&gt; 'admin'],\n                ['name' =&gt; __('Redactor'), 'id' =&gt; 'redac'],\n                ['name' =&gt; __('User'), 'id' =&gt; 'user'],\n            ],\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n  &lt;x-header title=\"{{ __('Edit an account') }}\" separator progress-indicator&gt;\n    &lt;x-slot:actions&gt;\n      &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n        link=\"{{ route('admin') }}\" /&gt;\n    &lt;/x-slot:actions&gt;\n  &lt;/x-header&gt;\n  &lt;x-card&gt;\n    &lt;x-form wire:submit=\"save\"&gt;\n      &lt;x-input label=\"{{ __('Name') }}\" wire:model=\"name\" icon=\"o-user\" inline /&gt;\n      &lt;x-input label=\"{{ __('E-mail') }}\" wire:model=\"email\" icon=\"o-envelope\" inline /&gt;\n      &lt;br&gt;\n      &lt;x-radio label=\"{{ __('User role') }}\" inline label=\"{{ __('Select a role') }}\" :options=\"$roles\"\n        wire:model=\"role\" /&gt;\n      &lt;br&gt;\n      &lt;x-toggle label=\"{{ __('Valid user') }}\" inline wire:model=\"valid\" /&gt;\n      &lt;x-slot:actions&gt;\n        &lt;div class=\"text-right\"&gt;\n          &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\" class=\"btn-primary\" /&gt;\n        &lt;/div&gt;\n      &lt;/x-slot:actions&gt;\n    &lt;/x-form&gt;\n  &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5779,5780","fold":1}},{"content":"Traduction Modification Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit an account\"</span>: <span class=\"hljs-string\">\"Modifier un compte\"</span>,\n<span class=\"hljs-string\">\"Select a role\"</span>: <span class=\"hljs-string\">\"Sélectionnez un rôle\"</span>,\n<span class=\"hljs-string\">\"User edited with success.\"</span>: <span class=\"hljs-string\">\"Utilisateur mis à jour avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5855,5856","fold":1}}],"payload":{"lines":"5771,5772","fold":1}}],"payload":{"lines":"5755,5756","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-comptes\">https://laravel.sillo.org/posts/mon-cms-les-comptes</a></strong></em>","children":[],"payload":{"lines":"5863,5864"}}],"payload":{"lines":"5511,5512","fold":1}},{"content":"- Les Commentaires","children":[{"content":"Liste admin.comments","children":[{"content":"Route admin.comments.index","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        ...\n        <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/comments/index'</span>, <span class=\"hljs-string\">'admin.comments.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'comments.index'</span>);\n    })\n})\n</code></pre>","children":[]}],"payload":{"lines":"5869,5870","fold":1}},{"content":"Liens comments dans admin.sidebars","children":[{"content":"<pre><code class=\"language-php\">@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    ...\n@<span class=\"hljs-keyword\">endif</span>\n&lt;x-menu-item icon=<span class=\"hljs-string\">\"c-chat-bubble-left\"</span> title=<span class=\"hljs-string\">\"{{ __('Comments') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('comments.index') }}\"</span> /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"5881,5882","fold":1}},{"content":"Composant admin.comment","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/comments/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Mary\\Traits\\Toast;\nuse App\\Models\\Comment;\nuse Livewire\\Volt\\Component;\nuse Livewire\\WithPagination;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Illuminate\\Pagination\\LengthAwarePaginator;\n\nnew #[Title('Comments'), Layout('components.layouts.admin')] \nclass extends Component {\n    use Toast, WithPagination;\n\n    public string $search = '';\n    public array $sortBy = ['column' =&gt; 'created_at', 'direction' =&gt; 'desc'];\n    public $role = 'all';\n\n    public function deleteComment(Comment $comment): void {\n        $comment-&gt;delete();\n        $this-&gt;success(__('Comment deleted'));\n    }\n\n    public function validComment(Comment $comment): void {\n        $comment-&gt;user-&gt;valid = true;\n        $comment-&gt;user-&gt;save();\n\n        $this-&gt;success(__('Comment validated'));\n    }\n\n    public function headers(): array {\n        return [['key' =&gt; 'user_name', 'label' =&gt; __('Author')], ['key' =&gt; 'body', 'label' =&gt; __('Comment'), 'sortable' =&gt; false], ['key' =&gt; 'post_title', 'label' =&gt; __('Post')], ['key' =&gt; 'created_at', 'label' =&gt; __('Sent on')]];\n    }\n\n    public function comments(): LengthAwarePaginator {\n        return Comment::query()\n            -&gt;when($this-&gt;search, fn($q) =&gt; $q-&gt;where('body', 'like', \"%{$this-&gt;search}%\"))\n            -&gt;when('post_title' === $this-&gt;sortBy['column'], fn($q) =&gt; $q-&gt;join('posts', 'comments.post_id', '=', 'posts.id')-&gt;orderBy('posts.title', $this-&gt;sortBy['direction']), fn($q) =&gt; $q-&gt;orderBy($this-&gt;sortBy['column'], $this-&gt;sortBy['direction']))\n            -&gt;when(Auth::user()-&gt;isRedac(), fn($q) =&gt; $q-&gt;whereRelation('post', 'user_id', Auth::id()))\n            -&gt;with([\n                'user:id,name,email,valid',\n                'post:id,title,slug,user_id',\n            ])\n            -&gt;withAggregate('user', 'name')\n            -&gt;paginate(10);\n    }\n\n    public function with(): array {\n        return [\n            'headers'  =&gt; $this-&gt;headers(),\n            'comments' =&gt; $this-&gt;comments(),\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Comments') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n                link=\"{{ route('admin') }}\" /&gt;\n            &lt;x-input placeholder=\"{{ __('Search...') }}\" wire:model.live.debounce=\"search\" clearable\n                icon=\"o-magnifying-glass\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-table striped :headers=\"$headers\" :rows=\"$comments\" link=\"/admin/comments/{id}/edit\" :sort-by=\"$sortBy\"\n            with-pagination&gt;\n            @scope('cell_created_at', $comment)\n                {{ $comment-&gt;created_at-&gt;isoFormat('LL') }} {{ __('at') }}\n                {{ $comment-&gt;created_at-&gt;isoFormat('HH:mm') }}\n            @endscope\n            @scope('cell_body', $comment)\n                {!! nl2br($comment-&gt;body) !!}\n            @endscope\n            @scope('cell_user_name', $comment)\n                &lt;x-avatar :image=\"Gravatar::get($comment-&gt;user-&gt;email)\"&gt;\n                    &lt;x-slot:title&gt;\n                        {{ $comment-&gt;user-&gt;name }}\n                    &lt;/x-slot:title&gt;\n                &lt;/x-avatar&gt;\n            @endscope\n            @scope('cell_post_title', $comment)\n                {{ $comment-&gt;post-&gt;title }}\n            @endscope\n            @scope('actions', $comment)\n                &lt;div class=\"flex\"&gt;\n                    @if (!$comment-&gt;user-&gt;valid)\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"c-eye\" wire:click=\"validComment({{ $comment-&gt;id }})\"\n                                    wire:confirm=\"{{ __('Are you sure to validate this user for comment?') }}\" spinner\n                                    class=\"text-yellow-500 btn-ghost btn-sm\" /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Validate the user')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    @endif\n                    &lt;x-popover&gt;\n                        &lt;x-slot:trigger&gt;\n                            &lt;x-button icon=\"s-document-text\" link=\"{{ route('posts.show', $comment-&gt;post-&gt;slug) }}\" spinner\n                                class=\"btn-ghost btn-sm\" /&gt;\n                        &lt;/x-slot:trigger&gt;\n                        &lt;x-slot:content class=\"pop-small\"&gt;\n                            @lang('Show post')\n                        &lt;/x-slot:content&gt;\n                    &lt;/x-popover&gt;\n                    &lt;x-popover&gt;\n                        &lt;x-slot:trigger&gt;\n                            &lt;x-button icon=\"o-trash\" wire:click=\"deleteComment({{ $comment-&gt;id }})\"\n                                wire:confirm=\"{{ __('Are you sure to delete this comment?') }}\" spinner\n                                class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                        &lt;/x-slot:trigger&gt;\n                        &lt;x-slot:content class=\"pop-small\"&gt;\n                            @lang('Delete')\n                        &lt;/x-slot:content&gt;\n                    &lt;/x-popover&gt;\n                &lt;/div&gt;\n            @endscope\n        &lt;/x-table&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Comment validated\"</span>: <span class=\"hljs-string\">\"Commentaire validé\"</span>,\n<span class=\"hljs-string\">\"Comment deleted\"</span>: <span class=\"hljs-string\">\"Commentaire supprimé\"</span>,\n<span class=\"hljs-string\">\"Sent on\"</span>: <span class=\"hljs-string\">\"Envoyé le\"</span>,\n<span class=\"hljs-string\">\"Post\"</span>: <span class=\"hljs-string\">\"Article\"</span>,\n<span class=\"hljs-string\">\"Are you sure to validate this user for comment?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir valider cet utilisateur pour les commentaires ?\"</span>,\n<span class=\"hljs-string\">\"Validate the user\"</span>: <span class=\"hljs-string\">\"Valider l'utilisateur\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"5890,5891","fold":1}}],"payload":{"lines":"5867,5868","fold":1}},{"content":"Modifier admin.comments","children":[{"content":"Route admin.comments.edit","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        ...\n        <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/comments/{comment}/edit'</span>, <span class=\"hljs-string\">'admin.comments.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'comments.edit'</span>);\n    })\n})\n</code></pre>","children":[]}],"payload":{"lines":"6030,6031","fold":1}},{"content":"Liens modif. admin. Comment","children":[{"content":"<pre data-lines=\"6044,6045\"><code>Pour pavé Commentaires de Dashboard :\n</code></pre>","children":[],"payload":{"lines":"6044,6045"}},{"content":"<pre><code class=\"language-php\">&lt;a href=\"{{ route('comments.index') }}\" class=\"flex-grow\" title=\"{{  __('All comments') }}\"&gt;\n    &lt;x-stat title=\"{{ __('Comments') }}\" value=\"{{ $commentsNumber }}\" icon=\"c-chat-bubble-left\" class=\"shadow-hover\" /&gt;\n&lt;/a&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"6052,6053\"><code>Dans la liste des commentaires récents :\n</code></pre>","children":[],"payload":{"lines":"6052,6053"}},{"content":"<pre><code class=\"language-php\">&lt;x-popover&gt;\n    &lt;x-slot:trigger&gt;\n        &lt;x-button icon=\"c-eye\" link=\"{{ route('comments.edit', $comment-&gt;id) }}\" spinner class=\"btn-ghost btn-sm\" /&gt;                       \n    &lt;/x-slot:trigger&gt;\n    &lt;x-slot:content class=\"pop-small\"&gt;\n        @lang('Edit or answer')\n    &lt;/x-slot:content&gt;\n&lt;/x-popover&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"6065,6067\"><code>Affichage explicite d'une alerte de commentaires à valider :\n(Issu(s) d'users non validés)\n</code></pre>","children":[],"payload":{"lines":"6065,6067"}},{"content":"<pre><code class=\"language-php\">@foreach ($comments as $comment)\n    @if (!$comment-&gt;user-&gt;valid)\n        &lt;x-alert title=\"{!! __('Comment to valid from ') . $comment-&gt;user-&gt;name !!}\" description=\"{!! $comment-&gt;body !!}\" icon=\"c-chat-bubble-left\"\n            class=\"shadow-md alert-warning\"&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button link=\"{{ route('comments.index') }}\" label=\"{!! __('Show the comments') !!}\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-alert&gt;\n        &lt;br&gt;\n    @endif\n@endforeach\n</code></pre>","children":[]}],"payload":{"lines":"6042,6043","fold":1}},{"content":"Pré-requis","children":[{"content":"<pre data-lines=\"6084,6085\"><code>Models/Comment - Ajout de :\n</code></pre>","children":[],"payload":{"lines":"6084,6085"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getDepth</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">int</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-built_in\">parent</span> ? <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-built_in\">parent</span>-&gt;<span class=\"hljs-title function_ invoke__\">getDepth</span>() + <span class=\"hljs-number\">1</span> : <span class=\"hljs-number\">0</span>;\n}\n</code></pre>","children":[]},{"content":"<pre data-lines=\"6092,6093\"><code>Fichier ./config/tinymce.php :\n</code></pre>","children":[],"payload":{"lines":"6092,6093"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">return</span> [\n    <span class=\"hljs-string\">'config'</span> =&gt; [\n        ...\n    ],\n    <span class=\"hljs-string\">'config_comment'</span> =&gt; [\n        <span class=\"hljs-string\">'language'</span>       =&gt; <span class=\"hljs-title function_ invoke__\">env</span>(<span class=\"hljs-string\">'APP_TINYMCE_LOCALE'</span>, <span class=\"hljs-string\">'en_US'</span>),\n        <span class=\"hljs-string\">'plugins'</span>        =&gt; <span class=\"hljs-string\">'codesample'</span>,\n        <span class=\"hljs-string\">'toolbar'</span>        =&gt; <span class=\"hljs-string\">'undo redo | styles | copy cut paste pastetext | hr | codesample'</span>,\n        <span class=\"hljs-string\">'toolbar_sticky'</span> =&gt; <span class=\"hljs-literal\">true</span>,\n        <span class=\"hljs-string\">'min_height'</span>     =&gt; <span class=\"hljs-number\">300</span>,\n        <span class=\"hljs-string\">'license_key'</span>    =&gt; <span class=\"hljs-string\">'gpl'</span>,\n    ],\n];\n</code></pre>","children":[]}],"payload":{"lines":"6082,6083","fold":1}},{"content":"Composant admin.comments.edit","children":[{"content":"<pre data-lines=\"6112,6113\"><code>Création composant admin des commentaires :\n</code></pre>","children":[],"payload":{"lines":"6112,6113"}},{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/comments/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre data-lines=\"6118,6119\"><code>Code composant admin. des modifs. :\n</code></pre>","children":[],"payload":{"lines":"6118,6119"}},{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\Comment;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Edit Comment'), Layout('components.layouts.admin')] \nclass extends Component {\n    use Toast;\n  \n    public Comment $comment;\n    public string $body        = '';\n    public string $body_answer = '';\n    public int $depth          = 0;\n  \n    public function mount(Comment $comment): void {\n        $this-&gt;authorizeCommentAccess($comment);\n  \n        $this-&gt;comment = $comment;\n        $this-&gt;fill($this-&gt;comment-&gt;toArray());\n        $this-&gt;depth = $this-&gt;comment-&gt;getDepth();\n    }\n  \n    public function save() {\n        $data = $this-&gt;validate([\n            'body' =&gt; 'required|max:10000',\n        ]);\n  \n        $this-&gt;comment-&gt;update($data);\n  \n        $this-&gt;success(__('Comment edited with success.'), redirectTo: '/admin/comments/index');\n    }\n  \n    public function saveAnswer() {\n        $data = $this-&gt;validate([\n            'body_answer' =&gt; 'required|max:10000',\n        ]);\n  \n        $data['body']      = $data['body_answer'];\n        $data['user_id']   = Auth::id();\n        $data['parent_id'] = $this-&gt;comment-&gt;id;\n        $data['post_id']   = $this-&gt;comment-&gt;post_id;\n  \n        Comment::create($data);\n  \n        $this-&gt;success(__('Answer created with success.'), redirectTo: '/admin/comments/index');\n    }\n  \n    private function authorizeCommentAccess(Comment $comment): void {\n        if (auth()-&gt;user()-&gt;isRedac() &amp;&amp; $comment-&gt;post-&gt;user_id !== auth()-&gt;id()) {\n          abort(403);\n      }\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a comment') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-form wire:submit=\"save\"&gt;\n            &lt;x-textarea wire:model=\"body\" label=\"{{ __('Content') }}\" hint=\"{{ __('Max 10000 chars') }}\" rows=\"5\"\n                inline /&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Cancel') }}\" icon=\"o-hand-thumb-down\" class=\"btn-outline\"\n                    link=\"/admin/comments/index\" /&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n\n        @if ($depth &lt; 3)\n            &lt;x-card title=\"{{ __('Your answer') }}\" shadow separator progress-indicator&gt;\n                &lt;x-form wire:submit=\"saveAnswer\"&gt;\n                    &lt;x-editor wire:model=\"body_answer\" label=\"{{ __('Content') }}\" :config=\"config('tinymce.config_comment')\" folder=\"photos\" /&gt;\n                    &lt;x-slot:actions&gt;\n                        &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                            class=\"btn-primary\" /&gt;\n                    &lt;/x-slot:actions&gt;\n                &lt;/x-form&gt;\n            &lt;/x-card&gt;\n        @endif\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"6210,6211\"><code>Traductions admin. modif. des commentaires :\n</code></pre>","children":[],"payload":{"lines":"6210,6211"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit a comment\"</span>: <span class=\"hljs-string\">\"Modifier un commentaire\"</span>,\n<span class=\"hljs-string\">\"Your answer\"</span>: <span class=\"hljs-string\">\"Votre réponse\"</span>,\n<span class=\"hljs-string\">\"Comment edited with success.\"</span>: <span class=\"hljs-string\">\"Commentaire mis à jour avec succès.\"</span>,\n<span class=\"hljs-string\">\"Answer created with success.\"</span>: <span class=\"hljs-string\">\"Réponse ajoutée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"6110,6111","fold":1}}],"payload":{"lines":"6028,6029","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-commentaires\">https://laravel.sillo.org/posts/mon-cms-les-commentaires</a></strong></em>","children":[],"payload":{"lines":"6220,6221"}}],"payload":{"lines":"5865,5866","fold":1}},{"content":"- Les Menus","children":[{"content":"Liste des Menus &amp; Submenus","children":[{"content":"Route admin.menus.index","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        ...\n        <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n            ...\n            <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/menus/index'</span>, <span class=\"hljs-string\">'admin.menus.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'menus.index'</span>);\n        });\n    });\n});\n</code></pre>","children":[]}],"payload":{"lines":"6226,6227","fold":1}},{"content":"Lien Menus dans admin.sidebar","children":[{"content":"<pre><code class=\"language-php\">... Lien de comments.index\n@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Menus') }}\"</span> icon=<span class=\"hljs-string\">\"m-list-bullet\"</span>&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Navbar') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('menus.index') }}\"</span> /&gt;\n    &lt;/x-menu-sub&gt;\n... Lien <span class=\"hljs-string\">'Allez sur le site'</span> (/)\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Navbar\"</span>: <span class=\"hljs-string\">\"Navigation\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"6241,6242","fold":1}},{"content":"Trait ManageMenus (Menus &amp; submenus)","children":[{"content":"<pre data-lines=\"6259,6260\"><code>Créer un trait ./app/Traits/ManageMenus.php :\n</code></pre>","children":[],"payload":{"lines":"6259,6260"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title class_\">App</span>\\<span class=\"hljs-title class_\">Traits</span>;\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\{<span class=\"hljs-title\">Category</span>, <span class=\"hljs-title\">Page</span>, <span class=\"hljs-title\">Post</span>};\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Collection</span>;\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">trait</span> <span class=\"hljs-title\">ManageMenus</span>\n</span>{\n    <span class=\"hljs-keyword\">public</span> ?<span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$post_id</span> = <span class=\"hljs-literal\">null</span>;\n    <span class=\"hljs-keyword\">public</span> Collection <span class=\"hljs-variable\">$postsSearchable</span>;\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">search</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$value</span> = <span class=\"hljs-string\">''</span></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-variable\">$selectedOption</span> = <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">select</span>(<span class=\"hljs-string\">'id'</span>, <span class=\"hljs-string\">'title'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">where</span>(<span class=\"hljs-string\">'id'</span>, <span class=\"hljs-variable\">$this</span>-&gt;post_id)-&gt;<span class=\"hljs-title function_ invoke__\">get</span>();\n    \n        <span class=\"hljs-variable language_\">$this</span>-&gt;postsSearchable = <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">query</span>()\n            -&gt;<span class=\"hljs-title function_ invoke__\">select</span>(<span class=\"hljs-string\">'id'</span>, <span class=\"hljs-string\">'title'</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">where</span>(<span class=\"hljs-string\">'title'</span>, <span class=\"hljs-string\">'like'</span>, <span class=\"hljs-string\">\"%<span class=\"hljs-subst\">{$value}</span>%\"</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'title'</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">take</span>(<span class=\"hljs-number\">5</span>)\n            -&gt;<span class=\"hljs-title function_ invoke__\">get</span>()\n            -&gt;<span class=\"hljs-title function_ invoke__\">merge</span>(<span class=\"hljs-variable\">$selectedOption</span>);\n    }\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">changeSelection</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$value</span></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">updateSubProperties</span>([<span class=\"hljs-string\">'model'</span> =&gt; <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-variable language_\">class</span>, <span class=\"hljs-string\">'route'</span> =&gt; <span class=\"hljs-string\">'posts.show'</span>], <span class=\"hljs-variable\">$value</span>);\n    }\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updating</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$property</span>, <span class=\"hljs-variable\">$value</span></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-string\">''</span> === <span class=\"hljs-variable\">$value</span>) {\n            <span class=\"hljs-keyword\">return</span>;\n        }\n    \n        <span class=\"hljs-variable\">$modelMap</span> = [\n            <span class=\"hljs-string\">'subPage'</span>     =&gt; [<span class=\"hljs-string\">'model'</span> =&gt; <span class=\"hljs-title class_\">Page</span>::<span class=\"hljs-variable language_\">class</span>, <span class=\"hljs-string\">'route'</span> =&gt; <span class=\"hljs-string\">'pages.show'</span>],\n            <span class=\"hljs-string\">'subCategory'</span> =&gt; [<span class=\"hljs-string\">'model'</span> =&gt; <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-variable language_\">class</span>, <span class=\"hljs-string\">'route'</span> =&gt; <span class=\"hljs-string\">'category'</span>],\n        ];\n    \n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">array_key_exists</span>(<span class=\"hljs-variable\">$property</span>, <span class=\"hljs-variable\">$modelMap</span>)) {\n            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">updateSubProperties</span>(<span class=\"hljs-variable\">$modelMap</span>[<span class=\"hljs-variable\">$property</span>], <span class=\"hljs-variable\">$value</span>);\n        } <span class=\"hljs-keyword\">elseif</span> (<span class=\"hljs-string\">'subOption'</span> === <span class=\"hljs-variable\">$property</span>) {\n            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">resetSubProperties</span>();\n            <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">search</span>();\n        }\n    }\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">with</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">array</span> </span>{\n        <span class=\"hljs-keyword\">return</span> [\n            <span class=\"hljs-string\">'pages'</span>      =&gt; <span class=\"hljs-title class_\">Page</span>::<span class=\"hljs-title function_ invoke__\">select</span>(<span class=\"hljs-string\">'id'</span>, <span class=\"hljs-string\">'title'</span>, <span class=\"hljs-string\">'slug'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">get</span>(),\n            <span class=\"hljs-string\">'categories'</span> =&gt; <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">all</span>(),\n            <span class=\"hljs-string\">'subOptions'</span> =&gt; [[<span class=\"hljs-string\">'id'</span> =&gt; <span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">'name'</span> =&gt; <span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Post'</span>)], [<span class=\"hljs-string\">'id'</span> =&gt; <span class=\"hljs-number\">2</span>, <span class=\"hljs-string\">'name'</span> =&gt; <span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Page'</span>)], [<span class=\"hljs-string\">'id'</span> =&gt; <span class=\"hljs-number\">3</span>, <span class=\"hljs-string\">'name'</span> =&gt; <span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Category'</span>)]],\n        ];\n    }\n    \n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updateSubProperties</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$modelInfo</span>, <span class=\"hljs-variable\">$value</span></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-variable\">$model</span> = <span class=\"hljs-variable\">$modelInfo</span>[<span class=\"hljs-string\">'model'</span>]::<span class=\"hljs-title function_ invoke__\">find</span>(<span class=\"hljs-variable\">$value</span>);\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$model</span>) {\n            <span class=\"hljs-variable language_\">$this</span>-&gt;sublabel = <span class=\"hljs-variable\">$model</span>-&gt;title;\n            <span class=\"hljs-variable language_\">$this</span>-&gt;sublink  = <span class=\"hljs-string\">'posts.show'</span> === <span class=\"hljs-variable\">$modelInfo</span>[<span class=\"hljs-string\">'route'</span>] || <span class=\"hljs-string\">'pages.show'</span> === <span class=\"hljs-variable\">$modelInfo</span>[<span class=\"hljs-string\">'route'</span>]\n                ? <span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-variable\">$modelInfo</span>[<span class=\"hljs-string\">'route'</span>], <span class=\"hljs-variable\">$model</span>-&gt;slug)\n                : <span class=\"hljs-title function_ invoke__\">url</span>(<span class=\"hljs-variable\">$modelInfo</span>[<span class=\"hljs-string\">'route'</span>] . <span class=\"hljs-string\">'/'</span> . <span class=\"hljs-variable\">$model</span>-&gt;slug);\n        }\n    }\n    \n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">resetSubProperties</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span> </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;sublabel    = <span class=\"hljs-string\">''</span>;\n        <span class=\"hljs-variable language_\">$this</span>-&gt;sublink     = <span class=\"hljs-string\">''</span>;\n        <span class=\"hljs-variable language_\">$this</span>-&gt;subPost     = <span class=\"hljs-number\">0</span>;\n        <span class=\"hljs-variable language_\">$this</span>-&gt;subPage     = <span class=\"hljs-number\">0</span>;\n        <span class=\"hljs-variable language_\">$this</span>-&gt;subCategory = <span class=\"hljs-number\">0</span>;\n        <span class=\"hljs-variable language_\">$this</span>-&gt;subOption   = <span class=\"hljs-number\">1</span>;  \n  }\n}\n</code></pre>","children":[]}],"payload":{"lines":"6257,6258","fold":1}},{"content":"Formulaire submenus (Création &amp; Modification)","children":[{"content":"<pre data-lines=\"6338,6339\"><code>Créer admin.menus.submenu-form.blade.php :\n</code></pre>","children":[],"payload":{"lines":"6338,6339"}},{"content":"<pre><code class=\"language-php\">&lt;x-form wire:submit=\"saveSubmenu({{ $menu-&gt;id ?? 'null' }})\"&gt;\n    &lt;x-radio :options=\"$subOptions\" wire:model=\"subOption\" wire:change=\"$refresh\" /&gt;\n    @if ($subOption == 1)\n        &lt;x-choices label=\"{{ __('Post') }}\" wire:model=\"subPost\" :options=\"$postsSearchable\" option-label=\"title\"\n            hint=\"{{ __('Select a post, type to search') }}\" debounce=\"300ms\" min-chars=\"2\"\n            no-result-text=\"{{ __('No result found!') }}\" single searchable @change-selection=\"$wire.changeSelection($event.detail.value)\" /&gt;\n    @elseif($subOption == 2)\n        &lt;x-select label=\"{{ __('Page') }}\" option-label=\"title\" :options=\"$pages\"\n            placeholder=\"{{ __('Select a page') }}\" wire:model=\"subPage\"\n            wire:change=\"$refresh\" /&gt;\n    @elseif($subOption == 3)\n        &lt;x-select label=\"{{ __('Category') }}\" option-label=\"title\" :options=\"$categories\"\n            placeholder=\"{{ __('Select a category') }}\" wire:model=\"subCategory\"\n            wire:change=\"$refresh\" /&gt;\n    @endif\n    &lt;x-input label=\"{{ __('Title') }}\" wire:model=\"sublabel\" /&gt;\n    &lt;x-input type=\"text\" wire:model=\"sublink\" label=\"{{ __('Link') }}\" /&gt;\n    &lt;x-slot:actions&gt;\n        &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\"\n            type=\"submit\" class=\"btn-primary\" /&gt;\n    &lt;/x-slot:actions&gt;\n&lt;/x-form&gt;\n</code></pre>","children":[]}],"payload":{"lines":"6336,6337","fold":1}},{"content":"Composant Liste des Menus (admin.menus.index)","children":[{"content":"Création admin.menus.index","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/menus/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"6367,6368","fold":1}},{"content":"Code admin.menus.index","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Mary\\Traits\\Toast;\nuse App\\Traits\\ManageMenus;\nuse Livewire\\Volt\\Component;\nuse App\\Models\\{Menu, Submenu};\nuse Illuminate\\Support\\Collection;\nuse Livewire\\Attributes\\{Layout, Title, Validate};\nuse Illuminate\\Contracts\\Database\\Eloquent\\Builder;\n\nnew #[Title('Nav Menu'), Layout('components.layouts.admin')]\nclass extends Component {\n    use Toast;\n    use ManageMenus;\n    \n    public Collection $menus;\n    \n    #[Validate('required|max:255|unique:menus,label')]\n    public string $label = '';\n    \n    #[Validate('nullable|regex:/\\/([a-z0-9_-]\\/*)*[a-z0-9_-]*/')]\n    public string $link = '';\n    \n    public string $sublabel = '';\n    public string $sublink  = '';\n    public int $subPost     = 0;\n    public int $subPage     = 0;\n    public int $subCategory = 0;\n    public int $subOption   = 1;\n    \n    // Méthode appelée lors de l'initialisation du composant.\n    public function mount(): void {\n        $this-&gt;getMenus();\n        $this-&gt;search();\n    }\n    \n    // Récupérer les menus avec leurs sous-menus triés par ordre.\n    public function getMenus(): void {\n        $this-&gt;menus = Menu::with([\n            'submenus' =&gt; function (Builder $query) {\n                $query-&gt;orderBy('order');\n            },\n        ])\n            -&gt;orderBy('order')\n            -&gt;get();\n    }\n    \n    public function up(Menu $menu): void {\n        $this-&gt;move($menu, 'up');\n    }\n    \n    public function upSub(Submenu $submenu): void {\n        $this-&gt;move($submenu, 'up', true);\n    }\n    \n    public function down(Menu $menu): void {\n        $this-&gt;move($menu, 'down');\n    }\n    \n    public function downSub(Submenu $submenu): void {\n        $this-&gt;move($submenu, 'down', true);\n    }\n    \n    public function deleteMenu(Menu $menu): void {\n        $this-&gt;deleteItem($menu);\n    }\n    \n    public function deleteSubmenu(Menu $menu, Submenu $submenu): void {\n        $this-&gt;deleteItem($submenu, $menu);\n    }\n    \n    // Enregistrer un nouveau menu.\n    public function saveMenu(): void {\n        $data          = $this-&gt;validate();\n        $data['order'] = $this-&gt;menus-&gt;count() + 1;\n        Menu::create($data);\n    \n        $this-&gt;success(__('Menu created with success.'), redirectTo: '/admin/menus/index');\n    }\n    \n    // Enregistrer un nouveau sous-menu.\n    public function saveSubmenu(Menu $menu): void {\n        $data = $this-&gt;validate([\n            'sublabel' =&gt; ['required', 'string', 'max:255'],\n            'sublink'  =&gt; 'required|regex:/\\/([a-z0-9_-]\\/*)*[a-z0-9_-]*/',\n        ]);\n    \n        $data['order'] = $menu-&gt;submenus-&gt;count() + 1;\n        $data['label'] = $this-&gt;sublabel;\n        $data['link']  = $this-&gt;sublink;\n    \n        $menu-&gt;submenus()-&gt;save(new Submenu($data));\n    \n        $this-&gt;sublabel = '';\n        $this-&gt;sublink  = '';\n    \n        $this-&gt;success(__('Submenu created with success.'));\n    }\n    \n    // Méthode générique pour déplacer un élément (menu ou sous-menu)\n    private function move($item, $direction, $isSubmenu = false): void {\n        $operator       = 'up' === $direction ? '&lt;' : '&gt;';\n        $orderDirection = 'up' === $direction ? 'desc' : 'asc';\n    \n        $query = $isSubmenu ? Submenu::where('menu_id', $item-&gt;menu_id) : Menu::query();\n    \n        $adjacentItem = $query\n            -&gt;where('order', $operator, $item-&gt;order)\n            -&gt;orderBy('order', $orderDirection)\n            -&gt;first();\n    \n        if ($adjacentItem) {\n            $this-&gt;swap($item, $adjacentItem);\n        }\n    }\n    \n    private function swap($item1, $item2): void {\n        $tempOrder    = $item1-&gt;order;\n        $item1-&gt;order = $item2-&gt;order;\n        $item2-&gt;order = $tempOrder;\n    \n        $item1-&gt;save();\n        $item2-&gt;save();\n    \n        $this-&gt;getMenus();\n    }\n    \n    // Méthode générique pour supprimer un élément (menu ou sous-menu)\n    private function deleteItem($item, $parent = null): void {\n        $isSubmenu = null !== $parent;\n    \n        $item-&gt;delete();\n    \n        if ($isSubmenu) {\n            $this-&gt;reorderItems($parent-&gt;submenus());\n        } else {\n            $this-&gt;reorderItems(Menu::query());\n        }\n    \n        $this-&gt;getMenus();\n        $this-&gt;success(__($isSubmenu ? 'Submenu' : 'Menu') . __(' deleted with success.'));\n    }\n    \n    // Méthode générique pour réordonner les éléments\n    private function reorderItems($query): void {\n        $items = $query-&gt;orderBy('order')-&gt;get();\n        foreach ($items as $index =&gt; $item) {\n            $item-&gt;order = $index + 1;\n            $item-&gt;save();\n        }\n    }\n};?&gt;\n\n&lt;div&gt;\n  &lt;x-header title=\"{{ __('Navigation') }}\" separator progress-indicator&gt;\n    &lt;x-slot:actions class=\"lg:hidden\"&gt;\n      &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n        link=\"{{ route('admin') }}\" /&gt;\n    &lt;/x-slot:actions&gt;\n  &lt;/x-header&gt;\n  &lt;x-card&gt;\n    @foreach ($menus as $menu)\n    &lt;x-list-item :item=\"$menu\" no-separator no-hover&gt;\n      &lt;x-slot:value&gt;\n        {{ $menu-&gt;label }}\n      &lt;/x-slot:value&gt;\n      &lt;x-slot:sub-value&gt;\n        @if ($menu-&gt;link)\n        {{ $menu-&gt;link }}\n        @else\n        @lang('Root menu')\n        @endif\n      &lt;/x-slot:sub-value&gt;\n      &lt;x-slot:actions&gt;\n        @if ($menu-&gt;order &gt; 1)\n        &lt;x-popover&gt;\n          &lt;x-slot:trigger&gt;\n            &lt;x-button icon=\"s-chevron-up\" wire:click=\"up({{ $menu-&gt;id }})\" spinner /&gt;\n          &lt;/x-slot:trigger&gt;\n          &lt;x-slot:content class=\"pop-small\"&gt;\n            @lang('Up')\n          &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n        @endif\n        @if ($menu-&gt;order &lt; $menus-&gt;count())\n          &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n              &lt;x-button icon=\"s-chevron-down\" wire:click=\"down({{ $menu-&gt;id }})\" spinner /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n              @lang('Down')\n            &lt;/x-slot:content&gt;\n          &lt;/x-popover&gt;\n          @endif\n          &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n              &lt;x-button icon=\"c-arrow-path-rounded-square\" link=\"#\" class=\"text-blue-500 btn-ghost btn-sm\" spinner /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n              @lang('Edit')\n            &lt;/x-slot:content&gt;\n          &lt;/x-popover&gt;\n          &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n              &lt;x-button icon=\"o-trash\" wire:click=\"deleteMenu({{ $menu-&gt;id }})\"\n                wire:confirm=\"{{ __('Are you sure to delete this menu?') }}\" spinner\n                class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n              @lang('Delete')\n            &lt;/x-slot:content&gt;\n          &lt;/x-popover&gt;\n      &lt;/x-slot:actions&gt;\n    &lt;/x-list-item&gt;\n\n    &lt;x-collapse collapse-plus-minus no-icon class=\"ml-8\"&gt;\n      &lt;x-slot:heading&gt;\n        &lt;x-icon name=\"o-chevron-down\" /&gt;&lt;span class=\"pl-2 text-sm\"&gt;{{ __('Submenus') }}&lt;/span&gt;\n      &lt;/x-slot:heading&gt;\n      &lt;x-slot:content&gt;\n        @foreach ($menu-&gt;submenus as $submenu)\n        &lt;x-list-item :item=\"$menu\" no-separator no-hover&gt;\n          &lt;x-slot:value&gt;\n            {{ $submenu-&gt;label }}\n          &lt;/x-slot:value&gt;\n          &lt;x-slot:sub-value&gt;\n            {{ $submenu-&gt;link }}\n          &lt;/x-slot:sub-value&gt;\n          &lt;x-slot:actions&gt;\n            @if ($submenu-&gt;order &gt; 1)\n            &lt;x-popover&gt;\n              &lt;x-slot:trigger&gt;\n                &lt;x-button icon=\"s-chevron-up\" wire:click=\"upSub({{ $submenu-&gt;id }})\" spinner /&gt;\n              &lt;/x-slot:trigger&gt;\n              &lt;x-slot:content class=\"pop-small\"&gt;\n                @lang('Up')\n              &lt;/x-slot:content&gt;\n            &lt;/x-popover&gt;\n            @endif\n            @if ($submenu-&gt;order &lt; $menu-&gt;submenus-&gt;count())\n              &lt;x-popover&gt;\n                &lt;x-slot:trigger&gt;\n                  &lt;x-button icon=\"s-chevron-down\" wire:click=\"downSub({{ $submenu-&gt;id }})\" spinner /&gt;\n                &lt;/x-slot:trigger&gt;\n                &lt;x-slot:content class=\"pop-small\"&gt;\n                  @lang('Down')\n                &lt;/x-slot:content&gt;\n              &lt;/x-popover&gt;\n              @endif\n              &lt;x-popover&gt;\n                &lt;x-slot:trigger&gt;\n                  &lt;x-button icon=\"c-arrow-path-rounded-square\" link=\"#\" class=\"text-blue-500 btn-ghost btn-sm\"\n                    spinner /&gt;\n                &lt;/x-slot:trigger&gt;\n                &lt;x-slot:content class=\"pop-small\"&gt;\n                  @lang('Edit')\n                &lt;/x-slot:content&gt;\n              &lt;/x-popover&gt;\n              &lt;x-popover&gt;\n                &lt;x-slot:trigger&gt;\n                  &lt;x-button icon=\"o-trash\" wire:click=\"deleteSubmenu({{ $menu-&gt;id }}, {{ $submenu-&gt;id }})\"\n                    wire:confirm=\"{{ __('Are you sure to delete this menu?') }}\" spinner\n                    class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                &lt;/x-slot:trigger&gt;\n                &lt;x-slot:content class=\"pop-small\"&gt;\n                  @lang('Delete')\n                &lt;/x-slot:content&gt;\n              &lt;/x-popover&gt;\n          &lt;/x-slot:actions&gt;\n        &lt;/x-list-item&gt;\n        @endforeach\n\n        &lt;br&gt;\n\n        &lt;x-card class=\"\" title=\"{{ __('Create a new submenu') }}\"&gt;\n          @include('livewire.admin.menus.submenu-form')\n        &lt;/x-card&gt;\n\n      &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n    @endforeach\n\n  &lt;/x-card&gt;\n\n  &lt;br&gt;\n\n  &lt;x-card class=\"\" title=\"{{ __('Create a new menu') }}\"&gt;\n\n    &lt;x-form wire:submit=\"saveMenu\"&gt;\n      &lt;x-input label=\"{{ __('Title') }}\" wire:model=\"label\" /&gt;\n      &lt;x-input type=\"text\" wire:model=\"link\" label=\"{{ __('Link') }}\" /&gt;\n      &lt;x-slot:actions&gt;\n        &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\" class=\"btn-primary\" /&gt;\n      &lt;/x-slot:actions&gt;\n    &lt;/x-form&gt;\n\n  &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"6373,6374","fold":1}},{"content":"Traductions Liste Menus","children":[{"content":"<pre data-lines=\"6677,6678\"><code>N.B.: \"Edit\" existe déjà, mais remplacé ici\n</code></pre>","children":[],"payload":{"lines":"6677,6678"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Submenus\"</span>: <span class=\"hljs-string\">\"Sous-menus\"</span>,\n<span class=\"hljs-string\">\"Edit a submenu\"</span>: <span class=\"hljs-string\">\"Modifier un sous-menu\"</span>,\n<span class=\"hljs-string\">\"Create a new menu\"</span>: <span class=\"hljs-string\">\"Créer un nouveau menu\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this menu?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer ce menu ?\"</span>,\n<span class=\"hljs-string\">\"Menu created with success.\"</span>: <span class=\"hljs-string\">\"Menu ajouté avec succès.\"</span>,\n<span class=\"hljs-string\">\"Menu updated with success.\"</span>: <span class=\"hljs-string\">\"Menu mis à jour avec succès.\"</span>,\n<span class=\"hljs-string\">\"Edit a menu\"</span>: <span class=\"hljs-string\">\"Modifier un menu\"</span>,\n<span class=\"hljs-string\">\"Create a new submenu\"</span>: <span class=\"hljs-string\">\"Créer un nouveau sous-menu\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this submenu?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer ce sous-menu ?\"</span>,\n<span class=\"hljs-string\">\" deleted with success.\"</span>: <span class=\"hljs-string\">\" supprimé avec succès.\"</span>,\n<span class=\"hljs-string\">\"Submenu\"</span>: <span class=\"hljs-string\">\"Sous-menu\"</span>,\n<span class=\"hljs-string\">\"Edit\"</span>: <span class=\"hljs-string\">\"Modifier\"</span>,\n<span class=\"hljs-string\">\"Link\"</span>: <span class=\"hljs-string\">\"Lien\"</span>,\n<span class=\"hljs-string\">\"Select a post, type to search\"</span>: <span class=\"hljs-string\">\"Sélectionnez un article, tapez pour rechercher\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"6675,6676","fold":1}}],"payload":{"lines":"6365,6366","fold":1}}],"payload":{"lines":"6224,6225","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-menus-partie-1\">https://laravel.sillo.org/posts/mon-cms-les-menus-partie-1</a></strong></em>","children":[],"payload":{"lines":"6696,6697"}},{"content":"Modification d'un menu","children":[{"content":"Route admin.menus.edit","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        ...\n        <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n            ...\n            <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/menus/{menu}/edit'</span>, <span class=\"hljs-string\">'admin.menus.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'menus.edit'</span>);\n        });\n    });\n});\n</code></pre>","children":[]}],"payload":{"lines":"6700,6701","fold":1}},{"content":"Lien Modification de Menus dans la liste (admin.menus.index)","children":[{"content":"<pre><code class=\"language-php\">@if ($menu-&gt;order &lt; $menus-&gt;count())\n    &lt;x-popover&gt;\n        ...\n    &lt;/x-popover&gt;\n@endif\n&lt;x-popover&gt;\n    &lt;x-slot:trigger&gt;\n        &lt;x-button icon=\"c-arrow-path-rounded-square\" link=\"{{ route('menus.edit', $menu-&gt;id) }}\" class=\"text-blue-500 btn-ghost btn-sm\" spinner /&gt;\n    ...\n</code></pre>","children":[]}],"payload":{"lines":"6715,6716","fold":1}},{"content":"Composant modification d'un menu (admin.menus.edit)","children":[{"content":"Création admin.menus.edit","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/menus/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"6731,6732","fold":1}},{"content":"Code admin.menus.edit","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\Menu;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Edit menu'), Layout('components.layouts.admin')]\nclass extends Component {\n    use Toast;\n\n    public Menu $menu;\n    public string $label = '';\n    public ?string $link = null;\n\n    public function mount(Menu $menu): void {\n        $this-&gt;menu = $menu;\n        $this-&gt;fill($this-&gt;menu);\n    }\n\n    public function save(): void {\n        $data = $this-&gt;validate([\n            'label' =&gt; ['required', 'string', 'max:255', Rule::unique('menus')-&gt;ignore($this-&gt;menu-&gt;id)],\n            'link' =&gt; 'nullable|regex:/\\/([a-z0-9_-]\\/*)*[a-z0-9_-]*/',\n        ]);\n\n        $this-&gt;menu-&gt;update($data);\n\n        $this-&gt;success(__('Menu updated with success.'), redirectTo: '/admin/menus/index');\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a menu') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-form wire:submit=\"save\"&gt;\n            &lt;x-input label=\"{{ __('Title') }}\" wire:model=\"label\" /&gt;\n            &lt;x-input type=\"text\" wire:model=\"link\" label=\"{{ __('Link') }}\" /&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"6737,6738","fold":1}}],"payload":{"lines":"6729,6730","fold":1}}],"payload":{"lines":"6698,6699","fold":1}},{"content":"Modification d'un submenu","children":[{"content":"Route admin.menus.editsub","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/submenus/{submenu}/edit'</span>, <span class=\"hljs-string\">'admin.menus.editsub'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'submenus.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"6794,6795","fold":1}},{"content":"Lien Modification d'un submenu dans la liste (admin.menus.index)","children":[{"content":"<pre><code class=\"language-php\">@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$submenu</span>-&gt;order &lt; <span class=\"hljs-variable\">$menu</span>-&gt;submenus-&gt;<span class=\"hljs-title function_ invoke__\">count</span>())\n    &lt;x-popover&gt;\n        ...\n    &lt;/x-popover&gt;\n@<span class=\"hljs-keyword\">endif</span>\n&lt;x-popover&gt;\n    &lt;x-slot:trigger&gt;\n        &lt;x-button icon=<span class=\"hljs-string\">\"c-arrow-path-rounded-square\"</span> link=<span class=\"hljs-string\">\"{{ route('submenus.edit', <span class=\"hljs-subst\">$submenu</span>-&gt;id) }}\"</span>...(À la place du <span class=\"hljs-string\">'#'</span>)\n    ...\n</code></pre>","children":[]}],"payload":{"lines":"6800,6801","fold":1}},{"content":"Composant modification d'un submenu (admin.menus.editsub)","children":[{"content":"Création admin.menus.editsub","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/menus/editsub --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"6816,6817","fold":1}},{"content":"Code admin.menus.editsub","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Mary\\Traits\\Toast;\nuse App\\Models\\Submenu;\nuse App\\Traits\\ManageMenus;\nuse Livewire\\Volt\\Component;\nuse Livewire\\Attributes\\{Layout, Title};\n\nnew #[Title('Edit Submenu'), Layout('components.layouts.admin')] class extends Component {\n    use Toast, ManageMenus;\n\n    public Submenu $submenu;\n    public string $sublabel = '';\n    public string $sublink  = '';\n    public int $subPost     = 0;\n    public int $subPage     = 0;\n    public int $subCategory = 0;\n    public int $subOption   = 1;\n\n    public function mount(Submenu $submenu): void {\n        $this-&gt;submenu  = $submenu;\n        $this-&gt;sublabel = $submenu-&gt;label;\n        $this-&gt;sublink  = $submenu-&gt;link;\n        $this-&gt;search();\n    }\n\n    public function saveSubmenu($menu = null): void {\n        $data = $this-&gt;validate([\n            'sublabel' =&gt; ['required', 'string', 'max:255'],\n            'sublink'  =&gt; 'required|regex:/\\/([a-z0-9_-]\\/*)*[a-z0-9_-]*/',\n        ]);\n\n        $this-&gt;submenu-&gt;update([\n            'label' =&gt; $data['sublabel'],\n            'link'  =&gt; $data['sublink'],\n        ]);\n\n        $this-&gt;success(__('Menu updated with success.'), redirectTo: '/admin/menus/index');\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a submenu') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        @include('livewire.admin.menus.submenu-form')\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"6822,6823","fold":1}}],"payload":{"lines":"6814,6815","fold":1}}],"payload":{"lines":"6792,6793","fold":1}},{"content":"Le menu du footer","children":[{"content":"Route admin.menus.footers","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/footers/index'</span>, <span class=\"hljs-string\">'admin.menus.footers'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'menus.footers'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"6880,6881"}},{"content":"Lien du menu du footer dans la sidebar (admin.sidebar)","children":[{"content":"<pre><code class=\"language-php\">@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Menus') }}\"</span> icon=<span class=\"hljs-string\">\"m-list-bullet\"</span>&gt;\n        ...\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Footer') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('menus.footers') }}\"</span> /&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Footer\"</span>: <span class=\"hljs-string\">\"Pieds de page\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"6886,6887"}},{"content":"Composant menu du footer (admin.menus.footers)","children":[{"content":"Création admin.menus.footers","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/menus/footers --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"6901,6902","fold":1}},{"content":"Code admin.menus.footers","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Mary\\Traits\\Toast;\nuse App\\Models\\{Footer};\nuse Livewire\\Volt\\Component;\nuse Illuminate\\Support\\Collection;\nuse Livewire\\Attributes\\{Layout, Validate, Title};\n\nnew #[Title('Footer Menu'), Layout('components.layouts.admin')]\nclass extends Component {\n    use Toast;\n    \n    public Collection $footers;\n    \n    #[Validate('required|max:255|unique:footers,label')]\n    public string $label = '';\n    \n    #[Validate('nullable|regex:/\\/([a-z0-9_-]\\/*)*[a-z0-9_-]*/')]\n    public string $link = '';\n    \n    public function mount(): void {\n        $this-&gt;getFooters();\n    }\n    \n    public function getFooters(): void {\n        $this-&gt;footers = Footer::orderBy('order')-&gt;get();\n    }\n    \n    public function up(Footer $footer): void {\n        $previousFooter = Footer::where('order', '&lt;', $footer-&gt;order)\n            -&gt;orderBy('order', 'desc')\n            -&gt;first();\n    \n        $this-&gt;swap($footer, $previousFooter);\n    }\n    \n    public function down(Footer $footer): void {\n        $previousFooter = Footer::where('order', '&gt;', $footer-&gt;order)\n            -&gt;orderBy('order', 'asc')\n            -&gt;first();\n    \n        $this-&gt;swap($footer, $previousFooter);\n    }\n    \n    public function deleteFooter(Footer $footer): void {\n        $footer-&gt;delete();\n        $this-&gt;reorderFooters();\n        $this-&gt;getFooters();\n        $this-&gt;success(__('Footer deleted with success.'));\n    }\n    \n    public function saveFooter(): void {\n        $data          = $this-&gt;validate();\n        $data['order'] = $this-&gt;footers-&gt;count() + 1;\n        $newFooter     = Footer::create($data);\n        $this-&gt;footers-&gt;push($newFooter);\n        $this-&gt;success(__('Footer created with success.'));\n    }\n    \n    private function swap(Footer $footer, Footer $previousFooter): void {\n        $tempOrder             = $footer-&gt;order;\n        $footer-&gt;order         = $previousFooter-&gt;order;\n        $previousFooter-&gt;order = $tempOrder;\n    \n        $footer-&gt;save();\n        $previousFooter-&gt;save();\n        $this-&gt;getFooters();\n    }\n    \n    private function reorderFooters(): void {\n        $footers = Footer::orderBy('order')-&gt;get();\n      foreach ($footers as $index =&gt; $footer) {\n          $footer-&gt;order = $index + 1;\n          $footer-&gt;save();\n      }\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Footer') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n\n        @foreach ($footers as $footer)\n            &lt;x-list-item :item=\"$footer\" no-separator no-hover&gt;\n                &lt;x-slot:value&gt;\n                    {{ $footer-&gt;label }}\n                &lt;/x-slot:value&gt;\n                &lt;x-slot:sub-value&gt;\n                    {{ $footer-&gt;link }}\n                &lt;/x-slot:sub-value&gt;\n                &lt;x-slot:actions&gt;\n                    @if ($footer-&gt;order &gt; 1)\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"s-chevron-up\" wire:click=\"up({{ $footer-&gt;id }})\" spinner /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Up')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    @endif\n                    @if ($footer-&gt;order &lt; $footers-&gt;count())\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"s-chevron-down\" wire:click=\"down({{ $footer-&gt;id }})\" spinner /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Down')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    @endif\n                    &lt;x-popover&gt;\n                        &lt;x-slot:trigger&gt;\n                            &lt;x-button icon=\"c-arrow-path-rounded-square\" link=\"{{ route('footers.edit', $footer-&gt;id) }}\" class=\"text-blue-500 btn-ghost btn-sm\" spinner /&gt;\n                        &lt;/x-slot:trigger&gt;\n                        &lt;x-slot:content class=\"pop-small\"&gt;\n                            @lang('Edit')\n                        &lt;/x-slot:content&gt;\n                    &lt;/x-popover&gt;\n                    &lt;x-popover&gt;\n                        &lt;x-slot:trigger&gt;\n                            &lt;x-button icon=\"o-trash\" wire:click=\"deleteFooter({{ $footer-&gt;id }})\"\n                                wire:confirm=\"{{ __('Are you sure to delete this footer?') }}\" spinner\n                                class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                        &lt;/x-slot:trigger&gt;\n                        &lt;x-slot:content class=\"pop-small\"&gt;\n                            @lang('Delete')\n                        &lt;/x-slot:content&gt;\n                    &lt;/x-popover&gt;\n                &lt;/x-slot:actions&gt;\n            &lt;/x-list-item&gt;\n        @endforeach\n\n    &lt;/x-card&gt;\n\n    &lt;br&gt;\n\n    &lt;x-card class=\"\" title=\"{{ __('Create a new footer') }}\"&gt;\n\n        &lt;x-form wire:submit=\"saveFooter\"&gt;\n            &lt;x-input label=\"{{ __('Title') }}\" wire:model=\"label\" /&gt;\n            &lt;x-input type=\"text\" wire:model=\"link\"\n                label=\"{{ __('Link') }} ({{ __('I.e.') }}: /{{ __('my-page') }}, /pages/slug {{ __('or') }} /pages/{{ strtolower(__('Folder')) }}/{{ __('my_page') }}-1)\" /&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit a footer\"</span>: <span class=\"hljs-string\">\"Modifier le pied de page\"</span>,\n<span class=\"hljs-string\">\"Footer deleted with success.\"</span>: <span class=\"hljs-string\">\"Pied de page supprimé avec succès.\"</span>,\n<span class=\"hljs-string\">\"Create a new footer\"</span>: <span class=\"hljs-string\">\"Créer un nouveau pied de page\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this footer?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer ce menu de pied de page ?\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"6907,6908","fold":1}}],"payload":{"lines":"6899,6900"}}],"payload":{"lines":"6878,6879","fold":1}},{"content":"Modification du menu du footer","children":[{"content":"Route admin.menus.editfooter","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/footers/{footer}/edit'</span>, <span class=\"hljs-string\">'admin.menus.editfooter'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'footers.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"7075,7076"}},{"content":"Lien Modification d'un menu du footer dans la liste (admin.menus.footer)","children":[{"content":"<pre data-lines=\"7083,7084\"><code>(Déjà posé dans le code)\n</code></pre>","children":[],"payload":{"lines":"7083,7084"}},{"content":"<pre><code class=\"language-php\">&lt;x-button icon=\"c-arrow-path-rounded-square\" link=\"{{ route('footers.edit', $footer-&gt;id) }}\" class=\"text-blue-500 btn-ghost btn-sm\" spinner /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"7081,7082"}},{"content":"Composant modification d'un menu footer (admin.menus.editfooter)","children":[{"content":"Création admin.menus.editfooter","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/menus/editfooter --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"7091,7092","fold":1}},{"content":"Code admin.menus.editfooter","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Mary\\Traits\\Toast;\nuse App\\Models\\Footer;\nuse Livewire\\Volt\\Component;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\{Layout, Title};\n\nnew #[Title('Edit Footer'), Layout('components.layouts.admin')] \nclass extends Component {\n    use Toast;\n    \n    public Footer $footer;\n    public string $label = '';\n    public string $link  = '';\n    \n    public function mount(Footer $footer): void {\n        $this-&gt;footer = $footer;\n        $this-&gt;fill($this-&gt;footer);\n    }\n    \n    public function save(): void {\n        $data = $this-&gt;validate([\n            'label' =&gt; ['required', 'string', 'max:255', Rule::unique('footers')-&gt;ignore($this-&gt;footer-&gt;id)],\n            'link'  =&gt; 'regex:/\\/([a-z0-9_-]\\/*)*[a-z0-9_-]*/',\n        ]);\n    \n        $this-&gt;footer-&gt;update($data);\n    \n        $this-&gt;success(__('Footer updated with success.'), redirectTo: '/admin/footers/index');\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a footer') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-form wire:submit=\"save\"&gt;\n            &lt;x-input label=\"{{ __('Title') }}\" wire:model=\"label\" /&gt;\n            &lt;x-input type=\"text\" wire:model=\"link\" label=\"{{ __('Link') }}\" /&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Footer updated with success.\"</span>: <span class=\"hljs-string\">\"Pied de page mis à jour avec succès\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"7097,7098","fold":1}}],"payload":{"lines":"7089,7090"}}],"payload":{"lines":"7073,7074","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-menus-partie-2\">https://laravel.sillo.org/posts/mon-cms-les-menus-partie-2</a></strong></em>","children":[],"payload":{"lines":"7156,7157"}}],"payload":{"lines":"6222,6223","fold":1}},{"content":"- Les Médias","children":[{"content":"Gestion des Images &lt;!-- markmap: fold --&gt;","children":[{"content":"Route admin.images.index &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    ...\n    <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n        ...\n        <span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n            ...\n            <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/images/index'</span>, <span class=\"hljs-string\">'admin.images.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'images.index'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"7162,7163"}},{"content":"Lien admin.images.index dans admin.sidebar &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">... Route Menus\n    &lt;/x-menu-sub&gt;\n    @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n        ...\n        &lt;x-menu-item icon=<span class=\"hljs-string\">\"c-photo\"</span> title=<span class=\"hljs-string\">\"{{ __('Images') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('images.index') }}\"</span> /&gt;\n    @<span class=\"hljs-keyword\">endif</span>\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"7174,7175"}},{"content":"Composant admin.images.index &lt;!-- markmap: fold --&gt;","children":[{"content":"Création composant admin.images.index &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/images/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"7188,7189"}},{"content":"Code composant admin.images.index &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">\n</code></pre>","children":[]}],"payload":{"lines":"7194,7195"}},{"content":"Traduction code composant admin.images.index &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Select year and month\"</span>: <span class=\"hljs-string\">\"Sélectionner l'année et le mois\"</span>,\n<span class=\"hljs-string\">\"Year\"</span>: <span class=\"hljs-string\">\"Année\"</span>,\n<span class=\"hljs-string\">\"Month\"</span>: <span class=\"hljs-string\">\"Mois\"</span>,\n<span class=\"hljs-string\">\"Path\"</span>: <span class=\"hljs-string\">\"Chemin\"</span>,\n<span class=\"hljs-string\">\"Copy url\"</span>: <span class=\"hljs-string\">\"Copier l'URL\"</span>,\n<span class=\"hljs-string\">\"Manage image\"</span>: <span class=\"hljs-string\">\"Gérer l'image\"</span>,\n<span class=\"hljs-string\">\"Delete image\"</span>: <span class=\"hljs-string\">\"Supprimer l'image\"</span>,\n<span class=\"hljs-string\">\"Image deleted with success.\"</span>: <span class=\"hljs-string\">\"Image supprimée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"7200,7201"}}],"payload":{"lines":"7186,7187"}}],"payload":{"lines":"7160,7161"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-medias-partie-1\">https://laravel.sillo.org/posts/mon-cms-les-medias-partie-1</a></strong></em>","children":[],"payload":{"lines":"7213,7214"}},{"content":"uuu &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">777\n</code></pre>","children":[]}],"payload":{"lines":"7215,7216"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-medias-partie-2\">https://laravel.sillo.org/posts/mon-cms-les-medias-partie-2</a></strong></em>","children":[],"payload":{"lines":"7221,7222"}}],"payload":{"lines":"7158,7159","fold":1}},{"content":"- Les Paramètres","children":[{"content":"uuu &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">777\n</code></pre>","children":[]}],"payload":{"lines":"7225,7226"}},{"content":"uuu &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">777\n</code></pre>","children":[]}],"payload":{"lines":"7231,7232"}},{"content":"uuu &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">777\n</code></pre>","children":[]}],"payload":{"lines":"7237,7238"}},{"content":"uuu &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">777\n</code></pre>","children":[]}],"payload":{"lines":"7243,7244"}},{"content":"uuu &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\">777\n</code></pre>","children":[]}],"payload":{"lines":"7249,7250"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-parametres\">https://laravel.sillo.org/posts/mon-cms-les-parametres</a></strong></em>","children":[],"payload":{"lines":"7255,7256"}}],"payload":{"lines":"7223,7224","fold":1}},{"content":"III / <strong>A I D E &nbsp; &amp; &nbsp; C O N T A C T</strong>","children":[{"content":"<strong><a href=\"https://github.com/bestmomo/sillo\">1 / Le TOP: Le dépôt GIT officiel</a></strong>","children":[{"content":"En faisant un Pull Request","children":[],"payload":{"lines":"7261,7262"}},{"content":"En levant une issue","children":[],"payload":{"lines":"7262,7264"}}],"payload":{"lines":"7259,7260"}},{"content":"<strong><a href=\"https://laravel.sillo.org/login\">2 / Le site officiel</a></strong>","children":[{"content":"Message possible en bas de chaque article<br>\n(Vous devez alors vous loguer ou créer un compte)","children":[],"payload":{"lines":"7266,7269"}}],"payload":{"lines":"7264,7265"}},{"content":"<strong><a href=\"https://discord.com/channels/1258750464800063640/1258750464800063646\">3 / Le canal officiel DISCORD</a></strong>","children":[{"content":"Pour discuter en LIVE","children":[],"payload":{"lines":"7271,7273"}}],"payload":{"lines":"7269,7270"}},{"content":"<strong><a href=\"https://laravel.sillo.org/contact\">4 / Un message personnel</a></strong>","children":[],"payload":{"lines":"7273,7274"}}],"payload":{"lines":"7257,7258","fold":1}},{"content":"PR dès que Complete","children":[{"content":"\n<p data-lines=\"7278,7279\">Update Memo</p>","children":[],"payload":{"lines":"7278,7280"}},{"content":"\n<p data-lines=\"7280,7281\">Complete overhaul of the design</p>","children":[],"payload":{"lines":"7280,7282"}},{"content":"\n<p data-lines=\"7282,7283\">All the tutorial code now included</p>","children":[],"payload":{"lines":"7282,7284"}},{"content":"\n<p data-lines=\"7284,7285\">Added AIDE &amp; CONTACT</p>","children":[],"payload":{"lines":"7284,7285"}}],"payload":{"lines":"7276,7277","fold":1}}],"payload":{"lines":"0,1"}},{"duration":2000,"initialExpandLevel":-1})</script>
</body>
</html>
